/*
 Use it if you like it

*/
DataModel.prototype={};DataModel.prototype.constructor=DataModel;function DataModel(){Object.apply(this);this.type="DataModel"}DataModel.prototype.destroy=function(){delete this.type;delete this.name};DataModel.prototype.setType=function(b){this.type=b};DataModel.prototype.getType=function(){return this.type};DataModel.prototype.toString=function(){};List.prototype=new DataModel;List.prototype.constructor=List;
function List(){DataModel.apply(this);var b=[],d;for(d=0;d<arguments.length;d++)b.push(arguments[d]);return b=List.fromArray(b)}
List.fromArray=function(b){b.type="List";b.name=b.name||"";b.setType=List.prototype.setType;b.setArray=List.prototype.setArray;b._constructor=List;b.getImproved=List.prototype.getImproved;b.getTypeOfElements=List.prototype.getTypeOfElements;b.getTypes=List.prototype.getTypes;b.getType=List.prototype.getType;b.getWithoutRepetitions=List.prototype.getWithoutRepetitions;b.getElementsRepetitionCount=List.prototype.getElementsRepetitionCount;b.countOccurrences=List.prototype.countOccurrences;b.getMostRepeatedElement=
List.prototype.getMostRepeatedElement;b.getMin=List.prototype.getMin;b.getMax=List.prototype.getMax;b.indexesOf=List.prototype.indexesOf;b.indexOfElements=List.prototype.indexOfElements;b.indexOfByPropertyValue=List.prototype.indexOfByPropertyValue;b.getFirstElementByName=List.prototype.getFirstElementByName;b.getFirstElementByPropertyValue=List.prototype.getFirstElementByPropertyValue;b.add=List.prototype.add;b.multiply=List.prototype.multiply;b.getSubList=List.prototype.getSubList;b.getSubListByIndexes=
List.prototype.getSubListByIndexes;b.getElementNumberOfOccurrences=List.prototype.getElementNumberOfOccurrences;b.getPropertyValues=List.prototype.getPropertyValues;b.getRandomElement=List.prototype.getRandomElement;b.containsElement=List.prototype.containsElement;b.indexOfElement=List.prototype.indexOfElement;b.sortIndexed=List.prototype.sortIndexed;b.sortNumericIndexed=List.prototype.sortNumericIndexed;b.sortNumeric=List.prototype.sortNumeric;b.sortNumericIndexedDescending=List.prototype.sortNumericIndexedDescending;
b.sortNumericDescending=List.prototype.sortNumericDescending;b.sortOnIndexes=List.prototype.sortOnIndexes;b.getReversed=List.prototype.getReversed;b.getSortedByProperty=List.prototype.getSortedByProperty;b.getSorted=List.prototype.getSorted;b.getSortedByList=List.prototype.getSortedByList;b.getFilteredByPropertyValue=List.prototype.getFilteredByPropertyValue;b.toNumberList=List.prototype.toNumberList;b.toStringList=List.prototype.toStringList;b.clone=List.prototype.clone;b.toString=List.prototype.toString;
b.getNames=List.prototype.getNames;b.applyFunction=List.prototype.applyFunction;b.getWithoutElementAtIndex=List.prototype.getWithoutElementAtIndex;b.getWithoutElements=List.prototype.getWithoutElements;b.getWithoutElementsAtIndexes=List.prototype.getWithoutElementsAtIndexes;b.getFilteredByFunction=List.prototype.getFilteredByFunction;b._concat=Array.prototype.concat;b.concat=List.prototype.concat;b.pushIfUnique=List.prototype.pushIfUnique;b.removeElement=List.prototype.removeElement;b.removeElementAtIndex=
List.prototype.removeElementAtIndex;b.removeElementsAtIndexes=List.prototype.removeElementsAtIndexes;b.removeElements=List.prototype.removeElements;b.removeRepetitions=List.prototype.removeRepetitions;b.replace=List.prototype.replace;b._splice=Array.prototype.splice;b.splice=List.prototype.splice;b.isList=!0;b.destroy=List.prototype.destroy;return b};
List.prototype.getImproved=function(){if(this.length==0)return this;var b=this.getTypeOfElements();if(b==""||b=="undefined")return this;switch(b){case "number":var d=NumberList.fromArray(this);break;case "string":d=StringList.fromArray(this);break;case "Rectangle":return this;case "Date":d=DateList.fromArray(this);break;case "List":case "Table":d=Table.fromArray(this);break;case "NumberList":d=NumberTable.fromArray(this);break;case "Point":d=Polygon.fromArray(this);break;case "Polygon":d=PolygonList.fromArray(this)}return d!=
null?(d.name=this.name,d):this};List.prototype.getTypeOfElements=function(){for(var b=typeOf(this[0]),d=1;this[d]!=null;d++)if(typeOf(this[d])!=b)return"";return b};List.prototype.getTypes=function(){var b=new StringList;for(i=0;this[i]!=null;i++)b[i]=typeOf(this[i]);return b};List.prototype.toString=function(){var b,d="[";for(b=0;b<this.length-1;b++)d+=this[b]+", ";d+=this[this.length-1]+"]";return d};
List.prototype.getNames=function(){var b=new StringList;for(i=0;this[i]!=null;i++)b[i]=this[i].name;return b};List.prototype.getReversed=function(){for(var b=instantiateWithSameType(this),d=0;this[d]!=null;d++)b.unshift(this[d]);return b};
List.prototype.getSubList=function(){if(arguments[0].isList)return this.getSubListByIndexes(arguments[0]);else if(arguments.length>2)return this.getSubListByIndexes(arguments);else interval=typeOf(arguments[0])=="number"?typeOf(arguments[1])!=null&&typeOf(arguments[1])=="number"?new Interval(arguments[0],arguments[1]):new Interval(arguments[0],this.length-1):arguments[0];var b=new Interval(Math.max(Math.min(Math.floor(interval.x),this.length),0),Math.max(Math.min(Math.floor(interval.y),this.length-
1),0)),d;if(this.type=="NumberList")return d=NumberList.fromArray(this.slice(interval.x,interval.y+1),!1),d.name=this.name,d;else if(this.type=="StringList")return d=StringList.fromArray(this.slice(interval.x,interval.y+1),!1),d.name=this.name,d;d=this.type=="List"||this.type=="Table"?new List:instantiate(typeOf(this));for(var e=b.x;e<=b.y;e++)d.push(this[e]);d.name=this.name;return this.type=="List"||this.type=="Table"?d.getImproved():d};
List.prototype.getSubListByIndexes=function(){if(this.length<1)return this;var b;b=typeOf(arguments[0])=="number"?arguments:arguments[0];var d=this.type=="List"?new List:instantiate(typeOf(this));if(b.length==0)return d;d.name=this.name;var e=this.length,f=b.length,g;for(g=0;g<f;g++)b[g]<e&&d.push(this[b[g]]);return this.type=="List"?d.getImproved():d};List.prototype.getElementNumberOfOccurrences=function(b){var d=0,e;for(e=this.indexOf(b,0);e>-1;)d++,e+=1,e=this.indexOf(b,e);return d};
List.prototype.clone=function(){for(var b=instantiateWithSameType(this),d=0;this[d]!=null;d++)b.push(this[d]);b.name=this.name;return b};List.prototype.getWithoutRepetitions=function(){newList=instantiateWithSameType(this);newList.name=this.name;for(i=0;this[i]!=null;i++)newList.indexOf(this[i])==-1&&newList.push(this[i]);return newList};List.prototype.countOccurrences=function(){for(var b=new NumberList,d=0;this[d]!=null;d++)b[d]=this.indexesOf(this[d]).length;return b};
List.prototype.getElementsRepetitionCount=function(b){var d,e=new List,f=new NumberList,g=this.length,h;for(i=0;i<g;i++)d=this[i],h=e.indexOf(d),h!=-1?f[h]++:(e.push(d),f.push(1));d=new Table;d.push(e);d.push(f);e=f.sortNumericIndexed();if(b!=void 0?b:1)for(b=0;b<d.length;b++)d[b]=d[b].clone().sortOnIndexes(e);return d};List.prototype.getMostRepeatedElement=function(){return ListOperators.countElementsRepetitionOnList(this,!0)[0][0]};
List.prototype.getMin=function(){if(this.length==0)return null;var b=this[0],d;for(d=1;d<this.length;d++)b=Math.min(b,this[d]);return b};List.prototype.getMax=function(){if(this.length==0)return null;var b=this[0],d;for(d=1;d<this.length;d++)b=Math.max(b,this[d]);return b};List.prototype.add=function(b){if(b.constructor==Number){var d,e=instantiateWithSameType(this);for(d=0;d<this.length;d++)e.push(this[d]+b);return e}};
List.prototype.getRandomElement=function(){return this[Math.floor(this.length*Math.random())]};List.prototype.containsElement=function(b){var d;for(d=0;this[d]!=null;d++)if(this[d]==b)return!0;return!1};List.prototype.indexOfElement=function(b){var d;for(d=0;this[d]!=null;d++)if(this[d]==b)return d;return-1};List.prototype.getPropertyValues=function(b,d){var e=new List;e.name=b;for(var f,g=0;this[g]!=null;g++)f=this[g][b],e[g]=f==null?d:f;return e.getImproved()};
List.prototype.sortIndexed=function(){var b=[],d;for(d=0;d<this.length;d++)b.push({index:d,value:this[d]});var b=b.sort(function(b,d){var e=b.value,k=d.value;return e<k?-1:e>k?1:0}),e=new NumberList;for(d=0;d<b.length;d++)e.push(b[d].index);return e};List.prototype.sortOnIndexes=function(b){var d=instantiateWithSameType(this);d.name=this.name;var e;for(e=0;this[e]!=null;e++)b[e]!=-1&&d.push(this[b[e]]);return d};
List.prototype.getSortedByProperty=function(b,d){var e;return this.clone().sort(d==null||d?function(d,e){return d[b]-e[b]}:function(d,e){return e[b]-d[b]})};List.prototype.getSorted=function(b){return this.clone().sort(b==null||b?function(b,e){return b>e?1:-1}:function(b,e){return b>e?-1:1})};
List.prototype.getSortedByList=function(b,d){for(var e=[],f=0;this[f]!=null;f++)e[f]=[this[f],b[f]];var e=e.sort(d==null||d?function(b,d){return b[1]<d[1]?-1:1}:function(b,d){return b[1]<d[1]?1:-1}),g=instantiateWithSameType(this);g.name=this.name;for(f=0;this[f]!=null;f++)g[f]=e[f][0];return g};List.prototype.indexesOf=function(b){for(var d=this.indexOf(b),e=new NumberList;d!=-1;)e.push(d),d=this.indexOf(b,d+1);return e};
List.prototype.indexOfElements=function(b){for(var d=new NumberList,e=0;b[e]!=null;e++)d[e]=this.indexOf(b[e]);return d};List.prototype.getFirstElementByName=function(b){for(var d=0;this[d]!=null;d++)if(this[d].name==b)return this[d];return null};List.prototype.getFirstElementByPropertyValue=function(b,d){for(var e=0;this[e]!=null;e++)if(this[e][b]==d)return this[e];return null};List.prototype.indexOfByPropertyValue=function(b,d){for(var e=0;this[e]!=null;e++)if(this[e][b]==d)return e;return-1};
List.prototype.getFilteredByPropertyValue=function(b,d){var e=new List;e.name=this.name;var f;for(f=0;this[f]!=null;f++)this[f][b]==d&&e.push(this[f]);return e.getImproved()};List.prototype.toNumberList=function(){var b=new NumberList;b.name=this.name;var d;for(d=0;this[d]!=null;d++)b[d]=Number(this[d]);return b};List.prototype.toStringList=function(){var b,d=new StringList;d.name=this.name;for(b=0;this[b]!=null;b++)d[b]=typeof this[b]=="number"?String(this[b]):this[b].toString();return d};
List.prototype.applyFunction=function(b){var d=new List;d.name=this.name;var e;for(e=0;this[e]!=null;e++)d[e]=b(this[e]);return d.getImproved()};List.prototype.getWithoutElementsAtIndexes=function(b){var d,e=this.type=="List"?new List:instantiate(typeOf(this));for(d=0;d<this.length;d++)b.indexOf(d)==-1&&e.push(this[d]);return this.type=="List"?e.getImproved():e};
List.prototype.getWithoutElementAtIndex=function(b){for(var d=this.type=="List"?new List:instantiateWithSameType(this),e=0;this[e]!=null;e++)e!=b&&d.push(this[e]);d.name=this.name;return this.type=="List"?d.getImproved():d};List.prototype.getWithoutElements=function(b){for(var d=this.type=="List"?new List:instantiateWithSameType(this),e=0;this[e]!=null;e++)b.indexOf(this[e])==-1&&d.push(this[e]);d.name=this.name;return this.type=="List"?d.getImproved():d};
List.prototype.getFilteredByFunction=function(b){for(var d=instantiateWithSameType(this),e=0;this[e]!=null;e++)b(this[e])&&d.push(this[e]);d.name=this.name;return this.type=="List"?d.getImproved():d};
List.prototype.concat=function(){if(arguments[0].type==this.type)if(this.type=="NumberList")return NumberList.fromArray(this._concat.apply(this,arguments),!1);else if(this.type=="StringList")return StringList.fromArray(this._concat.apply(this,arguments),!1);else if(this.type=="NodeList")return NodeList.fromArray(this._concat.apply(this,arguments),!1);else if(this.type=="DateList")return DateList.fromArray(this._concat.apply(this,arguments),!1);return List.fromArray(this._concat.apply(this,arguments)).getImproved()};
List.prototype.pushIfUnique=function(b){this.indexOf(b)==-1&&this.push(b)};List.prototype.removeElements=function(b){for(var d=0;d<this.length;d++)b.indexOf(this[d])>-1&&(this.splice(d,1),d--)};List.prototype.removeElement=function(b){b=this.indexOf(b);b!=-1&&this.splice(b,1)};List.prototype.removeElementAtIndex=function(b){this.splice(b,1)};List.prototype.removeElementsAtIndexes=function(b){for(var b=b.sort(function(b,d){return b-d}),d=0;b[d]!=null;d++)this.splice(b[d]-d,1)};
List.prototype.removeRepetitions=function(){for(var b=0;this[b]!=null;b++)this.indexOf(this[b],b+1)!=-1&&this.splice(b,1)};List.prototype.replace=function(b,d){for(var e=this.length,f=0;f<e;f++)this[f]==b&&(this[f]=d)};
List.prototype.splice=function(){switch(this.type){case "NumberList":return NumberList.fromArray(this._splice.apply(this,arguments));case "StringList":return StringList.fromArray(this._splice.apply(this,arguments));case "NodeList":return NodeList.fromArray(this._splice.apply(this,arguments));case "DateList":return DateList.fromArray(this._splice.apply(this,arguments))}return List.fromArray(this._splice.apply(this,arguments)).getImproved()};List.prototype.destroy=function(){for(var b=0;this[b]!=null;b++)delete this[b]};
NumberList.prototype=new List;NumberList.prototype.constructor=NumberList;function NumberList(){for(var b=0;b<arguments.length;b++)arguments[b]=Number(arguments[b]);b=List.apply(this,arguments);return b=NumberList.fromArray(b)}
NumberList.fromArray=function(b,d){var d=d==null?!0:d,e=List.fromArray(b);if(d)for(var f=0;f<e.length;f++)e[f]=Number(e[f]);e.type="NumberList";e.unit=NumberList.prototype.unit;e.tenPower=NumberList.prototype.tenPower;e.getMin=NumberList.prototype.getMin;e.getMax=NumberList.prototype.getMax;e.getAmplitude=NumberList.prototype.getAmplitude;e.getMinMaxInterval=NumberList.prototype.getMinMaxInterval;e.getSum=NumberList.prototype.getSum;e.getProduct=NumberList.prototype.getProduct;e.getInterval=NumberList.prototype.getInterval;
e.getNormalized=NumberList.prototype.getNormalized;e.getNormalizedToMax=NumberList.prototype.getNormalizedToMax;e.getNormalizedToSum=NumberList.prototype.getNormalizedToSum;e.toPolygon=NumberList.prototype.toPolygon;e.getAverage=NumberList.prototype.getAverage;e.getNorm=NumberList.prototype.getNorm;e.getStandardDeviation=NumberList.prototype.getStandardDeviation;e.getVariance=NumberList.prototype.getVariance;e.getMedian=NumberList.prototype.getMedian;e.getQuantiles=NumberList.prototype.getQuantiles;
e.getSorted=NumberList.prototype.getSorted;e.getSortIndexes=NumberList.prototype.getSortIndexes;e.factor=NumberList.prototype.factor;e.add=NumberList.prototype.add;e.subtract=NumberList.prototype.subtract;e.divide=NumberList.prototype.divide;e.dotProduct=NumberList.prototype.dotProduct;e.sqrt=NumberList.prototype.sqrt;e.pow=NumberList.prototype.pow;e.log=NumberList.prototype.log;e.isEquivalent=NumberList.prototype.isEquivalent;e.toStringList=NumberList.prototype.toStringList;e.approach=NumberList.prototype.approach;
e.clone=NumberList.prototype.clone;e._slice=Array.prototype.slice;e.slice=NumberList.prototype.slice;return e};NumberList.prototype.unit="";NumberList.prototype.tenPower=0;NumberList.prototype.getMin=function(){if(this.length==0)return null;var b,d=this[0];for(b=1;b<this.length;b++)d=Math.min(d,this[b]);return d};NumberList.prototype.getMax=function(){if(this.length==0)return null;var b,d=this[0];for(b=1;b<this.length;b++)d=Math.max(d,this[b]);return d};
NumberList.prototype.getAmplitude=function(){if(this.length==0)return 0;for(var b=this[0],d=this[0],e=1;this[e]!=null;e++)b=Math.min(b,this[e]),d=Math.max(d,this[e]);return d-b};NumberList.prototype.getMinMaxInterval=function(){return new Interval(this.getMin(),this.getMax())};NumberList.prototype.getSum=function(){if(this.length==0)return 0;var b,d=this[0];for(b=1;b<this.length;b++)d+=this[b];return d};
NumberList.prototype.getProduct=function(){if(this.length==0)return null;var b,d=this[0];for(b=1;b<this.length;b++)d*=this[b];return d};NumberList.prototype.getNormalizedToSum=function(b){var b=b==null?1:b,d=new NumberList;d.name=this.name;if(this.length==0)return d;var e,f=this.getSum();if(f==0)return this.clone();for(e=0;e<this.length;e++)d.push(b*this[e]/f);return d};
NumberList.prototype.getNormalized=function(b){b=b==null?1:b;if(this.length==0)return null;var d,e=this.getMinMaxInterval(),f=e.getAmplitude(),g=new NumberList;for(d=0;d<this.length;d++)g.push(b*((this[d]-e.x)/f));g.name=this.name;return g};
NumberList.prototype.getNormalizedToMax=function(b){b=b==null?1:b;if(this.length==0)return null;var d=this.getMax();if(d==0&&(d=this.getMin(),d==0))return ListGenerators.createListWithSameElement(this.length,0);for(var e=new NumberList,f=0;this[f]!=null;f++)e.push(b*(this[f]/d));e.name=this.name;return e};NumberList.prototype.getInterval=function(){if(this.length==0)return null;for(var b=this[0],d=this[0],e=1;this[e]!=null;e++)b=Math.max(b,this[e]),d=Math.min(d,this[e]);return new Interval(d,b)};
NumberList.prototype.toPolygon=function(){if(this.length==0)return null;for(var b=new Polygon,d=0;this[d+1]!=null;d+=2)b.push(new Point(this[d],this[d+1]));return b};NumberList.prototype.getAverage=function(){return this.getSum()/this.length};NumberList.prototype.getNorm=function(){for(var b=0,d=0;this[d]!=null;d++)b+=Math.pow(this[d],2);return Math.sqrt(b)};NumberList.prototype.getVariance=function(){for(var b=0,d=this.getAverage(),e=0;this[e]!=null;e++)b+=Math.pow(this[e]-d,2);return b/this.length};
NumberList.prototype.getStandardDeviation=function(){return Math.sqrt(this.getVariance())};NumberList.prototype.getMedian=function(){var b=this.getSorted(!0),d=(this.length-1)/2,e=Math.floor(d),f=d==e;new NumberList;return f?b[d]:0.5*b[e]+0.5*b[e+1]};NumberList.prototype.getQuantiles=function(b){for(var d=this.getSorted(!0),e=this.length/b,f=Math.floor(e),g=e==f,h=new NumberList,k=0;k<b-1;k++)h[k]=g?d[(k+1)*e]:0.5*d[(k+1)*f]+0.5*d[(k+1)*f+1];return h};
NumberList.prototype.getSorted=function(b){return b?NumberList.fromArray(this.slice().sort(function(b,e){return b-e}),!1):NumberList.fromArray(this.slice().sort(function(b,e){return e-b}),!1)};
NumberList.prototype.getSortIndexes=function(b){b==null&&(b=!0);var d=[],e=new NumberList;if(this.length==0)return e;for(var f=0;this[f]!=null;f++)d.push([f,this[f]]);b?d.sort(function(b,d){return b[1]<d[1]?1:-1}):d.sort(function(b,d){return b[1]<d[1]?-1:1});for(f=0;d[f]!=null;f++)e.push(d[f][0]);e.name=this.name;return e};NumberList.prototype.factor=function(b){var d,e=new NumberList;for(d=0;d<this.length;d++)e.push(this[d]*b);e.name=this.name;return e};
NumberList.prototype.add=function(b){var d,e=new NumberList;switch(typeOf(b)){case "number":for(d=0;this[d]!=null;d++)e[d]=this[d]+b;break;case "NumberList":for(d=0;this[d]!=null;d++)e[d]=this[d]+b[d%b.length]}e.name=this.name;return e};NumberList.prototype.subtract=function(b){var d,e=new NumberList;switch(typeOf(b)){case "number":for(d=0;this[d]!=null;d++)e[d]=this[d]-b;break;case "NumberList":for(d=0;this[d]!=null;d++)e[d]=this[d]-b[d%b.length]}e.name=this.name;return e};
NumberList.prototype.divide=function(b){var d,e=new NumberList;switch(typeOf(b)){case "number":for(d=0;this[d]!=null;d++)e[d]=this[d]/b;break;case "NumberList":for(d=0;this[d]!=null;d++)e[d]=this[d]/b[d%b.length]}e.name=this.name;return e};NumberList.prototype.sqrt=function(){var b,d=new NumberList;for(b=0;b<this.length;b++)d.push(Math.sqrt(this[b]));d.name=this.name;return d};
NumberList.prototype.pow=function(b){var d,e=new NumberList;for(d=0;d<this.length;d++)e.push(Math.pow(this[d],b));e.name=this.name;return e};NumberList.prototype.log=function(b){var b=b||0,d,e=new NumberList;for(d=0;this[d]!=null;d++)e[d]=Math.log(this[d]+b);e.name=this.name;return e};NumberList.prototype.dotProduct=function(b){var d=0,e,f=Math.min(this.length,b.length);for(e=0;e<f;e++)d+=this[e]*b[e];return d};
NumberList.prototype.isEquivalent=function(b){for(i=0;this[i]!=null;i++)if(this[i]!=b[i])return!1;return!0};NumberList.prototype.toStringList=function(){var b,d=new StringList;for(b=0;this[b]!=null;b++)d[b]=String(this[b]);d.name=this.name;return d};NumberList.prototype.approach=function(b,d){var d=d||0.5,e,f=1-d;for(e=0;this[e]!=null;e++)this[e]=f*this[e]+d*b[e]};NumberList.prototype.clone=function(){var b=NumberList.fromArray(this._slice(),!1);b.name=this.name;return b};
NumberList.prototype.slice=function(){return NumberList.fromArray(this._slice.apply(this,arguments),!1)};Node.prototype=new DataModel;Node.prototype.constructor=Node;
function Node(b,d){this.id=b==null?"":b;this.name=d!=null?d:"";this.type="Node";this.z=this.y=this.x=0;this.nodeList=new NodeList;this.relationList=new RelationList;this.toNodeList=new NodeList;this.toRelationList=new RelationList;this.fromNodeList=new NodeList;this.fromRelationList=new RelationList;this.descentWeight=this.weight=1;this.level=0;this.parent=null;this.az=this.ay=this.ax=this.vz=this.vy=this.vx=0}
Node.prototype.cleanRelations=function(){this.nodeList=new NodeList;this.relationList=new RelationList;this.toNodeList=new NodeList;this.toRelationList=new RelationList;this.fromNodeList=new NodeList;this.fromRelationList=new RelationList};
Node.prototype.destroy=function(){DataModel.prototype.destroy.call(this);delete this.id;delete this.name;delete this.nodeType;delete this.x;delete this.y;delete this.z;delete this.nodeList;delete this.relationList;delete this.toNodeList;delete this.toNodeList;delete this.fromNodeList;delete this.fromRelationList;delete this.parent;delete this.weight;delete this.descentWeight;delete this.level;delete this.vx;delete this.vy;delete this.vz;delete this.ax;delete this.ay;delete this.az};
Node.prototype.getParent=function(){return this.parent};Node.prototype.toString=function(){return this.name+", "+this.id};Node.prototype.clone=function(){var b=new Node(this.id,this.name);b.x=this.x;b.y=this.y;b.z=this.z;b.nodeType=this.nodeType;b.weight=this.weight;b.descentWeight=this.descentWeight;return b};NodeList.prototype=new List;NodeList.prototype.constructor=NodeList;function NodeList(){var b=List.apply(this,arguments);return b=NodeList.fromArray(b)}
NodeList.fromArray=function(b,d){var d=d==null?!1:d,e=List.fromArray(b);if(d)for(var f=0;f<e.length;f++)e[f]=typeOf(e[f])=="Node"?e[f]:new Node(String(e[f]),String(e[f]));e=List.fromArray(b);e.type="NodeList";e.ids={};e.deleteNodes=NodeList.prototype.deleteNodes;e.addNode=NodeList.prototype.addNode;e.addNodes=NodeList.prototype.addNodes;e.removeNode=NodeList.prototype.removeNode;e.getNodeByName=NodeList.prototype.getNodeByName;e.getNodeById=NodeList.prototype.getNodeById;e.getNodesByIds=NodeList.prototype.getNodesByIds;
e.getNewId=NodeList.prototype.getNewId;e.normalizeWeights=NodeList.prototype.normalizeWeights;e.getWeights=NodeList.prototype.getWeights;e.getIds=NodeList.prototype.getIds;e.getDegrees=NodeList.prototype.getDegrees;e.getPolygon=NodeList.prototype.getPolygon;e.getWithoutRepetitions=NodeList.prototype.getWithoutRepetitions;return e};NodeList.prototype.removeNodes=function(){for(var b=0;b<this.length;b++)this.ids[this[b].id]=null,this.removeElement(this[b])};
NodeList.prototype.addNode=function(b){this.ids[b.id]=b;this.push(b)};NodeList.prototype.addNodes=function(b){for(var d=0;b[d]!=null;d++)this.addNode(b[d])};NodeList.prototype.removeNode=function(b){this.ids[b.id]=null;this.removeElement(b)};NodeList.prototype.normalizeWeights=function(){var b,d=-9999999;for(b=0;this[b]!=null;b++)d=Math.max(this[b].weight,d);for(b=0;this[b]!=null;b++)this[b].weight/=d};
NodeList.prototype.getNodeByName=function(b){var d;for(d=0;d<this.length;d++)if(this[d].name==b)return this[d];return null};NodeList.prototype.getNodeById=function(b){return this.ids[b]};NodeList.prototype.getNodesByIds=function(b){newNodelist=new NodeList;for(var d,e=0;b[e]!=null;e++)d=this.ids[b[e]],d!=null&&(newNodelist[e]=d);return newNodelist};NodeList.prototype.getWeights=function(){for(var b=new NumberList,d=0;this[d]!=null;d++)b[d]=this[d].weight;return b};
NodeList.prototype.getIds=function(){for(var b=new StringList,d=0;this[d]!=null;d++)b[d]=this[d].id;return b};NodeList.prototype.getDegrees=function(){for(var b=new NumberList,d=0;this[d]!=null;d++)b[d]=this[d].nodeList.length;return b};NodeList.prototype.getPolygon=function(){for(var b=new Polygon,d=0;this[d]!=null;d++)b[d]=new Point(this[d].x+cX,this[d].y+cY);return b};NodeList.prototype.getNewId=function(){for(var b=this.length+1,d=0;d<b;d++)if(this.getNodeById(String(d))==null)return String(d)};
NodeList.prototype.getWithoutRepetitions=function(){newList=new NodeList;newList.name=this.name;for(i=0;this[i]!=null;i++)newList.getNodeById(this[i].id)==null&&newList.addNode(this[i]);return newList};RelationList.prototype=new NodeList;RelationList.prototype.constructor=RelationList;function RelationList(){var b=NodeList.apply(this,arguments);b.name="";return b=RelationList.fromArray(b)}
RelationList.fromArray=function(b){b=NodeList.fromArray(b);b.type="RelationList";b.addRelation=RelationList.prototype.addRelation;b.addRelationIfNew=RelationList.prototype.addRelationIfNew;b.removeRelation=RelationList.prototype.removeRelation;b.getRelationsWithNode=RelationList.prototype.getRelationsWithNode;b.getFirstRelationBetweenNodes=RelationList.prototype.getFirstRelationBetweenNodes;b.getFirstRelationByIds=RelationList.prototype.getFirstRelationByIds;b.getAllRelationsBetweenNodes=RelationList.prototype.getAllRelationsBetweenNodes;
b.getRelatedNodesToNode=RelationList.prototype.getRelatedNodesToNode;b.nodesAreConnected=RelationList.prototype.nodesAreConnected;return b};RelationList.prototype.addRelation=function(b){this.addNode(b)};RelationList.prototype.removeRelation=function(b){this.removeNode(b)};RelationList.prototype.getRelationsWithNode=function(b){var d,e=[];for(d=0;this[d]!=null;d++){var f=this[d];(f.node0==b||f.node1==b)&&e.push(f)}return e};
RelationList.prototype.getRelatedNodesToNode=function(b){var d,e=new NodeList;for(d=0;d<this.length;d++){var f=this[d];f.node0.id==b.id&&e.push(f.node1);f.node1.id==b.id&&e.push(f.node0)}return e};RelationList.prototype.getAllRelationsBetweenNodes=function(b,d,e){var f,e=e==null?!1:e,g=[];for(f=0;this[f]!=null;f++){var h=this[f];(h.node0==b&&h.node1==d||!e&&h.node0==d&&h.node1==b)&&g.push(h)}return g};
RelationList.prototype.getFirstRelationBetweenNodes=function(b,d,e){for(var e=e==null?!1:e,f=0;this[f]!=null;f++)if(this[f].node0.id==b.id&&this[f].node1.id==d.id||!e&&this[f].node1.id==b.id&&this[f].node0.id==d.id)return this[f];return null};RelationList.prototype.getFirstRelationByIds=function(b,d,e){var f,g;for(f=0;this[f]!=null;f++)if(g=this[f],g.node0.id==b&&g.node1.id==d)return g;if(e)return null;for(f=0;this[f]!=null;f++)if(g=this[f],g.node0.id==d&&g.node1.id==b)return g;return null};
RelationList.prototype.nodesAreConnected=function(b,d,e){return b.toNodeList.getNodeById(d.id)!=null?!0:!e&&b.fromNodeList.getNodeById(d.id)!=null?!0:!1};Table.prototype=new List;Table.prototype.constructor=Table;function Table(){var b=[],d;for(d=0;d<arguments.length;d++)b[d]=new List(arguments[d]);b=List.apply(this,b);return b=Table.fromArray(b)}
Table.fromArray=function(b){b=List.fromArray(b);b.type="Table";b.applyFunction=Table.prototype.applyFunction;b.getRow=Table.prototype.getRow;b.getLengths=Table.prototype.getLengths;b.sliceRows=Table.prototype.sliceRows;b.getWithoutRow=Table.prototype.getWithoutRow;b.getWithoutRows=Table.prototype.getWithoutRows;b.getTransposed=Table.prototype.getTransposed;b.getListsSortedByList=Table.prototype.getListsSortedByList;b.sortListsByList=Table.prototype.sortListsByList;b.clone=Table.prototype.clone;b.print=
Table.prototype.print;b.removeRow=Table.prototype.removeRow;b.destroy=Table.prototype.destroy;b.istable=!0;return b};Table.prototype.applyFunction=function(b){var d,e=new Table;e.name=this.name;for(d=0;this[d]!=null;d++)e[d]=this[d].applyFunction(b);return e.getImproved()};Table.prototype.getRow=function(b){var d=new List,e;for(e=0;e<this.length;e++)d[e]=this[e][b];return d.getImproved()};Table.prototype.getLengths=function(){for(var b=new NumberList,d=0;this[d]!=null;d++)b[d]=this[d].length;return b};
Table.prototype.sliceRows=function(b,d){var e=new Table;e.name=this.name;for(var f=0;this[f]!=null;f++)e.push(this[f].getSubList(b,d));return e.getImproved()};Table.prototype.getWithoutRow=function(b){var d=new Table;d.name=this.name;for(var e=0;this[e]!=null;e++)d[e]=List.fromArray(this[e].slice(0,b).concat(this[e].slice(b+1))).getImproved(),d[e].name=this[e].name;return d.getImproved()};
Table.prototype.getWithoutRows=function(b){var d=new Table;d.name=this.name;for(var e=0;this[e]!=null;e++){d[e]=new List;for(j=0;this[e][j]!=null;j++)b.indexOf(j)==-1&&d[e].push(this[e][j]);d[e]=d[e];d[e].name=this[e].name}return d.getImproved()};Table.prototype.getListsSortedByList=function(b,d){var e=instantiateWithSameType(this);e.name=this.name;for(var f=0;this[f]!=null;f++)e[f]=this[f].getSortedByList(b,d);return e};
Table.prototype.getTransposed=function(){var b=instantiate(typeOf(this));if(this.length==0)return b;var d,e,f;for(d=0;this[d]!=null;d++){f=this[d];for(e=0;f[e]!=null;e++)d==0&&(b[e]=new List),b[e][d]=this[d][e]}for(e=0;this[0][e]!=null;e++)b[e]=b[e].getImproved();return b};Table.prototype.sortListsByList=function(b){switch(b.type){case "NumberList":return TableOperators.sortListsByNumberList(this,b)}return null};
Table.prototype.removeRow=function(b){for(var d=0;this[d]!=null;d++)this[d].splice(b,1)};Table.prototype.clone=function(){var b=instantiateWithSameType(this);b.name=this.name;for(var d=0;this[d]!=null;d++)b.push(this[d].clone());return b};Table.prototype.destroy=function(){for(var b=0;this[b]!=null;b++)this[b].destroy(),delete this[b]};
Table.prototype.print=function(){c.log("///////////// <"+this.name+"////////////////////////////////////////////////////");c.log(TableEncodings.TableToCSV(this,null,!0));c.log("/////////////"+this.name+"> ////////////////////////////////////////////////////")};DateAxis.prototype=new DataModel;DateAxis.prototype.constructor=DateAxis;
function DateAxis(b,d){d=d==null?new Interval(0,1):d;DataModel.apply(this,arguments);this.departureDateInterval=b;this.arrivalInterval=d;this.setDepartureDateInterval(b);this.setArrivalInterval(d);this.type="DateAxis"}DateAxis.prototype.setDepartureDateInterval=function(b){this.departureDateInterval=b;this.time0=this.departureDateInterval.date0.getTime();this.time1=this.departureDateInterval.date1.getTime();this.dTime=this.time1-this.time0};
DateAxis.prototype.setArrivalInterval=function(b){this.arrivalInterval=b;this.arrivalAmplitude=b.getAmplitude()};DateAxis.prototype.project=function(b){return this.arrivalInterval.x+this.arrivalAmplitude*(b.getTime()-this.time0)/this.dTime};DateAxis.prototype.update=function(){this.time0=this.departureDateInterval.date0.getTime();this.time1=this.departureDateInterval.date1.getTime();this.dTime=this.time1-this.time0;this.arrivalAmplitude=this.arrivalInterval.getAmplitude()};
DateAxis.prototype.toString=function(){return"DateAxis["+this.departureDateInterval.toString()+", "+this.arrivalInterval.toString()+"]"};DateInterval.prototype=new DataModel;DateInterval.prototype.constructor=DateInterval;function DateInterval(b,d){DataModel.apply(this,arguments);this.date0=b;this.date1=d;this.type="DateInterval"}DateInterval.prototype.toString=function(){return"DateInterval["+this.date0+", "+this.date1+"]"};
DateInterval.prototype.getMax=function(){return this.date1>this.date0?this.date1:this.date0};DateInterval.prototype.getMin=function(){return this.date0<this.date1?this.date0:this.date1};DateList.prototype=new List;DateList.prototype.constructor=DateList;function DateList(){for(var b=0;b<arguments.length;b++)arguments[b]=Number(arguments[b]);b=List.apply(this,arguments);return b=DateList.fromArray(b)}
DateList.fromArray=function(b,d){var d=d==null?!0:d,e=List.fromArray(b);if(d)for(var f=0;f<e.length;f++)e[f]=Date(e[f]);e.type="DateList";e.getTimes=DateList.prototype.getTimes;e.toStringList=DateList.prototype.toStringList;e.getMin=DateList.prototype.getMin;e.getMax=DateList.prototype.getMax;return e};DateList.prototype.getTimes=function(){for(var b=new NumberList,d=0;this[d]!=null;d++)b.push(this[d].getTime());return b};
DateList.prototype.toStringList=function(){for(var b=new StringList,d=0;this[d]!=null;d++)b[d]=DateOperators.dateToString(this[d]);return b};DateList.prototype.getMin=function(){if(this.length==0)return null;var b=this[0],d;for(d=1;this[d]!=null;d++)b=b<this[d]?b:this[d];return b};DateList.prototype.getMax=function(){if(this.length==0)return null;var b=this[0],d;for(d=1;this[d]!=null;d++)b=b>this[d]?b:this[d];return b};Country.prototype=new Node;Country.prototype.constructor=Country;
function Country(b,d){Node.apply(this,[b,d]);this.type="Country";this.id=b;this.name=d;this.recognized=!1}Country.prototype.generatesSimplifiedNames=function(){this._simplifiedNames=CountryOperators.getSimplifiedNames(this.alternativeNames);this._simplifiedId=CountryOperators.getSimplifiedName(this.id);this._simplifiedName=CountryOperators.getSimplifiedName(this.name);this.shortName=this.name.replace("Democratic Republic","D.R.").replace("United States","U.S.A").replace("United Arab","U.A.")};
Country.prototype.nameMatches=function(b){this._simplifiedId==null&&this.generatesSimplifiedNames();b=CountryOperators.getSimplifiedName(b);return b==this._simplifiedId||b==this._simplifiedName?!0:this._simplifiedNames.indexOf(b)!=-1};Country.prototype.getFrame=function(){if(this._frame==null)this._frame=this.simplePolygonList==null?this.polygonList.getFrame():this.simplePolygonList.getFrame();return this._frame};CountryList.prototype=new NodeList;CountryList.prototype.constructor=CountryList;
function CountryList(){var b=NodeList.apply(this,arguments);b.name="";return b=CountryList.fromArray(b)}
CountryList.fromArray=function(b){b=NodeList.fromArray(b);b.type="CountryList";b.getCountryFromName=CountryList.prototype.getCountryFromName;b.removeAntarctica=CountryList.prototype.removeAntarctica;b.removeTinyPolygonsFromCountries=CountryList.prototype.removeTinyPolygonsFromCountries;b.removeTinyCountries=CountryList.prototype.removeTinyCountries;b.simplifyAntarctica=CountryList.prototype.simplifyAntarctica;b.assignValuesToCountriesFromTable=CountryList.prototype.assignValuesToCountriesFromTable;
b.simplifyPolygons=CountryList.prototype.simplifyPolygons;return b};CountryList.prototype.getCountryFromName=function(b){for(var d=0;this[d]!=null;d++)if(this[d].nameMatches(b))return this[d];return null};CountryList.prototype.removeAntarctica=function(){this.removeNode(this.getNodeById("AQ"))};
CountryList.prototype.removeTinyPolygonsFromCountries=function(b){for(var b=0.2,d,e,f=0;this[f]!=null;f++){d=this[f];for(e=0;d.polygonList[e]!=null;e++)d.polygonList[e].getFrame().getArea()<b&&(d.polygonList.splice(e,1),e--)}};CountryList.prototype.removeTinyCountries=function(b){for(var b=0.5,d,e,f,g=0;this[g]!=null;g++){d=this[g];f=!0;for(e=0;d.polygonList[e]!=null;e++)if(d.polygonList[e].getFrame().getArea()>b){f=!1;break}f&&(this.removeNode(this[g]),g--)}};
CountryList.prototype.simplifyPolygons=function(b){for(var d,e,f,g,h=0;this[h]!=null;h++){d=this[h];for(e=f=0;d.polygonList[e]!=null;e++)if(d.polygonList[e]=PolygonOperators.simplifyPolygon(d.polygonList[e],b),d.polygonList[e].length<3)d.polygonList.splice(e,1),e--;else if(d.polygonList[e].length>f)f=d.polygonList[e].length,g=e;d.longestPolygon.destroy();d.longestPolygon=d.polygonList[g]}};
CountryList.prototype.simplifyAntarctica=function(){var b=this.getNodeById("AQ").simplePolygonList;b!=null&&(b[0].splice(10,1),b[0].splice(10,1));this.getNodeById("AQ")};CountryList.prototype.assignValuesToCountriesFromTable=function(b,d){for(var e,f,g=0;b[0][g]!=null;g++)if(f=this.getCountryFromName(b[0][g]),f!=null)for(e=1;b[e]!=null;e++)f[b[e].name]=b[e][g]==d?null:b[e][g]};Point.prototype=new DataModel;Point.prototype.constructor=Point;
function Point(b,d){DataModel.apply(this,arguments);this.type="Point";this.x=Number(b)||0;this.y=Number(d)||0}Point.prototype.getNorm=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))};Point.prototype.getAngle=function(){return Math.atan2(this.y,this.x)};Point.prototype.factor=function(b){return new Point(this.x*b,this.y*b)};Point.prototype.normalize=function(){var b=Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2));return new Point(this.x/b,this.y/b)};
Point.prototype.normalizeToValue=function(b){b/=Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2));return new Point(this.x*b,this.y*b)};Point.prototype.subtract=function(b){return new Point(this.x-b.x,this.y-b.y)};Point.prototype.add=function(b){return new Point(b.x+this.x,b.y+this.y)};Point.prototype.addCoordinates=function(b,d){return new Point(b+this.x,d+this.y)};Point.prototype.distanceToPoint=function(b){return Math.sqrt(Math.pow(this.x-b.x,2)+Math.pow(this.y-b.y,2))};
Point.prototype.distanceToPointSquared=function(b){return Math.pow(this.x-b.x,2)+Math.pow(this.y-b.y,2)};Point.prototype.angleToPoint=function(b){return Math.atan2(b.y-this.y,b.x-this.x)};Point.prototype.expandFromPoint=function(b,d){return new Point(b.x+d*(this.x-b.x),b.y+d*(this.y-b.y))};Point.prototype.interpolate=function(b,d){return new Point((1-d)*this.x+d*b.x,(1-d)*this.y+d*b.y)};Point.prototype.cross=function(b){return this.x*b.y-this.y*b.x};
Point.prototype.dot=function(b){return this.x*b.x+this.y*b.y};Point.prototype.getRotated=function(b,d){d=d==null?new Point:d;return new Point(Math.cos(b)*(this.x-d.x)-Math.sin(b)*(this.y-d.y)+d.x,Math.sin(b)*(this.x-d.x)+Math.cos(b)*(this.y-d.y)+d.y)};Point.prototype.clone=function(){return new Point(this.x,this.y)};Point.prototype.toString=function(){return"(x="+this.x+", y="+this.y+")"};Point.prototype.destroy=function(){delete this.type;delete this.name;delete this.x;delete this.y};
Point3D.prototype=new Point;Point3D.prototype.constructor=Point3D;function Point3D(b,d,e){Point.apply(this,arguments);this.type="Point3D";this.z=e}Point3D.prototype.distanceToPoint3D=function(b){return Math.sqrt(Math.pow(Math.abs(this.x-b.x),2)+Math.pow(Math.abs(this.y-b.y),2)+Math.pow(Math.abs(this.z-b.z),2))};Point3D.prototype.distanceToPointSquared=function(b){return Math.pow(Math.abs(this.x-b.x),2)+Math.pow(Math.abs(this.y-b.y),2)+Math.pow(Math.abs(this.z-b.z),2)};
Point3D.prototype.getNorm=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)};Point3D.prototype.normalizeToValue=function(b){b/=Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)+Math.pow(this.z,2));return new Point3D(this.x*b,this.y*b,this.z*b)};Point3D.prototype.cross=function(b){return new Point3D(this.y*b.z-this.z*b.y,this.z*b.x-this.x*b.z,this.x*b.y-this.y*b.x)};Point3D.prototype.dot=function(b){return this.x*b.x+this.y*b.y+this.z*b.z};
Point3D.prototype.add=function(b){return new Point3D(b.x+this.x,b.y+this.y,b.z+this.z)};Point3D.prototype.subtract=function(b){return new Point3D(this.x-b.x,this.y-b.y,this.z-b.z)};Point3D.prototype.factor=function(b){return new Point3D(this.x*b,this.y*b,this.z*b)};Point3D.prototype.interpolate=function(b,d){return new Point3D((1-d)*this.x+d*b.x,(1-d)*this.y+d*b.y,(1-d)*this.z+d*b.z)};
Point3D.prototype.getAngles=function(){var b=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z),d=0.5*Math.PI-Math.atan2(this.z/b,this.y/b),b=-Math.asin(this.x/b);d<-Math.PI&&(d+=2*Math.PI);d>Math.PI&&(d-=2*Math.PI);b<-Math.PI&&(b+=2*Math.PI);b>Math.PI&&(b-=2*Math.PI);return new Point3D(d,b,0)};
Point3D.prototype.getInverseAngles=function(){var b=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z),d=-0.5*Math.PI+Math.atan2(-this.z/b,-this.y/b),b=Math.asin(-this.x/b);d<-Math.PI&&(d+=2*Math.PI);d>Math.PI&&(d-=2*Math.PI);b<-Math.PI&&(b+=2*Math.PI);b>Math.PI&&(b-=2*Math.PI);return new Point3D(d,b,0)};Point3D.prototype.clone=function(){return new Point3D(this.x,this.y,this.z)};Point3D.prototype.toString=function(){return"(x="+this.x+", y="+this.y+", z="+this.z+")"};
Point3D.prototype.destroy=function(){delete this.type;delete this.name;delete this.x;delete this.y;delete this.z};Polygon.prototype=new List;Polygon.prototype.constructor=Polygon;function Polygon(){var b=List.apply(this,arguments);return b=Polygon.fromArray(b)}
Polygon.fromArray=function(b){b=List.fromArray(b);b.type="Polygon";b.getFrame=Polygon.prototype.getFrame;b.getBarycenter=Polygon.prototype.getBarycenter;b.add=Polygon.prototype.add;b.factor=Polygon.prototype.factor;b.getRotated=Polygon.prototype.getRotated;b.getClosestPoint=Polygon.prototype.getClosestPoint;b.toNumberList=Polygon.prototype.toNumberList;b.containsPoint=Polygon.prototype.containsPoint;b.approach=Polygon.prototype.approach;b.clone=Polygon.prototype.clone;return b};
Polygon.prototype.getFrame=function(){if(this.length==0)return null;for(var b=new Rectangle(this[0].x,this[0].y,this[0].x,this[0].y),d,e=1;this[e]!=null;e++)d=this[e],b.x=Math.min(b.x,d.x),b.y=Math.min(b.y,d.y),b.width=Math.max(b.width,d.x),b.height=Math.max(b.height,d.y);b.width-=b.x;b.height-=b.y;return b};
Polygon.prototype.getBarycenter=function(b){cLPN=1-Number(b==null?!0:b);if(this.length==0)return null;for(var d=new Point(this[0].x,this[0].y),b=1;this[b+cLPN]!=null;b++)d.x+=this[b].x,d.y+=this[b].y;d.x/=this.length;d.y/=this.length;return d};Polygon.prototype.add=function(b){var d;switch(typeOf(b)){case "Point":var e=new Polygon;for(d=0;this[d]!=null;d++)e[d]=this[d].add(b);e.name=this.name;return e}};
Polygon.prototype.factor=function(b){for(var d=new Polygon,e=0;this[e]!=null;e++)d[e]=this[e].factor(b);d.name=this.name;return d};Polygon.prototype.getRotated=function(b,d){for(var d=d==null?new Point:d,e=new Polygon,f=0;this[f]!=null;f++)e[f]=new Point(Math.cos(b)*(this[f].x-d.x)-Math.sin(b)*(this[f].y-d.y)+d.x,Math.sin(b)*(this[f].x-d.x)+Math.cos(b)*(this[f].y-d.y)+d.y);e.name=this.name;return e};
Polygon.prototype.getClosestPoint=function(b){for(var d=this[0],e=Math.pow(b.x-d.x,2)+Math.pow(b.y-d.y,2),f,g=1;this[g]!=null;g++)f=Math.pow(b.x-this[g].x,2)+Math.pow(b.y-this[g].y,2),f<e&&(e=f,d=this[g]);return d};Polygon.prototype.toNumberList=function(){var b=new NumberList,d;for(d=0;this[d]!=null;d++)b[d*2]=this[d].x,b[d*2+1]=this[d].y;return b};
Polygon.prototype.containsPoint=function(b){var d,e,f,g=!1;d=-1;f=this.length;for(e=f-1;++d<f;e=d)(this[d].y<=b.y&&b.y<this[e].y||this[e].y<=b.y&&b.y<this[d].y)&&b.x<(this[e].x-this[d].x)*(b.y-this[d].y)/(this[e].y-this[d].y)+this[d].x&&(g=!g);return g};Polygon.prototype.approach=function(b,d){var d=d||0.5,e=1-d;this.forEach(function(f,g){f.x=e*f.x+d*b[g].x;f.y=e*f.y+d*b[g].y})};Polygon.prototype.clone=function(){for(var b=new Polygon,d=0;this[d]!=null;d++)b[d]=this[d].clone();b.name=this.name;return b};
Polygon3D.prototype=new List;Polygon3D.prototype.constructor=Polygon3D;function Polygon3D(){var b=List.apply(this,arguments);return b=Polygon3D.fromArray(b)}Polygon3D.fromArray=function(b){b=List.fromArray(b);b.type="Polygon3D";return b};Polygon3DList.prototype=new List;Polygon3DList.prototype.constructor=Polygon3DList;function Polygon3DList(){var b=List.apply(this,arguments);return b=Polygon3DList.fromArray(b)}Polygon3DList.fromArray=function(b){b=List.fromArray(b);b.type="Polygon3DList";return b};
PolygonList.prototype=new Table;PolygonList.prototype.constructor=PolygonList;function PolygonList(){var b=Table.apply(this,arguments);return b=PolygonList.fromArray(b)}PolygonList.fromArray=function(b){b=Table.fromArray(b);b.type="PolygonList";b.getFrame=PolygonList.prototype.getFrame;b.add=PolygonList.prototype.add;b.factor=PolygonList.prototype.factor;b.clone=PolygonList.prototype.clone;b.getString=PolygonList.prototype.getString;return b};
PolygonList.prototype.getFrame=function(){if(this.length==0)return null;for(var b=this[0].getFrame(),d=new Rectangle(b.x,b.y,b.getRight(),b.getBottom()),e=1;this[e]!=null;e++)b=this[e].getFrame(),d.x=Math.min(d.x,b.x),d.y=Math.min(d.y,b.y),d.width=Math.max(d.width,b.getRight()),d.height=Math.max(d.height,b.getBottom());d.width-=d.x;d.height-=d.y;return d};
PolygonList.prototype.add=function(b){var d;switch(typeOf(b)){case "Point":var e=new PolygonList;for(d=0;this[d]!=null;d++)e[d]=this[d].add(b);e.name=this.name;return e}};PolygonList.prototype.factor=function(b){for(var d=new PolygonList,e=0;this[e]!=null;e++)d[e]=this[e].factor(b);d.name=this.name;return d};PolygonList.prototype.clone=function(){for(var b=new PolygonList,d=0;this[d]!=null;d++)b[d]=this[d].clone();b.name=this.name;return b};Rectangle.prototype=new DataModel;
Rectangle.prototype.constructor=Rectangle;function Rectangle(b,d,e,f){DataModel.apply(this);this.name="";this.type="Rectangle";this.x=Number(b)||0;this.y=Number(d)||0;this.width=Number(e)||0;this.height=Number(f)||0}Rectangle.prototype.getRight=function(){return this.x+this.width};Rectangle.prototype.getBottom=function(){return this.y+this.height};Rectangle.prototype.setRight=function(b){this.width=b-this.x};Rectangle.prototype.setBottom=function(b){this.height=b-this.y};
Rectangle.prototype.getTopLeft=function(){return new Point(this.x,this.y)};Rectangle.prototype.getTopRight=function(){return new Point(this.x+this.width,this.y)};Rectangle.prototype.getBottomRight=function(){return new Point(this.x+this.width,this.y+this.height)};Rectangle.prototype.getBottomLeft=function(){return new Point(this.x,this.y+this.height)};Rectangle.prototype.getCenter=function(){return new Point(this.x+0.5*this.width,this.y+0.5*this.height)};
Rectangle.prototype.getRandomPoint=function(){return new Point(this.x+Math.random()*this.width,this.y+Math.random()*this.height)};Rectangle.prototype.getIntersection=function(b){if(b.x+b.width<this.x||b.x>this.x+this.width||b.y+b.height<this.y||b.y>this.y+this.height)return null;var d=Math.max(b.x,this.x),e=Math.max(b.y,this.y);return new Rectangle(d,e,Math.min(b.x+b.width,this.x+this.width)-d,Math.min(b.y+b.height,this.y+this.height)-e)};
Rectangle.prototype.interpolate=function(b,d){var e=1-d;return new Rectangle(e*this.x+d*b.x,e*this.y+d*b.y,e*this.width+d*b.width,e*this.height+d*b.height)};Rectangle.prototype.getRatio=function(){return Math.max(this.width,this.height)/Math.min(this.width,this.height)};Rectangle.prototype.getArea=function(){return this.width*this.height};Rectangle.prototype.containsPoint=function(b){return this.x<=b.x&&this.x+this.width>=b.x&&this.y<=b.y&&this.y+this.height>=b.y};
Rectangle.prototype.intersectsRectangle=function(b){return!(this.x+this.width<b.x)&&!(this.y+this.height<b.y)&&!(b.x+b.width<this.x)&&!(b.y+b.height<this.y)};Rectangle.prototype.expand=function(b,d){d=d||new Point(this.x+0.5*this.width,this.y+0.5*this.height);return new Rectangle((this.x-d.x)*b+d.x,(this.y-d.y)*b+d.y,this.width*b,this.height*b)};Rectangle.prototype.isEqual=function(b){return this.x==b.x&&this.y==b.y&&this.width==b.width&&this.height==b.height};
Rectangle.prototype.clone=function(){return new Rectangle(this.x,this.y,this.width,this.height)};Rectangle.prototype.toString=function(){return"(x="+this.x+", y="+this.y+", w="+this.width+", h="+this.height+")"};Rectangle.prototype.destroy=function(){delete this.x;delete this.y;delete this.width;delete this.height};RectangleList.prototype=new List;RectangleList.prototype.constructor=RectangleList;function RectangleList(){var b=List.apply(this,arguments);return b=RectangleList.fromArray(b)}
RectangleList.fromArray=function(b){b=List.fromArray(b);b.type="RectangleList";b.getFrame=RectangleList.prototype.getFrame;b.add=RectangleList.prototype.add;b.factor=RectangleList.prototype.factor;b.getAddedArea=RectangleList.prototype.getAddedArea;b.getIntersectionArea=RectangleList.prototype.getIntersectionArea;return b};
RectangleList.prototype.getFrame=function(){if(this.length==0)return null;var b=this[0];b.width=b.getRight();b.height=b.getBottom();for(var d=1;this[d]!=null;d++)b.x=Math.min(b.x,this[d].x),b.y=Math.min(b.y,this[d].y),b.width=Math.max(this[d].getRight(),b.width),b.height=Math.max(this[d].getBottom(),b.height);b.width-=b.x;b.height-=b.y;return b};RectangleList.prototype.add=function(){};RectangleList.prototype.factor=function(){};RectangleList.prototype.getAddedArea=function(){};
RectangleList.prototype.getIntersectionArea=function(){for(var b,d,e=0,f=0;this[f+1]!=null;f++){b=this[f];for(var g=f+1;this[g]!=null;g++)d=this[g],d=b.getIntersection(d),e+=d==null?0:d.getArea()}return e};ColorList.prototype=new List;ColorList.prototype.constructor=ColorList;function ColorList(){var b;for(b=0;b<arguments.length;b++)arguments[b]=arguments[b];b=List.apply(this,arguments);return b=ColorList.fromArray(b)}
ColorList.fromArray=function(b){b=List.fromArray(b);b.type="ColorList";b.getRgbArrays=ColorList.prototype.getRgbArrays;b.getInterpolated=ColorList.prototype.getInterpolated;b.getInverted=ColorList.prototype.getInverted;b.addAlpha=ColorList.prototype.addAlpha;return b};ColorList.prototype.getRgbArrays=function(){for(var b=new List,d=0;this[d]!=null;d++)b[d]=ColorOperators.HEXtoRGB(this[d]);return b};
ColorList.prototype.getInterpolated=function(b,d){for(var e=new ColorList,f=0;this[f]!=null;f++)e[f]=ColorOperators.interpolateColors(this[f],b,d);e.name=this.name;return e};ColorList.prototype.getInverted=function(){for(var b=new ColorList,d=0;this[d]!=null;d++)b[d]=ColorOperators.invertColor(this[d]);b.name=this.name;return b};ColorList.prototype.addAlpha=function(b){for(var d=new ColorList,e=0;this[e]!=null;e++)d[e]=ColorOperators.addAlpha(this[e],b);d.name=this.name;return d};
ColorScale.prototype=new DataModel;ColorScale.prototype.constructor=ColorScale;function ColorScale(b){DataModel.apply(this,arguments);this.name="";this.type="ColorScale";this.colorScaleFunction=b?b:ColorScales.blackScale}ColorScale.prototype.getColor=function(b){return this.colorScaleFunction(b)};ColorScale.prototype.getColorList=function(b){var d=new ColorList,e;for(e=0;e<b;e++)d.push(this.getColor(e/(b-1)));return d};Axis.prototype=new DataModel;Axis.prototype.constructor=Axis;
function Axis(b,d){b=b==null?new Interval(0,1):b;d=d==null?new Interval(0,1):d;DataModel.apply(this,arguments);this.departureInterval=b;this.arrivalInterval=d;this.setDepartureInterval(b);this.setArrivalInterval(d);this.type="Axis"}Axis.prototype.setDepartureInterval=function(b){this.departureInterval=b;c.log("--\> departureInterval",b);this.departureAmplitude=b.getSignedAmplitude()};Axis.prototype.setArrivalInterval=function(b){this.arrivalInterval=b;this.arrivalAmplitude=b.getSignedAmplitude()};
Axis.prototype.project=function(b){return this.arrivalInterval.x+this.arrivalAmplitude*(b-this.departureInterval.x)/this.departureAmplitude};Axis.prototype.update=function(){this.departureAmplitude=this.departureInterval.getSignedAmplitude();this.arrivalAmplitude=this.arrivalInterval.getSignedAmplitude()};Axis.prototype.toString=function(){return"Axis["+this.departureInterval.toString()+", "+this.arrivalInterval.toString()+"]"};Axis2D.prototype=new DataModel;Axis2D.prototype.constructor=Axis2D;
function Axis2D(b,d){d=d==null?new Rectangle(0,0,1,1):d;DataModel.apply(this,arguments);this.departureFrame=b;this.arrivalFrame=d;this.setFrames(b,d);this.type="Axis2D"}Axis2D.prototype.setFrames=function(b,d){this.departureFrame=b;this.arrivalFrame=d;this._update()};Axis2D.prototype.setDepartureFrame=function(b){this.departureFrame=b;this._update()};Axis2D.prototype.setArrivalFrame=function(b){this.arrivalFrame=b;this._update()};
Axis2D.prototype.project=function(b){return new Point((b.x-this.departureFrame.x)*this.pW+this.arrivalFrame.x,(b.y-this.departureFrame.y)*this.pH+this.arrivalFrame.y)};Axis2D.prototype.projectX=function(b){return(b-this.departureFrame.x)*this.pW+this.arrivalFrame.x};Axis2D.prototype.projectY=function(b){return(b-this.departureFrame.y)*this.pH+this.arrivalFrame.y};
Axis2D.prototype.inverseProject=function(b){return new Point((b.x-this.arrivalFrame.x)/this.pW+this.departureFrame.x,(b.y-this.arrivalFrame.y)/this.pH+this.departureFrame.y)};Axis2D.prototype.inverseProjectX=function(b){return(b-this.arrivalFrame.x)/this.pW+this.departureFrame.x};Axis2D.prototype.inverseProjectY=function(b){return(b-this.arrivalFrame.y)/this.pH+this.departureFrame.y};
Axis2D.prototype._update=function(){this.pW=this.arrivalFrame.width/this.departureFrame.width;this.pH=this.arrivalFrame.height/this.departureFrame.height};Axis2D.prototype.toString=function(){return"Axis2D["+this.departureFrame.toString()+", "+this.arrivalFrame.toString()+"]"};Interval.prototype=new Point;Interval.prototype.constructor=Interval;function Interval(b,d){DataModel.apply(this,arguments);this.x=Number(b);this.y=Number(d);this.type="Interval"}
Interval.prototype.getMin=function(){return Math.min(x,y)};Interval.prototype.getMax=function(){return Math.max(x,y)};Interval.prototype.getAmplitude=function(){return Math.abs(this.x-this.y)};Interval.prototype.getSignedAmplitude=function(){return this.x-this.y};Interval.prototype.getMiddle=function(){return(this.x+this.y)*0.5};Interval.prototype.getSign=function(){return this.x==this.y?0:this.getAmplitude()/this.getSignedAmplitude()};
Interval.prototype.getScaled=function(b){var d=0.5*(this.y-this.x),e=(this.x+this.y)*0.5;return new Interval(e-d*b,e+d*b)};Interval.prototype.getScaledFromProportion=function(b,d){var e=1-d,f=e*this.x+d*this.y;return new Interval(f-d*(this.y-this.x)*b,f+e*(this.y-this.x)*b)};Interval.prototype.add=function(b){return new Interval(this.x+b,this.y+b)};Interval.prototype.invert=function(){var b=this.x;this.x=this.y;this.y=b};
Interval.prototype.getInterpolatedValue=function(b){return b*Number(this.getSignedAmplitude())+this.x};Interval.prototype.getInverseInterpolatedValue=function(b){return(b-this.x)/this.getSignedAmplitude()};Interval.prototype.getInterpolatedValues=function(b){for(var d=[],e=b.length,f=0;f<e;f++)d.push(this.getInterpolatedValue(b[f]));return d};Interval.prototype.getInverseInterpolatedValues=function(b){for(var d=[],e=b.length,f=0;f<e;f++)d.push(this.getInverseInterpolatedValue(b[f]));return d};
Interval.prototype.clone=function(){var b=new Interval(this.x,this.y);b.name=name;return b};Interval.prototype.contains=function(b){return this.y>this.x?b>=this.x&&b<=this.y:b>=this.y&&b<=this.y};Interval.prototype.isEquivalent=function(b){return this.x==b.x&&this.y==b.y};Interval.prototype.toString=function(){return"Interval[x:"+this.x+"| y:"+this.y+"| amplitude:"+this.getAmplitude()+"]"};Matrix.prototype=new DataModel;Matrix.prototype.constructor=Matrix;
function Matrix(b,d,e,f,g,h){DataModel.apply(this,arguments);this.name="";this.type="Matrix";this.a=b==null?1:b;this.b=d==null?0:d;this.c=e==null?0:e;this.d=f==null?1:f;this.tx=g==null?0:g;this.ty=h==null?0:h}Matrix.prototype.transformPoint=function(b){return new Point(this.a*b.x+this.c*b.y+this.tx,this.b*b.x+this.d*b.y+this.ty)};
Matrix.prototype.concat=function(b){return Matrix(this.a*b.a+this.c*b.b,this.b*b.a+this.d*b.b,this.a*b.c+this.c*b.d,this.b*b.c+this.d*b.d,this.a*b.tx+this.c*b.ty+this.tx,this.b*b.tx+this.d*b.ty+this.ty)};Matrix.prototype.deltaTransformPoint=function(b){return Point(this.a*b.x+this.c*b.y,this.b*b.x+this.d*b.y)};
Matrix.prototype.getInverse=function(){var b=this.a*this.d-this.b*this.c;return new Matrix(this.d/b,-this.b/b,-this.c/b,this.a/b,(this.c*this.ty-this.d*this.tx)/b,(this.b*this.tx-this.a*this.ty)/b)};Matrix.prototype.rotate=function(b,d){return this.concat(Matrix.rotation(b,d))};Matrix.prototype.scale=function(b,d,e){return this.concat(Matrix.scale(b,d,e))};Matrix.prototype.translate=function(b,d){return this.concat(Matrix.translation(b,d))};NumberTable.prototype=new Table;
NumberTable.prototype.constructor=NumberTable;function NumberTable(){for(var b,d=0;arguments[d]!=null;d++)b=NumberList.fromArray(arguments[d]),b.name=arguments[d].name,arguments[d]=b;b=Table.apply(this,arguments);return b=NumberTable.fromArray(b)}
NumberTable.fromArray=function(b){b=Table.fromArray(b);b.type="NumberTable";b.getNumberListsNormalized=NumberTable.prototype.getNumberListsNormalized;b.getNormalizedToMax=NumberTable.prototype.getNormalizedToMax;b.getNumberListsNormalizedToMax=NumberTable.prototype.getNumberListsNormalizedToMax;b.getNumberListsNormalizedToSum=NumberTable.prototype.getNumberListsNormalizedToSum;b.getSums=NumberTable.prototype.getSums;b.getRowsSums=NumberTable.prototype.getRowsSums;b.getAverages=NumberTable.prototype.getAverages;
b.getRowsAverages=NumberTable.prototype.getRowsAverages;b.factor=NumberTable.prototype.factor;b.add=NumberTable.prototype.add;b.getMax=NumberTable.prototype.getMax;b.getMinMaxInterval=NumberTable.prototype.getMinMaxInterval;return b};NumberTable.prototype.getNumberListsNormalized=function(b){var b=b==null?1:b,d=new NumberTable,e;for(e=0;this[e]!=null;e++)numberList=this[e],d[e]=numberList.getNormalized(b);d.name=this.name;return d};
NumberTable.prototype.getNormalizedToMax=function(b){for(var b=b==null?1:b,d=new NumberTable,e=b/this.getMax(),b=0;this[b]!=null;b++)d[b]=this[b].factor(e);d.name=this.name;return d};NumberTable.prototype.getNumberListsNormalizedToMax=function(b){for(var d=new NumberTable,e=0;this[e]!=null;e++)numberList=this[e],d[e]=numberList.getNormalizedToMax(b);d.name=this.name;return d};
NumberTable.prototype.getNumberListsNormalizedToSum=function(){for(var b=new NumberTable,d=0;this[d]!=null;d++)numberList=this[d],b[d]=numberList.getNormalizedToSum();b.name=this.name;return b};NumberTable.prototype.getMax=function(){if(this.length==0)return null;for(var b=this[0].getMax(),d=1;this[d]!=null;d++)b=Math.max(this[d].getMax(),b);return b};
NumberTable.prototype.getMinMaxInterval=function(){if(this.length==0)return null;for(var b=this[0].getMinMaxInterval(),d=1;this[d]!=null;d++){var e=this[d].getMinMaxInterval();b.x=Math.min(b.x,e.x);b.y=Math.max(b.y,e.y)}return b};NumberTable.prototype.getSums=function(){for(var b=new NumberList,d=0;this[d]!=null;d++)b[d]=this[d].getSum();return b};NumberTable.prototype.getRowsSums=function(){for(var b=this[0].clone(),d,e=1;this[e]!=null;e++){d=this[e];for(var f=0;d[f]!=null;f++)b[f]+=d[f]}return b};
NumberTable.prototype.getAverages=function(){for(var b=new NumberList,d=0;this[d]!=null;d++)b[d]=this[d].getAverage();return b};NumberTable.prototype.getRowsAverages=function(){var b=this.length,d=this[0].clone().factor(1/b),e,f,g;for(f=1;this[f]!=null;f++){e=this[f];for(g=0;e[g]!=null;g++)d[g]+=e[g]/b}return d};
NumberTable.prototype.factor=function(b){var d=new NumberTable,e;switch(typeOf(b)){case "number":for(e=0;this[e]!=null;e++)numberList=this[e],d[e]=numberList.factor(b);break;case "NumberList":for(e=0;this[e]!=null;e++)numberList=this[e],d[e]=numberList.factor(b[e])}d.name=this.name;return d};NumberTable.prototype.add=function(b){for(var d=new NumberTable,e=0;this[e]!=null;e++)numberList=this[e],d[e]=numberList.add(b);d.name=this.name;return d};
function Space2D(b){b=b==null?{}:b;this.center=b.center==null?new Point(0,0):b.center;this.scale=1;b.interactionActive&&this.activeInteraction();this.MIN_SCALE=b.minScale==null?0.05:b.minScale;this.MAX_SCALE=b.maxScale==null?20:b.maxScale;this.active=b.interactionActive}
Space2D.prototype.activeInteraction=function(){if(!this.active)this.active=!0,addInteractionEventListener("mousedown",this.onMouse,this),addInteractionEventListener("mouseup",this.onMouse,this),addInteractionEventListener("mousewheel",this.wheel,this)};
Space2D.prototype.deActivate=function(){this.dragging=this.active=!1;removeInteractionEventListener("mousedown",this.onMouse,this);removeInteractionEventListener("mouseup",this.onMouse,this);removeInteractionEventListener("mousemove",this.onMouse,this);removeInteractionEventListener("mousewheel",this.wheel,this)};Space2D.prototype.stopDragging=function(){removeInteractionEventListener("mousemove",this.onMouse,this)};
Space2D.prototype.project=function(b){return new Point((b.x-this.center.x)*this.scale,(b.y+this.center.y)*this.scale)};Space2D.prototype.projectX=function(b){return(b-this.center.x)*this.scale};Space2D.prototype.projectY=function(b){return(b-this.center.y)*this.scale};Space2D.prototype.inverseProject=function(b){return new Point(b.x/this.scale+this.center.x,b.y/this.scale+this.center.y)};Space2D.prototype.inverseProjectX=function(b){return b/this.scale+this.center.x};
Space2D.prototype.inverseProjectY=function(b){return b/this.scale+this.center.y};Space2D.prototype.move=function(b,d){this.center=this.center.subtract(d?b.factor(1/this.scale):b)};Space2D.prototype.factorScaleFromPoint=function(b,d){var e=(1-1/d)/this.scale;this.center.x=e*b.x+this.center.x;this.center.y=e*b.y+this.center.y;this.scale*=d};Space2D.prototype.fixX=function(b,d){this.center.x=b-d/this.scale};Space2D.prototype.fixY=function(b,d){this.center.y=b-d/this.scale};
Space2D.prototype.fixHorizontalInterval=function(b,d){this.scale=d.getAmplitude()/b.getAmplitude();this.fixX((b.x+b.y)*0.5,cW*0.5)};
Space2D.prototype.onMouse=function(b){switch(b.type){case "mousedown":if(!this.active)break;this.dragging=!0;this.prev_mX=mX;this.prev_mY=mY;addInteractionEventListener("mousemove",this.onMouse,this);break;case "mouseup":this.dragging=!1;removeInteractionEventListener("mousemove",this.onMouse,this);break;case "mousemove":if(!this.active)break;this.center.x+=(this.prev_mX-mX)/this.scale;this.center.y+=(this.prev_mY-mY)/this.scale;this.prev_mX=mX;this.prev_mY=mY}};
Space2D.prototype.wheel=function(b){if(this.active)this.scale<=this.MIN_SCALE&&b.value>0?this.scale=this.MIN_SCALE:this.scale>=this.MAX_SCALE&&b.value<0?this.scale=this.MAX_SCALE:this.factorScaleFromPoint(new Point(mX-0,mY-0),1-0.02*b.value)};StringList.prototype=new List;StringList.prototype.constructor=StringList;function StringList(){for(var b=0;b<arguments.length;b++)arguments[b]=String(arguments[b]);b=List.apply(this,arguments);return b=StringList.fromArray(b)}
StringList.fromArray=function(b,d){var d=d==null?!0:d,e=List.fromArray(b);if(d)for(var f=0;f<e.length;f++)e[f]=String(e[f]);e.type="StringList";e.toLowerCase=StringList.prototype.toLowerCase;e.toUpperCase=StringList.prototype.toUpperCase;e.append=StringList.prototype.append;e.getSurrounded=StringList.prototype.getSurrounded;e.replace=StringList.prototype.replace;e.getConcatenated=StringList.prototype.getConcatenated;e.toNumberList=StringList.prototype.toNumberList;e.toDateList=StringList.prototype.toDateList;
e.clone=StringList.prototype.clone;return e};StringList.prototype.append=function(b,d){var d=d==null?!0:d,e=new StringList;e.name=this.name;var f=typeOf(b)=="StringList",g;if(d)for(g=0;this[g]!=null;g++)e[g]=this[g]+(f?b[g]:b);else for(g=0;this[g]!=null;g++)e[g]=(f?b[g]:b)+this[g];return e};StringList.prototype.getSurrounded=function(b,d){var e=new StringList;e.name=this.name;var f,g=Array.isArray(b),h=Array.isArray(d);for(f=0;this[f]!=null;f++)e[f]=(g?b[f]:b)+this[f]+(h?d[f]:d);return e};
StringList.prototype.replace=function(b,d){var e=new StringList;e.name=this.name;for(var f=0;this[f]!=null;f++)e[f]=this[f].replace(b,d);return e};StringList.prototype.getConcatenated=function(b){var d,e="";for(d=0;this[d]!=null;d++)e+=this[d],d<this.length-1&&(e+=b);return e};StringList.prototype.toLowerCase=function(){var b=new StringList;b.name=this.name;var d;for(d=0;this[d]!=null;d++)b[d]=this[d].toLowerCase();return b};
StringList.prototype.toUpperCase=function(){var b=new StringList;b.name=this.name;var d;for(d=0;this[d]!=null;d++)b[d]=this[d].toUpperCase();return b};StringList.prototype.toNumberList=function(){var b=new NumberList;b.name=this.name;var d;for(d=0;this[d]!=null;d++)b[d]=Number(this[d]);return b};StringList.prototype.toDateList=function(b,d){var e=new DateList,f;for(f=0;this[f]!=null;f++)e.push(DateOperators.stringToDate(this[f],b,d));return e};
StringList.prototype.clone=function(){var b=StringList.fromArray(this.slice(),!1);b.name=this.name;return b};Relation.prototype=new Node;Relation.prototype.constructor=Relation;function Relation(b,d,e,f,g){Node.apply(this,[b,d]);this.node0=e;this.node1=f;this.weight=g==null?1:g}Relation.prototype.destroy=function(){Node.prototype.destroy.call(this);delete this.node0;delete this.node1};Relation.prototype.getOther=function(b){return b==this.node0?this.node1:this.node0};
Relation.prototype.clone=function(){var b=new Relation(this.id,this.name,this.node0,this.node1);b.x=this.x;b.y=this.y;b.z=this.z;b.nodeType=this.nodeType;b.weight=this.weight;b.descentWeight=this.descentWeight;return b};function Network(){this.type="Network";this._newRelationID=this._newNodeID=0;this.nodeList=new NodeList;this.relationList=new RelationList}Network.prototype.addNode=function(b){this.nodeList.addNode(b)};Network.prototype.getNodeWithName=function(b){return this.nodeList.getNodeWithName(b)};
Network.prototype.getNodeWithId=function(b){return this.nodeList.getNodeWithId(b)};Network.prototype.addRelation=function(b){this.relationList.addNode(b);b.node0.nodeList.addNode(b.node1);b.node0.relationList.addNode(b);b.node0.toNodeList.addNode(b.node1);b.node0.toRelationList.addNode(b);b.node1.nodeList.addNode(b.node0);b.node1.relationList.addNode(b);b.node1.fromNodeList.addNode(b.node0);b.node1.fromRelationList.addNode(b)};
Network.prototype.createRelation=function(b,d,e,f){e=e||b.id+"_"+d.id;b=new Relation(e,e,b,d,f||1);this.addRelation(b);return b};Network.prototype.removeNode=function(b){this.removeNodeRelations(b);this.nodeList.removeNode(b)};Network.prototype.removeNodeRelations=function(b){for(var d=0;b.relationList[d]!=null;d++)this.removeRelation(b.relationList[d]),d--};Network.prototype.removeNodes=function(){this.nodeList.deleteNodes();this.relationList.deleteNodes()};
Network.prototype.removeRelation=function(b){this.relationList.removeElement(b);b.node0.nodeList.removeNode(b.node1);b.node0.relationList.removeRelation(b);b.node0.toNodeList.removeNode(b.node1);b.node0.toRelationList.removeRelation(b);b.node1.nodeList.removeNode(b.node0);b.node1.relationList.removeRelation(b);b.node1.fromNodeList.removeNode(b.node0);b.node1.fromRelationList.removeRelation(b)};
Network.prototype.removeIsolatedNodes=function(b){var d,b=b==null?1:b;for(d=0;this.nodeList[d]!=null;d++)this.nodeList[d].relationList.length<b&&(this.removeNode(this.nodeList[d]),d--)};Network.prototype.getNewNodeID=function(){id=this._newNodeID;this._newNodeID++;return id};Network.prototype.getNewRelationID=function(){id=this._newRelationID;this._newRelationID++;return id};
Network.prototype.getReport=function(){return"network contains "+this.nodeList.length+" nodes and "+this.relationList.length+" relations"};Network.prototype.destroy=function(){delete this.type;delete this._newNodeID;delete this._newRelationID;this.nodeList.destroy();this.relationList.destroy();delete this.nodeList;delete this.relationList};Tree.prototype=new Network;Tree.prototype.constructor=Tree;
function Tree(){Network.apply(this);this.type="Tree";this.nLevels=0;this._createRelation=this.createRelation;this.createRelation=this._newCreateRelation}Tree.prototype.addNodeToTree=function(b,d){this.addNode(b);d==null?(b.level=0,b.parent=null):(this._createRelation(d,b),b.level=d.level+1,b.parent=d);this.nLevels=Math.max(this.nLevels,b.level+1)};
Network.prototype._newCreateRelation=function(b,d,e,f){this._createRelation(b,d,e,f);d.level=b.level+1;d.parent=b;this.nLevels=Math.max(this.nLevels,d.level+1)};Tree.prototype.addFather=function(b){if(child.parent!=null||this.nodeList.indexOf(child)==-1)return!1;this.addNode(b);child.parent=b;child.level=1;this.nLevels=Math.max(this.nLevels,1);this.createRelation(b,child)};
Tree.prototype.getNodesByLevel=function(b){var d=new NodeList;for(i=0;this.nodeList[i]!=null;i++)this.nodeList[i].level==b&&d.push(this.nodeList[i]);return d};Tree.prototype.assignDescentWeightsToNodes=function(){this._assignDescentWeightsToNode(this.nodeList[0])};Tree.prototype._assignDescentWeightsToNode=function(b){var d;for(d=0;b.toNodeList[d]!=null;d++)b.descentWeight+=this._assignDescentWeightsToNode(b.toNodeList[d]);return b.descentWeight};
Tree.prototype.getReport=function(){return"Tree contains "+this.nodeList.length+" nodes and "+this.relationList.length+" relations"};function ObjectOperators(){}ObjectOperators.getPropertyValue=function(b,d){return b==null?null:b[d]};ObjectOperators.fusionObjects=function(){};
ObjectOperators.addition=function(){var b,d;if(arguments.length<2){if(arguments.length==1&&arguments[0]!=null&&arguments[0].isList){b=arguments[0][0];for(d=1;arguments[0][d]!=null;d++)b=ObjectOperators.addition(b,arguments[0][d]);return b}return null}if(arguments.length==2){if(arguments[0].isList&&arguments[1].isList)return ObjectOperators._applyBinaryOperatorOnLists(arguments[0],arguments[1],ObjectOperators.addition);else if(arguments[0].isList)return ObjectOperators._applyBinaryOperatorOnListWithObject(arguments[0],
arguments[1],ObjectOperators.addition);else if(arguments[1].isList)return ObjectOperators._applyBinaryOperatorOnListWithObject(arguments[1],arguments[0],ObjectOperators.addition);b=arguments[0];d=arguments[1];var e=typeOf(b),f=typeOf(d),g=!1;f<e&&(b=arguments[1],d=arguments[0],e=typeOf(b),f=typeOf(d),g=!0);e=e+"_"+f;c.log("pairType:["+e+"]");switch(e){case "boolean_number":case "number_number":break;case "boolean_boolean":return b&&d;case "date_string":return g?d+DateOperators.dateToString(b):DateOperators.dateToString(b)+
d;case "number_string":case "string_string":break;case "Point_Point":return new Point(b.x+d.x,b.y+d.y);case "Point3D_Point3D":return new Point3D(b.x+d.x,b.y+d.y,b.z+d.z);case "number_Point":return new Point(b.x+d,b.y+d);case "number_Point3D":return new Point3D(b.x+d,b.y+d,b.z+d);case "Interval_number":return new Interval(b.getMin()+d,b.getMax()+d);case "Interval_Point":return new Point(b.getMin()+d.x,b.getMax()+d.y);case "Interval_Interval":return new Point(b.getMin()+d.getMin(),b.getMax()+d.getMax());
case "Point_Rectangle":return new Rectangle(b.x+d.x,b.y+d.y,d.width,d.height);case "Interval_Rectangle":return new Rectangle(b.getMin()+d.x,b.getMax()+d.y,d.width,d.height);case "Rectangle_Rectangle":return new Rectangle(b.x+d.x,b.y+d.y,b.width+d.width,b.height+d.height);case "date_number":return new Date(b.getTime()+d/DateOperators.millisecondsToDays);case "date_date":return new Date(Number(b.getTime()+d.getTime()));case "date_DateInterval":return new DateInterval(ObjectOperators.addition(b,d.date0),
ObjectOperators.addition(b,d.date1));case "DateInterval_number":return new DateInterval(ObjectOperators.addition(b.date0,d),ObjectOperators.addition(b.date1,d));case "DateInterval_Interval":return new DateInterval(ObjectOperators.addition(b.date0,d.min),ObjectOperators.addition(b.date1,d.max));case "DateInterval_DateInterval":return new DateInterval(ObjectOperators.addition(b.date0,d.date0),ObjectOperators.addition(b.date1,d.date1));default:return c.log("[!] addition didn't manage to resolve:",e,
b+d),null}return b+d}b=arguments[0];for(d=1;d<arguments.length;d++)b=ObjectOperators.addition(b,arguments[d]);return b};
ObjectOperators.multiplication=function(){var b,d;if(arguments.length<2){if(arguments.length==1&&arguments[0].isList){b=arguments[0][0];for(d=1;arguments[0][d]!=null;d++)b=ObjectOperators.multiplication(b,arguments[0][d]);return b}return null}if(arguments.length==2){if(arguments[0].isList&&arguments[1].isList)return ObjectOperators._applyBinaryOperatorOnLists(arguments[0],arguments[1],ObjectOperators.multiplication);else if(arguments[0].isList)return ObjectOperators._applyBinaryOperatorOnListWithObject(arguments[0],
arguments[1],ObjectOperators.multiplication);else if(arguments[1].isList)return ObjectOperators._applyBinaryOperatorOnListWithObject(arguments[1],arguments[0],ObjectOperators.multiplication);b=arguments[0];d=arguments[1];var e=typeOf(b),f=typeOf(d);f<e&&(b=arguments[1],d=arguments[0],e=typeOf(b),f=typeOf(d));e=e+"_"+f;switch(e){case "number_number":case "boolean_boolean":case "boolean_number":case "Date_string":case "number_string":case "string_string":break;case "Point_Point":return new Point(b.x*
d.x,b.y*d.y);case "Point3D_Point3D":return new Point3D(b.x*d.x,b.y*d.y,b.z*d.z);case "number_Point":return new Point(b.x*d,b.y*d);case "number_Point3D":return new Point3D(b.x*d,b.y*d,b.z*d);case "Interval_number":return new Interval(b.getMin()*d,b.getMax()*d);case "Interval_Point":return new Point(b.getMin()*d.x,b.getMax()*d.y);case "Interval_Interval":return new Point(b.getMin()+d.getMin(),b.getMax()+d.getMax());case "Point_Rectangle":return new Rectangle(b.x*d.x,b.y*d.y,d.width,d.height);case "Interval_Rectangle":return new Rectangle(b.getMin()*
d.x,b.getMax()*d.y,d.width,d.height);case "Rectangle_Rectangle":return new Rectangle(b.x*d.x,b.y*d.y,b.width*d.width,b.height*d.height);case "date_number":return new Date(b.getTime()*(d/DateOperators.millisecondsToDays));case "date_date":return new Date(Number(b.getTime()+d.getTime()));case "date_DateInterval":return new DateInterval(ObjectOperators.multiplication(b,d.date0),ObjectOperators.multiplication(b,d.date1));case "DateInterval_number":return new DateInterval(ObjectOperators.multiplication(b.date0,
d),ObjectOperators.multiplication(b.date1,d));case "DateInterval_Interval":return new DateInterval(ObjectOperators.multiplication(b.date0,d.min),ObjectOperators.multiplication(b.date1,d.max));case "DateInterval_DateInterval":return new DateInterval(ObjectOperators.multiplication(b.date0,d.date0),ObjectOperators.multiplication(b.date1,d.date1));default:return c.log("[!] multiplication didn't manage to resolve:",e,b*d),null}return b*d}b=arguments[0];for(d=1;d<arguments.length;d++)b=ObjectOperators.multiplication(b,
arguments[d]);return b};
ObjectOperators.division=function(){var b,d;if(arguments.length<2){if(arguments.length==1&&arguments[0].isList){b=arguments[0][0];for(d=1;arguments[0][d]!=null;d++)b=ObjectOperators.division(b,arguments[0][d]);return b}return null}if(arguments.length==2){if(arguments[0].isList&&arguments[1].isList)return ObjectOperators._applyBinaryOperatorOnLists(arguments[0],arguments[1],ObjectOperators.division);else if(arguments[0].isList)return ObjectOperators._applyBinaryOperatorOnListWithObject(arguments[0],arguments[1],
ObjectOperators.division);else if(arguments[1].isList)return ObjectOperators._applyBinaryOperatorOnListWithObject(arguments[1],arguments[0],ObjectOperators.division);b=arguments[0];d=arguments[1];var e=typeOf(b),f=typeOf(d);f<e&&(b=arguments[1],d=arguments[0],e=typeOf(b),f=typeOf(d));e=e+"_"+f;switch(e){case "number_number":case "boolean_boolean":case "boolean_number":case "Date_string":case "number_string":case "string_string":break;case "Point_Point":return new Point(b.x/d.x,b.y/d.y);case "Point3D_Point3D":return new Point3D(b.x/
d.x,b.y/d.y,b.z/d.z);case "number_Point":return new Point(b.x/d,b.y/d);case "number_Point3D":return new Point3D(b.x/d,b.y/d,b.z/d);case "Interval_number":return new Interval(b.getMin()/d,b.getMax()/d);case "Interval_Point":return new Point(b.getMin()/d.x,b.getMax()/d.y);case "Interval_Interval":return new Point(b.getMin()+d.getMin(),b.getMax()+d.getMax());case "Point_Rectangle":return new Rectangle(b.x/d.x,b.y/d.y,d.width,d.height);case "Interval_Rectangle":return new Rectangle(b.getMin()/d.x,b.getMax()/
d.y,d.width,d.height);case "Rectangle_Rectangle":return new Rectangle(b.x/d.x,b.y/d.y,b.width/d.width,b.height/d.height);case "date_number":return new Date(b.getTime()/(d/DateOperators.millisecondsToDays));case "date_date":return new Date(Number(b.getTime()+d.getTime()));case "date_DateInterval":return new DateInterval(ObjectOperators.division(b,d.date0),ObjectOperators.division(b,d.date1));case "DateInterval_number":return new DateInterval(ObjectOperators.division(b.date0,d),ObjectOperators.division(b.date1,
d));case "DateInterval_Interval":return new DateInterval(ObjectOperators.division(b.date0,d.min),ObjectOperators.division(b.date1,d.max));case "DateInterval_DateInterval":return new DateInterval(ObjectOperators.division(b.date0,d.date0),ObjectOperators.division(b.date1,d.date1));default:return c.log("[!] division didn't manage to resolve:",e,b/d),null}return b/d}b=arguments[0];for(d=1;d<arguments.length;d++)b=ObjectOperators.division(b,arguments[d]);return b};
ObjectOperators._applyBinaryOperatorOnLists=function(b,d,e){var f=Math.min(b.length,d.length),g,h=new List;for(g=0;g<f;g++)h.push(ObjectOperators._applyBinaryOperator(b[g],d[g],e));return h.getImproved()};ObjectOperators._applyBinaryOperatorOnListWithObject=function(b,d,e){var f,g=new List;for(f=0;f<b.length;f++)g.push(ObjectOperators._applyBinaryOperator(b[f],d,e));return g.getImproved()};ObjectOperators._applyBinaryOperator=function(b,d,e){return e(b,d)};ObjectConversions=function(){};
ObjectOperators.conversor=function(b,d){var e;e=typeOf(b)+"_"+d;c.log("ObjectOperators.conversor, pairType:",e);switch(e){case "NumberTable_Polygon":var f=new Polygon,g=b.length>1;for(e=0;b[0][e]!=null;e++)f[e]=new Point(b[0][e],g?b[1][e]:0);return f;case "date_string":return DateOperators.dateToString(b);case "string_date":return DateOperators.stringToDate(b);case "date_number":return b.getTime();case "number_date":return new Date(b);case "List_StringList":case "NumberList_StringList":return b.toStringList();
case "StringList_NumberList":return b.toNumberList();case "Object_string":return JSON.stringify(b,null,"\t");case "string_Object":return JSON.parse(b);case "string_ColorScale":return ColorScales[b];case "string_Table":return TableEncodings.CSVtoTable(b)}switch(d){case "string":return b.toString();case "number":return Number(b)}};DateOperators.millisecondsToHours=1/36E5;DateOperators.millisecondsToDays=1/864E5;DateOperators.millisecondsToYears=3.169E-11;
DateOperators.MONTH_NAMES_SHORT=["jan","feb","mar","apr","mai","jun","jul","aug","sep","oct","nov","dec"];function DateOperators(){}
DateOperators.stringToDate=function(b,d,e){d=d==null?0:d;b=b.split(e==null?"-":e);switch(d){case 0:return new Date(Number(b[2]),Number(b[0])-1,Number(b[1]));case 1:return new Date(Number(b[0]),Number(b[1])-1,Number(b[2]));case 2:return d=Number(b[2]),new Date(d>=0?d+2E3:d+1900,Number(b[0])-1,Number(b[1]));case 3:return d=Number(b[0]),new Date(d>=0?d+2E3:d+1900,Number(b[1])-1,Number(b[2]))}};
DateOperators.dateToString=function(b,d,e){var e=e==null?"-":e,d=d==null?0:d,f=b.getFullYear(),g=b.getMonth()+1,b=b.getDate();switch(d){case 0:return g+e+b+e+f;case 1:return f+e+g+e+b}};DateOperators.currentDate=function(){return new Date};DateOperators.addDaysToDate=function(b,d){return new Date(b.getTime()+d/DateOperators.millisecondsToDays)};DateOperators.parseDate=function(b){return new Date(Date.parse(b.replace(/\./g,"-")))};
DateOperators.parseDates=function(b){var d=new DateList,e;for(e=0;b[e]!=null;e++)d.push(this.parseDate(b[e]));return d};DateOperators.getHoursBetweenDates=function(b,d){return(d.getTime()-b.getTime())*DateOperators.millisecondsToHours};DateOperators.getDaysBetweenDates=function(b,d){return(d.getTime()-b.getTime())*DateOperators.millisecondsToDays};DateOperators.getYearsBetweenDates=function(b,d){return(d.getTime()-b.getTime())*DateOperators.millisecondsToYears};
DateOperators.nDayInYear=function(b){return Math.floor((b.getTime()-(new Date(b.getFullYear(),0,1)).getTime())*DateOperators.millisecondsToDays)};DateOperators.getDateDaysAgo=function(b){return DateOperators.addDaysToDate(new Date,-b)};function CountryListOperators(){}CountryListOperators.getCountryByName=function(b,d){for(var e=CountryOperators.getSimplifiedName(d),f=0;b[f]!=null;f++)if(b[f].simplifiedNames.indexOf(e)!=-1)return b[f];return null};function CountryOperators(){}
CountryOperators.getSimplifiedName=function(b){return b.replace(/[\.\- ,\']/g,"").toLowerCase()};CountryOperators.getSimplifiedNames=function(b){for(var d=new StringList,e,f=0;b[f]!=null;f++)e=this.getSimplifiedName(b[f]),e!=""&&d.pushIfUnique(e);return d};function GeoOperators(){}GeoOperators.EARTH_RADIUS=6371009;GeoOperators.EARTH_DIAMETER=GeoOperators.EARTH_RADIUS*2;GeoOperators.geoCoordinateToDecimal=function(b){return Math.floor(b)+(b-Math.floor(b))*1.66667};
GeoOperators.geoDistance=function(b,d){var e=Math.pow(Math.sin((d.y-b.y)*0.5*gradToRad),2)+Math.cos(b.y*gradToRad)*Math.cos(d.y*gradToRad)*Math.pow(Math.sin((d.x-b.x)*0.5*gradToRad),2);return GeoOperators.EARTH_DIAMETER*Math.atan2(Math.sqrt(e),Math.sqrt(1-e))};GeoOperators.polygonLength=function(b){if(b.length<2)return 0;for(var d=GeoOperators.geoDistance(b[0],b[1]),e=2;b[e]!=null;e++)d+=GeoOperators.geoDistance(b[e-1],b[e]);return d};function GeometryConvertions(){}
GeometryConvertions.twoNumberListsToPolygon=function(b,d){for(var e=Math.min(b.length,d.length),f=new Polygon,g=0;g<e;g++)f[g]=new Point(b[g],d[g]);return f};function GeometryOperators(){}GeometryOperators.getSoftenControlPoints=function(b,d,e,f){f=f||10;e=PointOperators.angleFromTwoPoints(b,e);b=new Point(d.x-f*Math.cos(e),d.y-f*Math.sin(e));d=new Point(d.x+f*Math.cos(e),d.y+f*Math.sin(e));return[b,d]};
GeometryOperators.bezierCurvePoints=function(b,d,e,f,g,h,k,l,m){var n=1-m,o=n*e+m*g,q=n*f+m*h;return new Point(m*(n*o+m*(n*g+m*k))+n*(n*(n*b+m*e)+m*o),m*(n*q+m*(n*h+m*l))+n*(n*(n*d+m*f)+m*q))};GeometryOperators.bezierCurveHeightHorizontalControlPoints=function(b,d,e,f,g){d=Math.cos(Math.PI*(g-1));e=d>0?1:-1;return(0.5+0.5*Math.pow(d*e,0.6)*e)*(f-b)+b};
GeometryOperators.distanceToBezierCurve=function(b,d,e,f,g,h,k,l,m,n){var o=0,q=1,s=new Point(b,d),u=GeometryOperators.bezierCurvePoints(b,d,e,f,g,h,k,l,0.01),t=new Point(k,l);GeometryOperators.bezierCurvePoints(b,d,e,f,g,h,k,l,0.99);for(var s=Math.pow(s.x-m.x,2)+Math.pow(s.y-m.y,2),v=Math.pow(u.x-m.x,2)+Math.pow(u.y-m.y,2),u=Math.pow(t.x-m.x,2)+Math.pow(t.y-m.y,2),w=0;w<10;w++)s=GeometryOperators.bezierCurvePoints(b,d,e,f,g,h,k,l,(o+q)*0.5),v=GeometryOperators.bezierCurvePoints(b,d,e,f,g,h,k,l,(o+
q)*0.5+0.01),s=Math.pow(s.x-m.x,2)+Math.pow(s.y-m.y,2),v=Math.pow(v.x-m.x,2)+Math.pow(v.y-m.y,2),s<v?(q=(o+q)*0.5,t=GeometryOperators.bezierCurvePoints(b,d,e,f,g,h,k,l,q),u=Math.pow(t.x-m.x,2)+Math.pow(t.y-m.y,2)):(o=(o+q)*0.5,s=GeometryOperators.bezierCurvePoints(b,d,e,f,g,h,k,l,o),s=Math.pow(s.x-m.x,2)+Math.pow(s.y-m.y,2));return n?t:Math.sqrt(Math.min(s,u))};
GeometryOperators.triangleContainsPoint=function(b,d,e,f){var g=(b.x-f.x)*(d.y-f.y)-(d.x-f.x)*(b.y-f.y),d=(d.x-f.x)*(e.y-f.y)-(e.x-f.x)*(d.y-f.y),b=(e.x-f.x)*(b.y-f.y)-(b.x-f.x)*(e.y-f.y);return g>0&&d>0&&b>0||g>=0&&d>=0&&b>=0};GeometryOperators.triangleArea=function(b){return Math.abs(b.a.x*(b.b.y-b.c.y)+b.b.x*(b.c.y-b.a.y)+b.c.x*(b.a.y-b.b.y))/2};GeometryOperators.lineFromTwoPoints=function(b,d){if(b.x==d.x)return new Point(Infinity,b.x);var e=(d.y-b.y)/(d.x-b.x);return new Point(e,b.y-e*b.x)};
GeometryOperators.distancePointToLine=function(b,d){var e,f;d.x==0?(e=Infinity,f=b.x):(e=-1/d.x,f=b.y-e*b.x);e=GeometryOperators.intersectionLines(d,new Point(e,f));return Math.sqrt(Math.pow(b.x-e.x,2)+Math.pow(b.y-e.y,2))};
GeometryOperators.distancePointToSegment=function(b,d,e){var f=d.x==e.x?Infinity:(e.y-d.y)/(e.x-d.x);line=f==Infinity?new Point(Infinity,d.x):new Point(f,d.y-f*d.x);var g;line.x==0?(f=Infinity,g=b.x):(f=-1/line.x,g=b.y-f*b.x);f=GeometryOperators.intersectionLines(line,new Point(f,g));return f.x>=Math.min(d.x,e.x)&&f.x<=Math.max(d.x,e.x)?b.distanceToPoint(f):Math.min(b.distanceToPoint(d),b.distanceToPoint(e))};
GeometryOperators.intersectionLines=function(b,d){if(b.x==d.x)return b.y==d.y?b.x==Infinity?new Point(b.y,0):new Point(0,b.y):null;if(b.x==Infinity)return new Point(b.y,d.x*b.y+d.y);else if(d.x==Infinity)return new Point(d.y,b.x*d.y+b.y);var e=(d.y-b.y)/(b.x-d.x);return new Point(e,b.x*e+b.y)};
GeometryOperators.VennCircles=function(b,d,e,f,g){b=Math.sqrt(b/Math.PI);d=Math.sqrt(d/Math.PI);g=GeometryOperators.circleDistancesFromCommonArea(b,d,e,g);if(f)var h=(g*g+Math.pow(b,2)-Math.pow(d,2))/(2*g),f=new Point3D(-h,0,b),b=new Point3D(g-h,0,d);else f=new Point3D(-g*0.5,0,b),b=new Point3D(g*0.5,0,d);e==0&&(f.x-=g*0.1,b.x+=g*0.1);return new Polygon3D(f,b)};
GeometryOperators.circleDistancesFromCommonArea=function(b,d,e,f){for(var f=f||0.1,g=Math.max(b,d)-Math.min(b,d),h=b+d,k=(g+h)*0.5,l=0,m=GeometryOperators.circlesCommonArea(b,d,k);Math.abs(m-e)>f&&l<200;)m>e?(g=k,k=(h+k)*0.5):(h=k,k=(k+g)*0.5),l++,m=GeometryOperators.circlesCommonArea(b,d,k);return k};
GeometryOperators.circlesCommonArea=function(b,d,e){if(e>=b+d)return 0;if(e+Math.min(b,d)<=Math.max(b,d))return Math.PI*Math.pow(Math.min(b,d),2);var f=Math.pow(e,2),g=Math.pow(b,2),h=Math.pow(d,2);return g*Math.acos((f+g-h)/(2*e*b))+h*Math.acos((f+h-g)/(2*e*d))-0.5*Math.sqrt((-e+b+d)*(e+b-d)*(e-b+d)*(e+b+d))};
GeometryOperators.circlesLensAngles=function(b,d){if(d.x<b.x)var e=d.clone(),d=b.clone(),b=e;if(d.x+d.z<=b.x+b.z)return null;else if(b.x-b.z>=d.x-d.z)return null;var e=d.x-b.x,e=(e*e+Math.pow(b.z,2)-Math.pow(d.z,2))/(2*e),f=Math.acos(e/b.z),g=Math.asin(b.z*Math.sin(f)/d.z);return b.x+e<d.x?new NumberList(-f,f,Math.PI-g,Math.PI+g):new NumberList(-f,f,g,-g)};GeometryOperators.delauney=function(b){return _triangulate(b)};
function Triangle(b,d,e){this.a=b;this.b=d;this.c=e;var f=d.x-b.x,g=d.y-b.y,h=e.x-b.x,k=e.y-b.y,l=f*(b.x+d.x)+g*(b.y+d.y),m=h*(b.x+e.x)+k*(b.y+e.y),n=2*(f*(e.y-d.y)-g*(e.x-d.x));Math.abs(n)<1.0E-6?(f=Math.min(b.x,d.x,e.x),g=Math.min(b.y,d.y,e.y),h=(Math.max(b.x,d.x,e.x)-f)*0.5,b=(Math.max(b.y,d.y,e.y)-g)*0.5,this.x=f+h,this.y=g+b):(this.x=(k*l-g*m)/n,this.y=(f*m-h*l)/n,h=this.x-b.x,b=this.y-b.y);this.r=h*h+b*b}function byX(b,d){return d.x-b.x}
function dedup(b){var d=b.length,e,f,g,h,k;a:for(;d;){f=b[--d];e=b[--d];for(g=d;g;)if(k=b[--g],h=b[--g],e===h&&f===k||e===k&&f===h){b.splice(d,2);b.splice(g,2);d-=2;continue a}}}
function _triangulate(b){if(b.length<3)return[];b.sort(byX);for(var d=b.length-1,e=b[d].x,f=b[0].x,g=b[d].y,h=g;d--;){if(b[d].y<g)g=b[d].y;if(b[d].y>h)h=b[d].y}for(var k=f-e,l=h-g,d=k>l?k:l,k=(f+e)*0.5,l=(h+g)*0.5,g=[new Triangle({x:k-20*d,y:l-d,__sentinel:!0},{x:k,y:l+20*d,__sentinel:!0},{x:k+20*d,y:l-d,__sentinel:!0})],h=[],e=[],d=b.length;d--;){e.length=0;for(f=g.length;f--;)k=b[d].x-g[f].x,k>0&&k*k>g[f].r?(h.push(g[f]),g.splice(f,1)):(l=b[d].y-g[f].y,k*k+l*l>g[f].r||(e.push(g[f].a,g[f].b,g[f].b,
g[f].c,g[f].c,g[f].a),g.splice(f,1)));dedup(e);for(f=e.length;f;)l=e[--f],k=e[--f],g.push(new Triangle(k,l,b[d]))}Array.prototype.push.apply(h,g);for(d=h.length;d--;)(h[d].a.__sentinel||h[d].b.__sentinel||h[d].c.__sentinel)&&h.splice(d,1);return h}function PointOperators(){}PointOperators.angleBetweenVectors=function(b,d){return Math.atan2(d.y,d.x)-Math.atan2(b.y,b.x)};PointOperators.angleFromTwoPoints=function(b,d){return Math.atan2(d.y-b.y,d.x-b.x)};
PointOperators.dot=function(b,d){return b.x*d.x+b.y*d.y};PointOperators.twoPointsInterpolation=function(b,d,e){return new Point((1-e)*b.x+e*d.x,(1-e)*b.y+e*d.y)};function PolygonGenerators(){}PolygonGenerators.createPolygon=function(b,d,e){var f=new Polygon;switch(d){case 0:for(d=0;d<b;d++)f.push(new Point(e.x+e.width*Math.random(),e.y+e.height*Math.random()))}return f};function PolygonListEncodings(){}
PolygonListEncodings.StringToPolygonList=function(b,d,e){var d=d||",",e=e||"/",f=new PolygonList;pols=StringOperators.splitString(b,e);for(var g,h,k=0;pols[k]!=null;k++){b=new Polygon;h=StringOperators.splitString(pols[k],d);for(g=0;h[g]!=null;g+=2)e=new Point(Number(h[g]),Number(h[g+1])),b.push(e);f.push(b)}return f};
PolygonListEncodings.polygonListToString=function(b,d,e){for(var d=d||",",e=e||"/",f="",g=0;this[g]!=null;g++){f+=g==0?"":e;for(b=0;this[g][b]!=null;b++)f+=(b==0?"":d)+this[g][b].x+d+this[g][b].y}return f};function PolygonListOperators(){}PolygonListOperators.simplifyPolygons=function(b,d,e){for(var f=new PolygonList,g,h=0;b[h]!=null;h++)g=PolygonOperators.simplifyPolygon(b[h],d),(g.length>0||!e)&&f.push(g);return f};function PolygonOperators(){}
PolygonOperators.hull=function(b,d){var d=d==null?!1:d,e,f,g=b;f=g.length;var h=0,k=new Polygon;if(d)var l=new NumberList;g=this.sortOnXY(g);if(d){for(e=0;e<f;e++){for(;h>=2&&this.crossProduct3Points(k[h-2],k[h-1],g[e])<=0;)h--;k[h++]=g[e];l[h-1]=e}e=f-2;for(f=h+1;e>=0;e--){for(;h>=f&&this.crossProduct3Points(k[h-2],k[h-1],g[e])<=0;)h--;k[h++]=g[e];l[h-1]=e}return NumberList.fromArray(l.getSubList(new Interval(0,h-2)))}for(e=0;e<f;e++){for(;h>=2&&this.crossProduct3Points(k[h-2],k[h-1],g[e])<=0;)h--;
k[h++]=g[e]}e=f-2;for(f=h+1;e>=0;e--){for(;h>=f&&this.crossProduct3Points(k[h-2],k[h-1],g[e])<=0;)h--;k[h++]=g[e]}return Polygon.fromArray(k.getSubList(new Interval(0,h-2)))};PolygonOperators.sortOnXY=function(b){return b.sort(function(b,e){return b.x<e.x?-1:b.x==e.x&&b.y<e.y?-1:1})};PolygonOperators.crossProduct3Points=function(b,d,e){return(d.x-b.x)*(e.y-b.y)-(d.y-b.y)*(e.x-b.x)};
PolygonOperators.expandFromBarycenter=function(b,d){for(var e=new Polygon,f=b.getBarycenter(),g=0;b[g]!=null;g++)e[g]=b[g].expandFromPoint(f,d);return e};
PolygonOperators.expandInAngles=function(b,d){for(var e=new Polygon,f=b[b.length-1],g=b[0],h=b[1],k,h=0.5*Math.atan2(g.y-h.y,g.x-h.x)+0.5*Math.atan2(g.y-f.y,g.x-f.x),l=b.containsPoint(new Point(g.x+Math.floor(d)*Math.cos(h),g.y+Math.floor(d)*Math.sin(h)))?-1:1,m=0;b[m]!=null;m++)f=b[(m-1+b.length)%b.length],g=b[m],h=b[(m+1)%b.length],h=Math.atan2(g.y-h.y,g.x-h.x),k=Math.atan2(g.y-f.y,g.x-f.x),f=Math.abs(k-h)<Math.PI?-1:1,h=0.5*h+0.5*k,e[m]=new Point(g.x+l*f*d*Math.cos(h),g.y+l*f*d*Math.sin(h));return e};
PolygonOperators.simplifyPolygon=function(b,d){var d=d==null||d==0?1:d,e=b.clone(),f,g,h,k,l=b.length;for(k=0;k<l;k++)f=e[k],g=e[(k+1)%l],h=e[(k+2)%l],f=GeometryOperators.lineFromTwoPoints(f,h),GeometryOperators.distancePointToLine(g,f)<d&&(e=e.getWithoutElementAtIndex((k+1)%l),k--),l=e.length;return e};
PolygonOperators.bezierPolygonContainsPoint=function(b,d,e){var f=b.getFrame();clearContext();context.fillStyle="black";context.fillRect(0,0,f.width,f.height);if(e!=null)context.strokeStyle="black",context.lineWidth=e;context.fillStyle="white";context.beginPath();Draw.drawBezierPolygon(context,b,-f.x,-f.y);context.fill();e!=null&&context.stroke();b=context.getImageData(d.x-f.x,d.y-f.y,1,1).data;clearContext();return b[0]>0};
PolygonOperators.getBezierPolygonBestCenter=function(b,d){var d=d==null?500:d,e=b.getFrame();context.fillStyle="black";context.fillRect(0,0,e.width,e.height);context.fillStyle="white";context.beginPath();Draw.drawBezierPolygon(context,b,-e.x,-e.y);context.fill();for(var f,g,h,k=0,l,m=0;m<d;m++){f=e.getRandomPoint();for(g=0;g+=0.1;)if(h=g,context.getImageData(f.x+h*Math.cos(g)-e.x,f.y+h*Math.sin(g)-e.y,1,1).data[0]==0){h>k&&(k=h,l=f);break}}return l};
PolygonOperators.convexHull=function(b,d){for(var e=this.hull(b,!0),f=NumberListGenerators.createSortedNumberList(b.length),f=f.getWithoutElementsAtIndexes(e),g,h,k,l,m=new Point,n,o=d-1,q,s,u,t=e.length;o<d;){o=999999999;for(g=0;g<t;g++){k=b[e[g]];l=b[e[(g+1)%e.length]];m.x=(k.x+l.x)*0.5;m.y=(k.y+l.y)*0.5;u=Math.sqrt(Math.pow(l.x-k.x,2)+Math.pow(l.y-k.y,2));for(h=0;f[h]!=null;h++)n=b[f[h]],n=(Math.sqrt(Math.pow(n.x-k.x,2)+Math.pow(n.y-k.y,2))+Math.sqrt(Math.pow(n.x-l.x,2)+Math.pow(n.y-l.y,2)))/Math.pow(u,
2),n<o&&(o=n,q=g,s=h)}for(g=t-1;g>q;g--)e[g+1]=e[g];e[q+1]=f[s];f.splice(s,1);if(f.length==0)break;t++}return e};PolygonOperators.controlPointsFromPointsAnglesIntensities=function(b,d,e){for(var f=new Polygon,g=0;b[g]!=null;g++)g>0&&f.push(new Point(b[g].x-e[g]*Math.cos(d[g]),b[g].y-e[g]*Math.sin(d[g]))),g<b.length-1&&f.push(new Point(b[g].x+e[g]*Math.cos(d[g]),b[g].y+e[g]*Math.sin(d[g])));return f};
PolygonOperators.placePointsInsidePolygon=function(b,d,e){var f=new Polygon,g=b.getFrame();switch(e||0){case 0:for(;f.length<d;)e=new Point(g.x+Math.random()*g.width,g.y+Math.random()*g.height),PolygonOperators.polygonContainsPoint(b,e)&&f.push(e);return f}};
PolygonOperators.placePointsInsideBezierPolygon=function(b,d,e,f){var g=new Polygon,h=b.getFrame();switch(e||0){case 0:for(var k=0;g.length<d&&k<1E3;)e=new Point(h.x+Math.random()*h.width,h.y+Math.random()*h.height),k++,PolygonOperators.bezierPolygonContainsPoint(b,e,f)&&(g.push(e),k=0);return g}};function RectangleOperators(){}
RectangleOperators.packingRectangles=function(b,d,e,f){e==null&&(e=new Rectangle(0,0,1,1));switch(d?d:0){case 0:return this.quadrification(e,b);case 1:d=b.getMinMaxInterval();d.min<0&&(b=b.add(-d.min),new Interval(0,d.max-d.min));for(var f=b.getSum(),d=new List,g=e.y,h,k=e.height/f,f=0;b[f]!=null;f++)h=k*b[f],d.push(new Rectangle(e.x,g,e.width,h)),g+=h;return d;case 2:d=b.getMinMaxInterval();d.min<0&&(b=b.add(-d.min),new Interval(0,d.max-d.min));f=b.getSum();d=new List;g=e.x;k=e.width/f;for(f=0;b[f]!=
null;f++)h=k*b[f],d.push(new Rectangle(g,e.y,h,e.height)),g+=h;return d;case 3:if(!(b.length<6)&&b.length==6){e=new Rectangle(0.44,0.36,0.16,0.45);d=new Rectangle(0.6,0.15,0.3,0.3);f=new Rectangle(0.72,0.45,0.28,0.32);g=new Rectangle(0.38,0.04,0.22,0.32);h=new Point(0.6,0.36);e=expandRectangle(e,Math.sqrt(b[0]),h);d=expandRectangle(d,Math.sqrt(b[1]),h);g=expandRectangle(g,Math.sqrt(b[3]),h);f.x=d.x+d.width*0.5;f.y=d.bottom;h=new Point(f.x+f.width*0.3,d.bottom);f=expandRectangle(f,Math.sqrt(b[2]),
h);f.y+=f.height*0.2;var l=new Point(0.26,0.36+Math.max(e.height*0.3,g.height*0.2));h=new Rectangle(0.1,l.y-0.4,0.2,0.4);k=new Rectangle(0.22,l.y,0.16,0.5);h=expandRectangle(h,Math.sqrt(b[4]),l);k=expandRectangle(k,Math.sqrt(b[5]),l);b=Math.min(g.x,e.x)-Math.max(h.right,k.right)-Math.max(g.width,e.width,k.right-l.x,h.right-l.x)*0.2;k.x+=b;h.x+=b;return new List(e,d,f,g,h,k)}case 4:return europeQuadrigram(b);case 5:f=f||0;g=f==0?Math.round(Math.sqrt(b.length)):Math.round(b.length/f);d=Math.ceil(b.length/
g);f=g*d-b.length;h=b.getAverage();b=ListOperators.concat(b,ListGenerators.createListWithSameElement(f,h));b=ListOperators.slidingWindowOnList(b,d,d,0);e=this.packingRectangles(b.getSums(),2,e);d=List();for(f=0;f<g;f++)d=ListOperators.concat(d,this.packingRectangles(b[f],1,e[f]));return d}return null};
RectangleOperators.quadrification=function(b,d,e,f){if(d.length==0)return new RectangleList;if(d.length==1)return new RectangleList(b);var f=f?f:!1,g=e&&e?d:d.getNormalizedToSum();if(!f)var h=g.getSortIndexes(),g=ListOperators.sortListByNumberList(g,g);var k=b.width*b.height,e=new RectangleList,l=b.clone(),m,n=new List,o,q,s=0,u=new Rectangle,d=d.length;if(d>2)for(var t,b=s;b<d;b++)if(q=Number.MAX_VALUE,g[b]==0)e.push(new Rectangle(u.x,u.y,0,0));else{for(t=1;t<d;t++)if(m=NumberList.fromArray(g.slice(b,
b+t)),o=n.clone(),n=m.getSum()*k,u.x=l.x,u.y=l.y,l.width>l.height?(u.width=n/l.height,u.height=l.height,column=!0):(u.width=l.width,u.height=n/l.width,column=!1),m=m.getNormalizedToSum(),n=this.partitionRectangle(u,m),m=this.getHighestRatio(n),q<=m)break;else q=m;if(o.length==0){e.push(l.clone());if(e.length==d){if(!f){f=new List;for(b=0;e[b]!=null;b++)f[h[b]]=e[b];return f}return e}s++}else{e=List.fromArray(e.concat(o));if(e.length==d){if(!f){f=new List;for(b=0;e[b]!=null;b++)f[h[b]]=e[b];return f}return e}s+=
o.length;b=o[o.length-1];l.width>l.height?(l.x=b.width+b.x,l.width-=b.width):(l.y=b.height+b.y,l.height-=b.height)}b=s-1}else d==2?(m=g.clone(),u=b.clone(),e=this.partitionRectangle(u,m)):e[0]=b.clone();if(!f){f=new List;for(b=0;e[b]!=null;b++)f[h[b]]=e[b];return f}return e};
RectangleOperators.partitionRectangle=function(b,d){var e=b.width*b.height,f=new List,g=b.clone(),h,k;for(k=0;k<d.length;k++)h=d[k]*e,b.width>b.height?(f.push(new Rectangle(g.x,g.y,h/g.height,g.height)),g.x+=h/g.height):(f.push(new Rectangle(g.x,g.y,g.width,h/g.width)),g.y+=h/g.width);return f};RectangleOperators.getHighestRatio=function(b){var d=1,e,f;for(f=0;f<b.length;f++)e=b[f],d=Math.max(d,e.getRatio());return d};function ColorOperators(){}
ColorOperators.point3DToColor=function(b){return ColorUtils.RGBtouint(b.x,b.y,b.z)};ColorOperators.colorToPoint3D=function(b){return Point3D.fromArray(ColorUtils.uinttoRGB(b))};function ColorGenerators(){}ColorGenerators.randomColor=function(b){return"rgba("+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+","+(b==null?1:b)+")"};function ColorListGenerators(){}
ColorListGenerators.createColorListFromNumberList=function(b,d,e){var e=e==null?0:e,f=new ColorList,g;switch(e){case 0:g=b.getNormalizedToMax()}for(b=0;g[b]!=null;b++)f.push(d(g[b]));return f};ColorListGenerators.createColorListWithSingleColor=function(b,d){for(var e=new ColorList,f=0;f<b;f++)e.push(d);return e};
ColorListGenerators.createCategoricalColors=function(b,d,e){var e=e==null?ColorScales.temperature:e,f,g=new ColorList;switch(b){case 0:for(f=0;f<d;f++)g[f]=e(f/(d-1));break;case 1:b=NumberListGenerators.createRandomNumberList(d,null,0);for(f=0;f<d;f++)g[f]=e(b[f]);break;case 5:b=NumberListGenerators.createRandomNumberList(1001,null,0);f=NumberListGenerators.createSortedNumberList(d);var h=NumberListGenerators.createRandomNumberList(d,null,0),h=ListOperators.sortListByNumberList(f,h),k=Math.floor(d*
2)+100,l=Math.floor(d*0.6)+5,m=ColorListGenerators._evaluationFunction(h),n,o=h,q,s=0,u;for(f=0;f<k;f++){for(q=0;q<l;q++)n=ColorListGenerators._sortingVariation(h,b[s],b[s+1]),s=(s+2)%1001,u=ColorListGenerators._evaluationFunction(n),u>m&&(o=n,m=u);h=o}for(f=0;f<d;f++)g.push(e(1/d+h[f]/(d+1)))}return g};ColorListGenerators._sortingVariation=function(b,d,e){var b=b.clone(),d=Math.floor(d*b.length),e=Math.floor(e*b.length),f=b[e];b[e]=b[d];b[d]=f;return b};
ColorListGenerators._evaluationFunction=function(b){var d=0,e;for(e=0;b[e+1]!=null;e++)d+=Math.sqrt(Math.abs(b[e+1]-b[e]));return d};function ColorListOperators(){}ColorListOperators.colorListFromColorScale=function(b,d){return b.getColorList.apply(b,[d])};ColorListOperators.colorListFromColorScaleFunction=function(b,d){var e=new ColorList,f;for(f=0;f<d;f++)e[f]=b(f/(d-1));return e};
ColorListOperators.colorListFromColorScaleFunctionAndNumberList=function(b,d,e){(e==null||e)&&(d=d.getNormalized());var e=new ColorList,f;for(f=0;d[f]!=null;f++)e[f]=b(d[f]);return e};ColorListOperators.polygon3DToColorList=function(b){var d=b.length,e=new ColorList,f;for(f=0;f<d;f++)e.push(ColorOperators.point3DToColor(b[f]));return e};ColorListOperators.colorListToPolygon3D=function(b){var d=b.length,e=new Polygon3D,f;for(f=0;f<d;f++)e.push(ColorOperators.colorToPoint3D(b[f]));return e};
function ColorOperators(){}ColorOperators.RGBtoHEX=function(b,d,e){return"#"+ColorOperators.toHex(b)+ColorOperators.toHex(d)+ColorOperators.toHex(e)};ColorOperators.HEXtoRGB=function(b){return[parseInt(b.substr(1,2),16),parseInt(b.substr(3,2),16),parseInt(b.substr(5,2),16)]};ColorOperators.numberToHex=function(b){for(b=b.toString(16);b.length<2;)b="0"+b;return b};ColorOperators.uinttoRGB=function(b){return[b>>16,(b>>8)-(b>>16<<8),b-(b>>8<<8)]};
ColorOperators.uinttoHEX=function(b){b=ColorOperators.uinttoRGB(b);return ColorOperators.RGBToHEX(b[0],b[1],b[2])};ColorOperators.RGBtouint=function(b,d,e){return Number(b)<<16|Number(d)<<8|Number(e)};ColorOperators.HEXtouint=function(b){b=ColorOperators.HEXtoRGB(b);return ColorOperators.RGBtouint(b[0],b[1],b[2])};ColorOperators.grayByLevel=function(b){b=Math.floor(b*255);return"rgb("+b+","+b+","+b+")"};
ColorOperators.HEXtoHSV=function(b){ColorOperators.HEXtoRGB(b);return ColorOperators.RGBtoHSV(rgb[0],rgb[1],rgb[2])};ColorOperators.HSVtoHEX=function(b,d,e){b=ColorOperators.HSVtoRGB(b,d,e);return ColorOperators.RGBtoHEX(b[0],b[1],b[2])};ColorOperators.HSLtoHEX=function(b,d,e){b=ColorOperators.HSLtoRGB(b,d,e);return ColorOperators.RGBtoHEX(b[0],b[1],b[2])};
ColorOperators.RGBtoHSV=function(b,d,e){var f;f=Math.max(Math.max(b,d),e);var g=f-Math.min(Math.min(b,d),e);if(g==0)return[0,0,b];if(f==0)return[-1,0,f];b=b==f?(d-e)/g:d==f?2+(e-b)/g:4+(b-d)/g;b*=60;b<0&&(b+=360);return[b,g/f,f]};
ColorOperators.HSVtoRGB=function(b,d,e){var b=b?b:0,d=d?d:0,e=e?e:0,f,g,h;if(d==0)return f=d=e,[Math.floor(f*255),Math.floor(d*255),Math.floor(e*255)];b/=60;f=Math.floor(b);g=b-f;b=e*(1-d);h=e*(1-d*g);g=e*(1-d*(1-g));switch(f){case 0:f=e;d=g;e=b;break;case 1:f=h;d=e;e=b;break;case 2:f=b;d=e;e=g;break;case 3:f=b;d=h;break;case 4:f=g;d=b;break;default:f=e,d=b,e=h}return[Math.floor(f*255),Math.floor(d*255),Math.floor(e*255)]};
ColorOperators.HSLtoRGB=function(b,d,e){if(d==0)e=d=b=e;else var f=function(b,d,e){e<0&&(e+=1);e>1&&(e-=1);return e<1/6?b+(d-b)*6*e:e<0.5?d:e<2/3?b+(d-b)*(2/3-e)*6:b},g=e<0.5?e*(1+d):e+d-e*d,h=2*e-g,e=f(h,g,b/360+1/3),d=f(h,g,b/360),b=f(h,g,b/360-1/3);return[Math.floor(e*255),Math.floor(d*255),Math.floor(b*255)]};
ColorOperators.interpolateColors=function(b,d,e){b=ColorOperators.interpolateColorsRGB(ColorOperators.colorStringToRGB(b),ColorOperators.colorStringToRGB(d),e);return ColorOperators.RGBtoHEX(b[0],b[1],b[2])};ColorOperators.interpolateColorsRGB=function(b,d,e){var f=1-e;return[Math.floor(f*b[0]+e*d[0]),Math.floor(f*b[1]+e*d[1]),Math.floor(f*b[2]+e*d[2])]};ColorOperators.invertColorRGB=function(b,d,e){return[255-b,255-d,255-e]};
ColorOperators.addAlpha=function(b,d){var e=ColorOperators.colorStringToRGB(b);return"rgba("+e[0]+","+e[1]+","+e[2]+","+d+")"};ColorOperators.invertColor=function(b){b=ColorOperators.HEXtoRGB(b);b=ColorOperators.invertColorRGB(b[0],b[1],b[2]);return ColorOperators.RGBtoHEX(b[0],b[1],b[2])};ColorOperators.toHex=function(b){for(b=b.toString(16);b.length<2;)b="0"+b;return b};
ColorOperators.getRandomColor=function(){return"rgb("+String(Math.floor(Math.random()*256))+","+String(Math.floor(Math.random()*256))+","+String(Math.floor(Math.random()*256))+")"};ColorOperators.colorStringToHEX=function(b){b=ColorOperators.colorStringToRGB(b);return ColorOperators.RGBtoHEX(b[0],b[1],b[2])};
ColorOperators.colorStringToRGB=function(b){b.charAt(0)=="#"&&(b=b.substr(1,6));var b=b.replace(/ /g,""),b=b.toLowerCase(),d={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",
darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",
gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",
lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",
oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",
slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};d[b]!=null&&(b=d[b]);for(var d=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,process:function(b){return[parseInt(b[1]),parseInt(b[2]),parseInt(b[3])]}},{re:/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),[\.0123456789]+\)$/,
process:function(b){return[parseInt(b[1]),parseInt(b[2]),parseInt(b[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,process:function(b){return[parseInt(b[1],16),parseInt(b[2],16),parseInt(b[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,process:function(b){return[parseInt(b[1]+b[1],16),parseInt(b[2]+b[2],16),parseInt(b[3]+b[3],16)]}}],e=0;e<d.length;e++){var f=d[e].process,g=d[e].re.exec(b);if(g)return f(g)}return null};function ColorScales(){}ColorScales.blackScale=function(){return"black"};
ColorScales.grayscale=function(b){b=ColorOperators.interpolateColorsRGB([0,0,0],[255,255,255],b);return ColorOperators.RGBtoHEX(b[0],b[1],b[2])};ColorScales.antiGrayscale=function(b){b=ColorOperators.interpolateColorsRGB([255,255,255],[0,0,0],b);return ColorOperators.RGBtoHEX(b[0],b[1],b[2])};ColorScales.antiTemperature=function(b){return ColorScales.temperature(1-b)};
ColorScales.temperature=function(b){return b<0.2?ColorOperators.interpolateColors("#000000",ColorOperators.HSVtoHEX(234,1,1),b*5):b>0.85?ColorOperators.interpolateColors(ColorOperators.HSVtoHEX(0,1,1),"#FFFFFF",(b-0.85)/0.15):ColorOperators.HSVtoHEX(Math.round((0.65-(b-0.2))*360),1,1)};ColorScales.sqrtTemperature=function(b){return ColorScales.temperature(Math.sqrt(b))};ColorScales.sqrt4Temperature=function(b){return ColorScales.temperature(Math.pow(b,0.25))};
ColorScales.quadraticTemperature=function(b){return ColorScales.temperature(Math.pow(b,2))};ColorScales.cubicTemperature=function(b){return ColorScales.temperature(Math.pow(b,3))};ColorScales.greenToRed=function(b){b=ColorOperators.interpolateColorsRGB([50,255,50],[255,50,50],b);return ColorOperators.RGBtoHEX(b[0],b[1],b[2])};ColorScales.grayToOrange=function(b){b=ColorOperators.interpolateColorsRGB([100,100,100],[255,110,0],b);return ColorOperators.RGBtoHEX(b[0],b[1],b[2])};
ColorScales.blueToRed=function(b){b=ColorOperators.interpolateColorsRGB([0,0,255],[255,0,0],b);return ColorOperators.RGBtoHEX(b[0],b[1],b[2])};ColorScales.whiteToRed=function(b){b=Math.floor(255-b*255);return"rgb(255,"+b+","+b+")"};ColorScales.redToBlue=function(b){b=ColorOperators.interpolateColorsRGB([255,0,0],[0,0,255],b);return ColorOperators.RGBtoHEX(b[0],b[1],b[2])};
ColorScales.greenWhiteRed=function(b){b=b<0.5?ColorOperators.interpolateColorsRGB([50,255,50],[255,255,255],b*2):ColorOperators.interpolateColorsRGB([255,255,255],[255,50,50],(b-0.5)*2);return ColorOperators.RGBtoHEX(b[0],b[1],b[2])};ColorScales.solar=function(b){b=ColorOperators.interpolateColorsRGB([0,0,0],ColorOperators.interpolateColorsRGB([255,0,0],[255,255,0],b),Math.pow(b*0.99+0.01,0.2));return ColorOperators.RGBtoHEX(b[0],b[1],b[2])};ColorScales.antiSolar=function(b){return ColorOperators.invertColor(ColorScales.solar(b))};
function ListGenerators(){}ListGenerators.createListWithSameElement=function(b,d){switch(typeOf(d)){case "number":var e=new NumberList;break;case "List":e=new Table;break;case "NumberList":e=new NumberTable;break;case "Rectangle":e=new RectamgleList;break;case "string":e=new StringList;break;case "boolean":e=new List;break;default:e=new List}for(var f=0;f<b;f++)e[f]=d;return e};
ListGenerators.createIterationSequence=function(b,d,e){for(var d=ListGenerators.createListWithSameElement(1,d),f=1;f<b;f++)d[f]=e(d[f-1]);return d};function ListOperators(){}ListOperators.getElement=function(b,d){if(b==null)return null;d=d==null?0:d%b.length;return b[d]};ListOperators.getSubList=function(b,d){c.log("params",d);c.log("params.isList",d.isList);return b==null||d==null?null:b.getSubList.apply(b,d.isList?[d]:d)};
ListOperators.concat=function(){if(arguments.length==1)return arguments[0];var b,d=arguments[0].concat(arguments[1]);for(b=2;arguments[b];b++)d=d.concat(arguments[b]);return d.getImproved()};ListOperators.assemble=function(){return List.fromArray(arguments).getImproved()};
ListOperators.countElementsRepetitionOnList=function(b,d,e,f){if(b!=null){var d=d||!0,e=e||!1,f=f==null?0:f,g=instantiate(typeOf(b)),h=new NumberList,k,l;if(e){if(b.length==0)return null;k=b[0];g.push(k);h.push(1);for(l=1;l<nElements;l++)e=b[l],e==k?h[h.length-1]+=1:(g.push(e),h.push(1),k=e)}else for(l=0;b[l]!=null;l++)e=b[l],k=g.indexOf(e),k!=-1?h[k]++:(g.push(e),h.push(1));b=g.type=="NumberList"?new NumberTable:new Table;b[0]=g;b[1]=h;d&&(b=TableOperators.sortListsByNumberList(b,h));f!=0&&f<g.length&&
(b[0]=b[0].splice(0,f),b[1]=b[1].splice(0,f));return b}};ListOperators.reverse=function(b){return b.getReversed()};ListOperators.sortListByNumberList=function(b,d,e){e==null&&(e=!0);if(d.length==0)return b;var f=[],g=instantiate(typeOf(b));for(i=0;b[i]!=null;i++)f.push([b[i],d[i]]);e?f.sort(function(b,d){return b[1]<d[1]?1:-1}):f.sort(function(b,d){return b[1]<d[1]?-1:1});for(i=0;f[i]!=null;i++)g.push(f[i][0]);g.name=b.name;return g};
ListOperators.sortListByIndexes=function(b,d){var e=instantiate(typeOf(b));e.name=b.name;var f=b.length,g;for(g=0;g<f;g++)e.push(b[d[g]]);return e};ListOperators.concatWithoutRepetitions=function(){var b,d=arguments[0].clone();for(b=1;b<arguments.length;b++){var e=arguments[b],f=e.length;for(b=0;b<f;b++)d.indexOf(e[b])==-1&&d.push(e[b])}return d.getImproved()};
ListOperators.slidingWindowOnList=function(b,d,e,f){var f=f||0,g=new Table,h=b.length,k,l,e=Math.max(1,e);switch(f){case 0:for(k=0;k<h;k+=e)if(k+d<=h){f=new List;for(l=0;l<d;l++)f.push(b[k+l]);g.push(f.getImproved())}break;case 1:for(k=0;k<h;k+=e){f=new List;for(l=0;l<Math.min(d,h-k);l++)f.push(b[k+l]);g.push(f.getImproved())}break;case 2:for(k=0;k<h;k+=e){f=new List;for(l=0;l<d;l++)f.push(b[(k+l)%h]);g.push(f.getImproved())}}return g.getImproved()};
ListOperators.getNewListForObjectType=function(b){var d=new List;d[0]=b;return instantiateWithSameType(d.getImproved())};ListOperators.listsIntersect=function(b,d){for(var e=b.length<d.length?b:d,f=b==e?d:b,g=0;e[g]!=null;g++)if(f.indexOf(e[g])!=-1)return!0;return!1};
ListOperators.getCommonElements=function(b,d){for(var e=b.type=="NumberList"&&d.type=="NumberList",f=b.type=="StringList"&&d.type=="StringList",g=e?new NumberList:f?new StringList:new List,h=b.length<d.length?b:d,k=b==h?d:b,l=0;h[l]!=null;l++)k.indexOf(h[l])!=-1&&g.push(h[l]);return e||f?g:g.getImproved()};function TableEncodings(){}TableEncodings.ENTER=String.fromCharCode(13);TableEncodings.ENTER2=String.fromCharCode(10);TableEncodings.ENTER3=String.fromCharCode(8232);TableEncodings.SPACE=String.fromCharCode(32);
TableEncodings.SPACE2=String.fromCharCode(160);TableEncodings.TAB="\t";TableEncodings.TAB2=String.fromCharCode(9);
TableEncodings.CSVtoTable=function(b,d,e,f){var q;f=f==null?"":f;d=d==null?!1:d;if(b==null)return null;if(b=="")return new Table;for(var b=b.replace(/\$/g,""),g=b.split('"'),b=1;g[b]!=null;b+=2)g[b]=g[b].replace(/\n/g,"*ENTER*");b=g.join('"');g=TableEncodings.ENTER2;g=b.split(g);if(g.length==1&&(g=TableEncodings.ENTER,g=b.split(g),g.length==1))g=TableEncodings.ENTER3,g=b.split(g);var h=new Table,e=e!=void 0?e:",";if(b==null||b==""||b==" "||g.length==0)return null;b=0;if(d)var b=1,k=g[0].split(e);
for(var l,m;b<g.length;b++)if(!(g[b].length<2)){var n=NetworkEncodings.replaceChomasInLine(g[b]).split(e);for(j=0;j<n.length;j++){h[j]=h[j]==null?new List:h[j];if(d&&b==1)h[j].name=k[j]==null?"":TableEncodings._removeQuotes(k[j]);var o=d?b-1:b;l=n[j].replace(/\*CHOMA\*/g,",").replace(/\*ENTER\*/g,"\n");l=l==""?f:l;q=(m=Number(l.replace(",",".")))||m==0&&l!=""?m:l,l=q;typeof l=="string"&&(l=TableEncodings._removeQuotes(l));h[j][o]=l}}for(b=0;h[b]!=null;b++)h[b]=h[b].getImproved();return h=h.getImproved()};
TableEncodings._removeQuotes=function(b){if(b.length==0)return b;if((b.charAt(0)=='"'||b.charAt(0)=="'")&&(b.charAt(b.length-1)=='"'||b.charAt(b.length-1)=="'"))b=b.substr(1,b.length-2);return b};
TableEncodings.TableToCSV=function(b,d,e){var d=d||",",f,g,h,k,l=ListGenerators.createListWithSameElement(b[0].length,""),m;for(f=0;b[f]!=null;f++){h=b[f];k=h.type;m=f!=b.length-1;for(g=0;h[g]!=null;g++){switch(k){case "NumberList":l[g]+=h[g];break;default:l[g]+='"'+h[g]+'"'}m&&(l[g]+=d)}}g="";if(e){for(f=0;b[f]!=null;f++)h=b[f],g+='"'+h.name+'"',f!=b.length-1&&(g+=d);g+="\n"}return g+l.getConcatenated("\n")};function TableGenerators(){}
TableGenerators.createTableWithSameElement=function(b,d,e){for(var f=new Table,g=0;g<b;g++)f[g]=ListGenerators.createListWithSameElement(d,e);return f.getImproved()};function TableOperators(){}TableOperators.getElementFromTable=function(b,d,e){return b[d]==null?null:b[d][e]};
TableOperators.getSubTable=function(b,d,e,f,g){var h=b.length;if(h==0)return null;var k=new Table;f<=0&&(f=h-d+f);d=Math.min(d,h-1);f=Math.min(f,h-d);h=b[0].length;if(h==0)return null;g<=0&&(g=h-e+g);var e=Math.min(e,h-1),g=Math.min(g,h-e),l,m,n,o;for(m=d;m<d+f;m++){h=b[m];l=new List;l.name=b[m].name;for(n=e;n<e+g;n++)o=h[n],l.push(o);k.push(l.getImproved())}return k.getImproved()};TableOperators.transpose=function(b){return b.getTransposed()};
TableOperators.getSubListsByIndexes=function(b,d){var e=new Table;e.name=b.name;var f,g,h;for(f=0;b[f]!=null;f++){g=b[f];h=instantiateWithSameType(g);for(j=0;d[j]!=null;j++)h[j]=g[d[j]];e[f]=h.getImproved()}return e};TableOperators.sortListsByNumberList=function(b,d,e){var e=e||!0,f=instantiate(typeOf(b));f.name=b.name;var g=b.length,h;for(h=0;h<g;h++)f[h]=ListOperators.sortListByNumberList(b[h],d,e);return f};
TableOperators.aggregateTable=function(b,d,e){var d=d==null?0:d,e=e==null?0:e,f=new Table;f.name=b.name;var g,h;for(g=0;b[g]!=null;g++)f[g]=new List;switch(e){case 0:for(e=0;b[0][e]!=null;e++)if(g=f[d].indexOf(b[d][e])==-1)for(g=0;b[g]!=null;g++)f[g].push(b[g][e]);break;case 1:for(e=0;b[0][e]!=null;e++)if(h=f[d].indexOf(b[d][e]),g=h==-1)for(g=0;b[g]!=null;g++)f[g].push(b[g][e]);else for(g=0;b[g]!=null;g++)g!=d&&b[g].type=="NumberList"&&(f[g][h]+=b[g][e])}for(g=0;f[g]!=null;g++)f[g]=f[g].getImproved();
return f.getImproved()};TableOperators.mergeDataTablesInList=function(b){if(b.length<2)return b;for(var d=b[0],e=1;b[e]!=null;e++)d=TableOperators.mergeDataTables(d,b[e]);return d};
TableOperators.mergeDataTables=function(b,d){if(d[0].length==0){var e=b.clone();e.push(ListGenerators.createListWithSameElement(b[0].length,0));return e}var e=new Table,f=ListOperators.concatWithoutRepetitions(b[0],d[0]),g=f.length,h=b.length-1,k=d.length-1,l=new NumberTable,m=new NumberTable,n,o,q;for(o=0;o<g;o++){n=b[0].indexOf(f[o]);if(n>-1)for(q=0;q<h;q++){if(o==0)l[q]=new NumberList,l[q].name=b[q+1].name;l[q][o]=b[q+1][n]}else for(q=0;q<h;q++){if(o==0)l[q]=new NumberList,l[q].name=b[q+1].name;
l[q][o]=0}n=d[0].indexOf(f[o]);if(n>-1)for(q=0;q<k;q++){if(o==0)m[q]=new NumberList,m[q].name=d[q+1].name;m[q][o]=d[q+1][n]}else for(q=0;q<k;q++){if(o==0)m[q]=new NumberList,m[q].name=d[q+1].name;m[q][o]=0}}e[0]=f;for(o=0;l[o]!=null;o++)e.push(l[o]);for(o=0;m[o]!=null;o++)e.push(m[o]);return e};TableOperators.fusionDataTables=function(b,d){for(var e=b.clone(),f,g,h=0;d[0][h]!=null;h++)g=d[0][h],f=e[0].indexOf(g),f==-1?(e[0].push(g),e[1].push(d[1][h])):e[1][f]+=d[1][h];return e};
TableOperators.completeTable=function(b,d,e){var e=e==null?0:e,f=new Table;f.name=b.name;for(var g,h,k,l=0;l<b.length;l++){g=b[l];h=g==null?ListOperators.getNewListForObjectType(e):instantiateWithSameType(g);h.name=g==null?"":g.name;for(k=0;k<d;k++)h[k]=g==null||g[k]==null?e:g[k];f[l]=h}return f};TableOperators.getNumberTableFromTable=function(b){var d,e=new NumberTable;e.name=b.name;for(d=0;b[d]!=null;d++)b[d].type=="NumberList"&&e.push(b[d]);return e};function IntervalListOperators(){}
IntervalListOperators.scaleIntervals=function(b,d){var e=new List;e.name=b.name;for(var f=0;b[f]!=null;f++)e[f]=b[f].getScaled(d);return e};function IntervalTableOperators(){}IntervalTableOperators.scaleIntervals=function(b,d){var e=new Table;e.name=b.name;for(var f=0;b[f]!=null;f++)e[f]=IntervalListOperators.scaleIntervals(b[f],d);return e};function MatrixGenerators(){}
MatrixGenerators.createMatrixFromTrianglesMapping=function(b,d,e,f,g,h){if(d.y!=b.y)var k=(e.y-b.y)/(d.y-b.y),l=(h.x-f.x-(g.x-f.x)*k)/(e.x-b.x-(d.x-b.x)*k),m=k*(g.x-f.x)/(e.y-b.y)-l*(d.x-b.x)/(d.y-b.y),n=(h.y-f.y-(g.y-f.y)*k)/(e.x-b.x-(d.x-b.x)*k),d=k*(g.y-f.y)/(e.y-b.y)-n*(d.x-b.x)/(d.y-b.y);else l=(g.x-f.x)/(d.x-b.x),m=(h.x-f.x)/(e.y-b.y)-l*(e.x-b.x)/(e.y-b.y),n=(g.y-f.y)/(d.x-b.x),d=(h.y-f.y)/(e.y-b.y)-n*(e.x-b.x)/(e.y-b.y);return new Matrix(l,n,m,d,f.x-l*b.x-m*b.y,f.y-n*b.x-d*b.y)};
MatrixGenerators.applyTransformationOnCanvasFromPoints=function(b,d,e,f,g,h,k){if(e.y!=d.y)var l=(f.y-d.y)/(e.y-d.y),m=(k.x-g.x-(h.x-g.x)*l)/(f.x-d.x-(e.x-d.x)*l),n=l*(h.x-g.x)/(f.y-d.y)-m*(e.x-d.x)/(e.y-d.y),o=(k.y-g.y-(h.y-g.y)*l)/(f.x-d.x-(e.x-d.x)*l),e=l*(h.y-g.y)/(f.y-d.y)-o*(e.x-d.x)/(e.y-d.y);else m=(h.x-g.x)/(e.x-d.x),n=(k.x-g.x)/(f.y-d.y)-m*(f.x-d.x)/(f.y-d.y),o=(h.y-g.y)/(e.x-d.x),e=(k.y-g.y)/(f.y-d.y)-o*(f.x-d.x)/(f.y-d.y);b.transform(m,o,n,e,g.x-m*d.x-n*d.y,g.y-o*d.x-e*d.y)};
MatrixGenerators.createRotationMatrix=function(b,d){var e=Matrix(Math.cos(b),Math.sin(b),-Math.sin(b),Math.cos(b));d&&(e=Matrix.translation(d.x,d.y).concat(e).concat(Matrix.translation(-d.x,-d.y)));return e};MatrixGenerators.createScaleMatrix=function(b,d,e){b=Matrix(b,0,0,d||b);e&&(b=Matrix.translation(e.x,e.y).concat(b).concat(Matrix.translation(-e.x,-e.y)));return b};MatrixGenerators.createTranslationMatrix=function(b,d){return Matrix(1,0,0,1,b,d)};function NumberListGenerators(){}
NumberListGenerators.createSortedNumberList=function(b,d,e){d=d||0;e=e||1;e==0&&(e=1);var f,g=new NumberList;for(f=0;f<b;f++)g.push(d+f*e);return g};NumberList.createNumberListFromInterval=function(b,d){d==null&&(d=new Interval(0,1));var e=new NumberList,f=d.getAmplitude(),g;for(g=0;g<b;g++)e.push(Number(d.getMin())+Number(Math.random()*f));return e};
NumberListGenerators.createRandomNumberList=function(b,d,e,f){for(var e=e==null?-1:e,d=d==null?new Interval(0,1):d,g=new NumberList,h=d.getAmplitude(),e=e==-1?Math.random:new NumberOperators._Alea("my",e,"seeds"),k=0;k<b;k++)g[k]=f==null?e()*h+d.x:f(e()*h+d.x);return g};function NumberListOperators(){}NumberListOperators.cosineSimilarity=function(b,d){var e=b.getNorm()*d.getNorm();return e==0?0:b.dotProduct(d)/e};
NumberListOperators.covariance=function(b,d){var e=Math.min(b.length,d.length),f,g=b.getAverage(),h=d.getAverage(),k=0;for(f=0;f<e;f++)k+=(b[f]-g)*(d[f]-h);return k/e};NumberListOperators.standardDeviationBetweenTwoNumberLists=function(b,d){for(var e=0,f=Math.min(b.length,d.length),g=0;g<f;g++)e+=Math.pow(b[g]-d[g],2);return e/f};NumberListOperators.pearsonProductMomentCorrelation=function(b,d){return NumberListOperators.covariance(b,d)/(b.getStandardDeviation()*d.getStandardDeviation())};
NumberListOperators.filterNumberListByNumber=function(b,d,e,f){var f=f||!1,g=new NumberList;if(f)switch(e){case "<":for(e=0;b[e]!=null;e++)b[e]<d&&g.push(e);break;case "<=":for(e=0;b[e]!=null;e++)b[e]<=d&&g.push(e);break;case ">":for(e=0;b[e]!=null;e++)b[e]>d&&g.push(e);break;case ">=":for(e=0;b[e]!=null;e++)b[e]>=d&&g.push(e);break;case "==":for(e=0;b[e]!=null;e++)b[e]==d&&g.push(e);break;case "!=":for(e=0;b[e]!=null;e++)b[e]!=d&&g.push(e)}else switch(e){case "<":for(e=0;b[e]!=null;e++)b[e]<d&&g.push(b[e]);
break;case "<=":for(e=0;b[e]!=null;e++)b[e]<=d&&g.push(b[e]);break;case ">":for(e=0;b[e]!=null;e++)b[e]>d&&g.push(b[e]);break;case ">=":for(e=0;b[e]!=null;e++)b[e]>=d&&g.push(b[e]);break;case "==":for(e=0;b[e]!=null;e++)b[e]==d&&g.push(b[e]);break;case "!=":for(e=0;b[e]!=null;e++)b[e]!=d&&g.push(b[e])}return g};function NumberOperators(){}
NumberOperators.numberToString=function(b,d){for(var e=b.toFixed(d);e.charAt(e.length-1)=="0";)e=e.substring(0,e.length-1);e.charAt(e.length-1)=="."&&(e=e.substring(0,e.length-1));return e};NumberOperators.getRandomWithSeed=function(b){return(b*9301+49297)%233280/233280};NumberOperators.numberFromBinaryPositions=function(b){var d,e=0;for(d=0;b[d]!=null;d++)e+=Math.pow(2,b[d]);return e};NumberOperators.numberFromBinaryValues=function(b){for(var d=0,e=0;b[e]!=null;e++)d+=b[e]==1?Math.pow(2,e):0;return d};
NumberOperators.powersOfTwoDecomposition=function(b,d){for(var e=new NumberList,f;0<b;)f=Math.floor(Math.log(b)/Math.LN2),e[f]=1,b-=Math.pow(2,f);d=Math.max(e.length,d==null?0:d);for(f=0;f<d;f++)e[f]=e[f]==1?1:0;return e};NumberOperators.positionsFromBinaryValues=function(b){var d,e=new NumberList;for(d=0;b[d]!=null;d++)b[d]==1&&e.push(d);return e};
NumberOperators._Alea=function(){return function(b){var d=0,e=0,f=0,g=1;b.length==0&&(b=[+new Date]);for(var h=NumberOperators._Mash(),d=h(" "),e=h(" "),f=h(" "),k=0;k<b.length;k++)d-=h(b[k]),d<0&&(d+=1),e-=h(b[k]),e<0&&(e+=1),f-=h(b[k]),f<0&&(f+=1);var h=null,l=function(){var b=2091639*d+g*2.3283064365386963E-10;d=e;e=f;return f=b-(g=b|0)};l.uint32=function(){return l()*4294967296};l.fract53=function(){return l()+(l()*2097152|0)*1.1102230246251565E-16};l.version="Alea 0.9";l.args=b;return l}(Array.prototype.slice.call(arguments))};
NumberOperators._Mash=function(){var b=4022871197,d=function(d){for(var d=d.toString(),f=0;f<d.length;f++){b+=d.charCodeAt(f);var g=0.02519603282416938*b;b=g>>>0;g-=b;g*=b;b=g>>>0;g-=b;b+=g*4294967296}return(b>>>0)*2.3283064365386963E-10};d.version="Mash 0.9";return d};NumberTableConversions=function(){};NumberTableConversions.numberTableToPolygon=function(b){if(b.length<2)return null;var d,e=Math.min(b[0].length,b[1].length),f=new Polygon;for(d=0;d<e;d++)f[d]=new Point(b[0][d],b[1][d]);return f};
function NumberTableFlowOperators(){}
NumberTableFlowOperators.getFlowTable=function(b,d,e){var d=d||!1,f=b.length,g=b[0].length,h,k=new NumberList,l=new NumberList,m=new NumberList,n,o,q,s=9999999,u=-9999999,t,v;for(t=0;t<g;t++){n=9999999;o=-9999999;for(v=q=0;v<f;v++){h=b[v];if(h.length!=g)return;o=Math.max(o,h[t]);n=Math.min(n,h[t]);q+=h[t]}k.push(n);l.push(o);m.push(q);s=Math.min(s,n);u=Math.max(u,q)}c.log("NumberTableFlowOperators.getFlowTable, MIN",s);t=u-s;var k=new NumberTable,w,l=e?1:0;d?s=Math.max(s,0):w=t;for(t=0;t<f;t++)h=
new NumberList,k.push(h);e&&k.push(new NumberList);for(t=0;t<g;t++){h=b[0];d&&(w=m[t]-s);e&&(k[0][t]=0);w==0&&(w=1.0E-5);k[l][t]=(h[t]-s)/w;for(v=1;v<f;v++)h=b[v],k[v+l][t]=(h[t]-s)/w+k[v-1+l][t]}return k};
NumberTableFlowOperators.getFlowTableIntervals=function(b,d,e,f){var g=NumberTableFlowOperators.getFlowTable(b,d,!0),b=new Table,h=g.length,k=g[0].length,l,m=new NumberList;for(i=1;i<h;i++){numberList=g[i];l=new List;b[i-1]=l;for(j=0;j<k;j++)l.push(new Interval(g[i-1][j],g[i][j])),i==h-1&&(m[j]=g[i][j])}if(e)for(j=0;j<k;j++){e=new NumberList;for(i=0;i<h-1;i++)e.push(b[i][j].getAmplitude());l=e.getSortIndexes();g=d||f?0:(1-m[j])*0.5;for(i=0;i<h-1;i++)e=b[l[i]][j],e.y=g+e.getAmplitude(),e.x=g,g=e.y}else if(!d)for(j=
0;j<k;j++)for(i=0;i<h-1;i++)e=b[i][j],f?(b[i][j].x=1-b[i][j].x,b[i][j].y=1-b[i][j].y):b[i][j]=e.add((1-m[j])*0.5);return b};function NumberTableOperators(){}NumberTableOperators.normalizeLists=function(b){return b.getNumberListsNormalized()};NumberTableOperators.normalizeListsToMax=function(b){var d=new NumberTable;d.name=b.name;var e;for(e=0;b[e]!=null;e++)d[e]=b[e].getNormalizedToMax();return d};
NumberTableOperators.numberTableToNetwork=function(b,d,e){var e=e==null?0:e,f=new Network,g,h,k,l,m;switch(d){case 0:for(h=0;b[h+1]!=null;h++){d=b[h];h==0?(l=new Node(d.name,d.name),f.addNode(l)):l=f.nodeList[h];for(k=h+1;b[k]!=null;k++)g=b[k],h==0?(m=new Node(g.name,g.name),f.addNode(m)):m=f.nodeList[k],g=b[k],g=NumberListOperators.standardDeviationBetweenTwoNumberLists(d,g),g=1/(1+g),g>=e&&(m=new Relation(h+"_"+k,l.name+"_"+m.name,l,m,g),f.addRelation(m))}}return f};
function StringConversions(){}StringConversions.stringToObject=function(b){return JSON.parse(b)};function StringListOperators(){}StringListOperators.concatStrings=function(b,d){d==null&&(d="");return StringList.fromArray(b.join(d))};StringListOperators.filterStringListByString=function(b,d,e,f){var g,h=f?new NumberList:new StringList;if(e)var k=RegExp("\\b"+d+"\\b");for(g=0;b[g]!=null;g++)e?b[g].match(k).length>0&&h.push(f?g:b[g]):b[g].indexOf(d)!=-1&&h.push(f?g:b[g]);return h};
StringListOperators.countStringsOccurrencesOnTexts=function(b,d){var e=new NumberTable,f,g,h,k,l;for(f=0;b[f]!=null;f++){h=b[f];k=new NumberList;k.name=h;for(g=0;d[g]!=null;g++)l=d[g].split(h),k[g]=l.length-1;e[f]=k}return e};
StringListOperators.getWordsOccurrencesMatrix=function(b,d,e,f,g,h,k,l,m){var n,f=f||500,g=g||1E3,h=h||!0,k=k||!1,l=l||!0,m=m==null?3:m,o=StringOperators.getWordsOccurrencesTable(b[0],d,e,f,m),q;for(n=1;b[n]!=null;n++)q=StringOperators.getWordsOccurrencesTable(b[n],d,e,f,m),o=TableOperators.mergeDataTables(o,q);o[0].length>g&&(l=!0);if(k||l){var s=new NumberList,s=o[1].clone();o.forEach(function(b,d){d<2||b.forEach(function(b,d){s[d]+=b})});k&&o.forEach(function(b,d){d!=0&&b.forEach(function(d,e){b[e]=
d/s[e]})});l&&(o=o.getListsSortedByList(s))}h&&o.forEach(function(b,d){d!=0&&(o[d]=o[d].getNormalizedToSum())});g>0&&(o=o.sliceRows(0,g-1));return o};
StringListOperators.createTextsNetwork=function(b,d,e,f){var g=new Network,h=StringListOperators.getWordsOccurrencesMatrix(b,d,!1,600,800,!1,!0,!1,3);b.forEach(function(b,d){node=new Node("_"+d,"_"+d);node.content=b;node.wordsWeights=h[d+1];g.addNode(node)});for(b=0;g.nodeList[b+1]!=null;b++){node=g.nodeList[b];for(d=b+1;g.nodeList[d]!=null;d++)node1=g.nodeList[d],weight=NumberListOperators.cosineSimilarity(node.wordsWeights,node1.wordsWeights),b==0&&d==1&&(c.log(node.wordsWeights.length,node1.wordsWeights.length,
weight),c.log(node.wordsWeights.type,node.wordsWeights),c.log(node1.wordsWeights.type,node1.wordsWeights),c.log(node.wordsWeights.getNorm()*node1.wordsWeights.getNorm())),weight>f&&(relation=new Relation(node.id+"_"+node1.id,node.id+"_"+node1.id,node,node1,weight),g.addRelation(relation))}return g};
StringListOperators.createShortTextsNetwork=function(b,d,e,f,g){var h=new Network,k=b.join(" *** ").toLowerCase().split(" *** "),l=b.length,m,n,o,q,s,u,e=e||0,f=f||0;c.log("mode",f);var t;switch(f){case 0:t=function(b){return 1-Math.pow(2*Math.pow(b/(l-1),0.25)-1,2)};break;case 1:t=function(b){return 1/b}}b.forEach(function(b,e){node=new Node("_"+e,"_"+e);h.addNode(node);node.content=b;words=StringOperators.getWords(b,!0,d,!1,!1,0,3);q=words.length;s=new NumberList;for(m=0;words[m]!=null;m++)n=words[m],
nOtherTexts=0,k.forEach(function(b,d){e!=d&&(nOtherTexts+=Number(b.indexOf(n)!=-1))}),nOtherTexts==0?(words.splice(m,1),m--):(s[m]=t(nOtherTexts),g&&(s[m]*=Math.sqrt(StringOperators.countOccurrences(k[e],n))));o=Math.floor(Math.log(q+1)*3);words=words.getSortedByList(s,!1).slice(0,o);s=s.getSorted(!1).slice(0,o);node.wordsTable=new Table;node.wordsTable[0]=words;node.wordsTable[1]=s});for(b=0;h.nodeList[b+1]!=null;b++){node=h.nodeList[b];for(m=b+1;h.nodeList[m]!=null;m++)node1=h.nodeList[m],u=0,node.wordsTable[0].forEach(function(b,
d){index=node1.wordsTable[0].indexOf(b);index!=-1&&(u+=node.wordsTable[1][d]*node1.wordsTable[1][index])}),u=Math.sqrt(u/Math.max(node.wordsTable[0].length,node1.wordsTable[0].length)),u>e&&(relation=new Relation(node.id+"_"+node1.id,node.id+"_"+node1.id,node,node1,u),h.addRelation(relation))}return h};function StringOperators(){}StringOperators.ENTER=String.fromCharCode(13);StringOperators.ENTER2=String.fromCharCode(10);StringOperators.ENTER3=String.fromCharCode(8232);StringOperators.SPACE=String.fromCharCode(32);
StringOperators.SPACE2=String.fromCharCode(160);StringOperators.TAB="\t";StringOperators.TAB2=String.fromCharCode(9);StringOperators.LINK_REGEX=/(^|\s+)(https*\:\/\/\S+[^\.\s+])/;StringOperators.MAIL_REGEX=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;StringOperators.STOP_WORDS=StringList.fromArray("t,s,mt,rt,re,m,http,amp,a,able,about,across,after,all,almost,also,am,among,an,and,any,are,as,at,be,because,been,but,by,can,cannot,could,dear,did,do,does,either,else,ever,every,for,from,get,got,had,has,have,he,her,hers,him,his,how,however,i,if,in,into,is,it,its,just,least,let,like,likely,may,me,might,most,must,my,neither,no,nor,not,of,off,often,on,or,other,our,own,rather,said,say,says,she,should,since,so,some,than,that,the,their,them,then,there,these,they,this,tis,to,too,twas,us,wants,was,we,were,what,when,where,which,while,who,whom,why,will,with,would,yet,you,your".split(","));
StringOperators.split=function(b,d){return d==null?StringOperators.splitByEnter(b):StringList.fromArray(b.split(d))};StringOperators.substr=function(b,d,e){return b.substr(d||0,e)};StringOperators.splitString=function(b,d){d==null&&(d=",");typeof d=="string"&&(d=d.replace("\\n","\n"));return b.indexOf(d)==-1?new StringList(b):StringList.fromArray(b.split(d))};
StringOperators.splitByEnter=function(b){var d=StringOperators.splitString(b,"\n");if(d.length>1)return d;d=StringOperators.splitString(b,StringOperators.ENTER2);if(d.length>1)return d;d=StringOperators.splitString(b,StringOperators.ENTER3);return d.length>1?d:null};
StringOperators.getFirstTextBetweenStrings=function(b,d,e){var f=b.indexOf(d);if(f==-1)return null;if(e==""||e==null)return b.substr(f+d.length);e=b.indexOf(e,f+d.length+1);return e==-1?b.substring(f+d.length):b.substr(f+d.length,e-(f+d.length))};StringOperators.getAllTextsBetweenStrings=function(b,d,e){if(b.indexOf(d)==-1)return new StringList;var b=b.split(d),f=b.length,g=new StringList,h,k,l;for(l=1;l<f;l++)h=b[l],e==d?g.push(h):(k=h.indexOf(e),k>=0&&g.push(h.substr(0,k)));return g};
StringOperators.countWordsDichotomyAnalysis=function(b,d,e,f){var g=0;d.forEach(function(d){g-=StringOperators.countWordOccurrences(b,d)});e.forEach(function(d){g+=StringOperators.countWordOccurrences(b,d)});f&&(g/=b.length);return g};
StringOperators.getLinksFromHtml=function(b,d,e){var f=document.createElement("html");f.innerHTML=b;var f=f.getElementsByTagName("a"),g,h=new StringList,k,l,d=d==""?null:d,e=e==null?!1:e;if(d){d=d.trim();d.substr(-5)==".html"&&(l=d.split("/"),d=l.slice(0,l.length-1).join("/"));d.indexOf(-1)=="/"&&(d=d.substr(0,d.length-1));l=d.split("/");var m=d.replace("//","**").split("/")[0].replace("**","//")}for(b=0;b<f.length;b++)if(g=f[b].getAttribute("href"),g!=null){g.indexOf("=")!=-1&&(g=g.split("=")[0]);
d&&g.indexOf("http://")==-1&&g.indexOf("https://")==-1&&g.indexOf("wwww.")==-1&&g.indexOf("file:")==-1&&g.indexOf("gopher:")==-1&&g.indexOf("//")!=0&&(g=g.substr(0,9)=="../../../"?l.slice(0,l.length-3).join("/")+"/"+g.substr(9):g.substr(0,6)=="../../"?l.slice(0,l.length-2).join("/")+"/"+g.substr(6):g.substr(0,3)=="../"?l.slice(0,l.length-1).join("/")+"/"+g.substr(3):g.charAt(0)=="/"?m+g:d+"/"+g);e&&g.indexOf("#")!=-1&&(g=g.split("#")[0]);g.substr(-1)=="/"&&(g=g.substr(0,g.length-1));for(k=g.indexOf("/../");k!=
-1;)g=g.split("/../"),k=g[0].replace("//","**").split("/"),g=k.slice(0,k.length-1).join("/").replace("**","//")+("/"+g.slice(1).join("/../")),k=g.indexOf("/../");g.indexOf("./")!=-1&&(k=g.replace("//","**").split("/"),k[0].substr(-1)=="."&&(k[0]=k[0].substr(0,k[0].length-1),g=k.join("/").replace("**","//")));g=g.trim();g.substr(-1)=="/"&&(g=g.substr(0,g.length-1));g!=d&&h.push(g)}return h=h.getWithoutRepetitions()};
StringOperators.textContainsString=function(b,d,e,f){b=f?d:b.toLowerCase();d=f?d:d.toLowerCase();return e?b.match(RegExp("\\b"+d+"\\b")).length>0:b.indexOf(d)!=-1};StringOperators.logInConsole=function(b,d){(d=d==null?!0:d)&&c.log("///////////////////////////////////////////////////");c.log(b);d&&c.log("///////////////////////////////////////////////////")};
StringOperators.getParenthesisContents=function(b,d){for(var e=new StringList,f=b,g=StringOperators.getFirstParenthesisContentWithIndexes(b,d),h=0;g.content!=""&&g.index1<f.length-1&&h<b.length;)e.push(g.content),f=f.substr(g.index1+2),g=StringOperators.getFirstParenthesisContentWithIndexes(f,d),h++;return e};StringOperators.getFirstParenthesisContent=function(b,d){return StringOperators.getFirstParenthesisContentWithIndexes(b,d).content};
StringOperators.getFirstParenthesisContentWithIndexes=function(b,d){var e=d?"]":")",f=d?/\[/g:/\(/g,g=d?/\]/g:/\)/g,h=b.indexOf(d?"[":"(");if(h==-1)return{content:"",index0:0,index1:0};for(var k=b.indexOf(e),l=b.substring(h+1,k),m=l.match(f),l=l.match(g),m=(m==null?0:m.length)-(l==null?0:l.length),n=0;(m>0||k==-1)&&n<b.length;)k=b.indexOf(e,k),l=b.substring(h+1,k+1),k++,m=l.match(f),l=l.match(g),m=(m==null?0:m.length)-(l==null?0:l.length),n++;k=b.indexOf(e,k);return{content:k==-1?b.substring(h+1):
b.substring(h+1,k),index0:h+1,index1:k==-1?b.length-1:k-1}};StringOperators.placeString=function(b,d,e){return b.substr(0,e)+d+b.substr(e+d.length)};StringOperators.insertString=function(b,d,e){return b.substr(0,e)+d+b.substr(e)};StringOperators.removeEnters=function(b){return b.replace(/(\StringOperators.ENTER|\StringOperators.ENTER2|\StringOperators.ENTER3)/gi," ")};StringOperators.removeTabs=function(b){return b.replace(/(\StringOperators.TAB|\StringOperators.TAB2|\t)/gi,"")};
StringOperators.removePunctuation=function(b,d){return b.replace(/[:,.;?!\(\)\"\']/gi,d||"")};StringOperators.removeDoubleSpaces=function(b){for(var d=RegExp(/  /);d.test(b);)b=b.replace(d," ");return b};StringOperators.removeInitialRepeatedCharacter=function(b,d){for(;b.charAt(0)==d;)b=b.substr(1);return b};StringOperators.removeHtmlTags=function(b){var d=document.createElement("DIV");d.innerHTML=b;return d.textContent||d.innerText};
StringOperators.removeLinks=function(b){b+=" ";return b.replace(/http:\/\/[a-zA-Z0-9\/\.]+( |:|;|\r|\t|\n|\v)/g," ").substr(0,b.length-2)};StringOperators.removeQuotes=function(b){b.charAt(0)=='"'&&(b=b.substr(1));b.charAt(b.length-1)=='"'&&(b=b.substr(0,b.length-1));return b};
StringOperators.getWords=function(b,d,e,f,g,h,k){k=k||0;d=d==null?!0:d;f=f==null?!0:f;g=g==null?!0:g;h=h==null?0:h;if(g)var l=b.match(StringOperators.LINK_REGEX);b=b.toLowerCase().replace(StringOperators.LINK_REGEX,"");b=b.match(/\w+/g);if(b==null)return new StringList;g&&l!=null&&(b=b.concat(l));b=StringList.fromArray(b).replace(/ /g,"");if(e!=null)for(g=0;b[g]!=null;g++)for(l=0;e[l]!=null;l++)if(typeof e[l]=="string"){if(e[l]==b[g]){b.splice(g,1);g--;break}}else if(e[l].test(b[g])){b.splice(g,1);
g--;break}if(k>0)for(g=0;b[g]!=null;g++)b[g].length<k&&(b.removeElementAtIndex(g),g--);if(f){if(d)return b=ListOperators.countElementsRepetitionOnList(b,!0)[0],h!=0&&(b=b.substr(0,h)),b;d=ListOperators.countOccurrencesOnList(b);b=b.getSortedByList(d);h!=0&&(b=b.substr(0,h));return b}d&&(b=b.getWithoutRepetitions());h!=0&&(b=b.splice(0,h));return b};
StringOperators.getWordsOccurrencesTable=function(b,d,e,f,g){if(b.length==0)return new Table(new StringList,new NumberList);b=StringOperators.getWords(b,!1,d,!1,e,f,g);return ListOperators.countElementsRepetitionOnList(b,!0,!1,f)};StringOperators.indexesOf=function(b,d){var e=b.indexOf(d);if(e==-1)return new NumberList;for(var f=new NumberList(e),e=b.indexOf(d,e+1);e!=-1;)f.push(e),e=b.indexOf(d,e+1);return f};
StringOperators.countOccurrences=function(b,d){for(var e=0,f=b.indexOf(d);f!=-1;)e++,f=b.indexOf(d,f+d.length);return e};StringOperators.countWordOccurrences=function(b,d){var e=b.match(RegExp("\\b"+d+"\\b"));return e==null?0:e.length};StringOperators.countStringsOccurrences=function(b,d){var e,f=new NumberList;for(e=0;d[e]!=null;e++)f[e]=b.split(d[e]).length-1;return f};StringOperators.validateEmail=function(b){return StringOperators.MAIL_REGEX.test(b)};StringOperators.validateUrl=function(b){return StringOperators.LINK_REGEX.test(b)};
function NetworkConvertions(){}
NetworkConvertions.createNetworkFromPairsTable=function(b,d,e,f){f==null&&(f=!1);if(b.length<2)return null;var g=new Network,h=d==null?Math.min(b[0].length,b[1].length):Math.min(b[0].length,b[1].length,d.length);d==null&&b.length>2&&typeOf(b[2])==NumberList&&b[2].length>=h&&(d=b[2]);typeOf(b[0])==NodeList&&typeOf(b[1]);var k,l,m,n,o,q;for(q=0;q<h;q++)m=""+b[0][q],n=""+b[1][q],k=g.nodeList.getNodeById(m),k==null?(k=new Node(m,m),g.addNode(k)):k.weight++,l=g.nodeList.getNodeById(n),l==null?(l=new Node(n,
n),g.addNode(l)):l.weight++,d==null?(o=g.relationList.getFirstRelationByNodesIds(k.id,l.id,!1),o==null||f?(o=new Relation(m+"_"+n+g.relationList.length,m+"_"+n,k,l,1),g.addRelation(o)):o.weight++):d[q]>e&&(o=new Relation(m+"_"+n,m+"_"+n,k,l,d[q]),g.addRelation(o));return g};function NetworkEncodings(){}
NetworkEncodings.decodeGDF=function(b){var d=new Network,b=b.split("\n");if(b.length==0)return null;var e,f,g,h=b[0].substr(8).split(","),k;for(f=1;b[f]!=null;f++){e=b[f];if(e.substr(0,8)=="edgedef>"){k=f+1;break}e=NetworkEncodings.replaceChomasInLine(e);g=e.split(",");node=new Node(String(g[0]),String(g[1]));for(e=0;h[e]!=null&&g[e]!=null;e++)h[e]=="weight"?node.weight=Number(g[e]):h[e]=="x"?node.x=Number(g[e]):h[e]=="y"?node.y=Number(g[e]):node[h[e]]=g[e].replace(/\*CHOMA\*/g,",");d.addNode(node)}h=
b[k-1].substr(8).split(",");for(f=k;b[f]!=null;f++)if(e=b[f],e=NetworkEncodings.replaceChomasInLine(e),g=e.split(","),g.length>=2)if(node0=d.nodeList.getNodeById(String(g[0])),node1=d.nodeList.getNodeById(String(g[1])),node0==null||node1==null)c.log("NetworkEncodings.decodeGDF | [!] problems with nodes ids:",g[0],g[1],"at line",f);else{id=node0.id+"_"+node1.id+"_"+Math.floor(Math.random()*999999);relation=new Relation(id,id,node0,node1);for(e=2;h[e]!=null&&g[e]!=null;e++)h[e]=="weight"?relation.weight=
Number(g[e]):relation[h[e]]=g[e].replace(/\*CHOMA\*/g,",");d.addRelation(relation)}return d};
NetworkEncodings.encodeGDF=function(b,d,e){var d=d==null?new StringList:d,e=e==null?new StringList:e,f="nodedef>id"+(d.length>0?",":"")+d.getConcatenated(","),g,h,k;for(g=0;b.nodeList[g]!=null;g++){k=b.nodeList[g];f+="\n"+k.id;for(h=0;d[h]!=null;h++)f+=typeof k[d[h]]=="string"?',"'+k[d[h]]+'"':","+k[d[h]]}f+="\nedgedef>id0,id1"+(e.length>0?",":"")+e.getConcatenated(",");for(g=0;b.relationList[g]!=null;g++){d=b.relationList[g];f+="\n"+d.node0.id+","+d.node1.id;for(h=0;e[h]!=null;h++)f+=typeof d[e[h]]==
"string"?',"'+d[e[h]]+'"':","+d[e[h]]}return f};
NetworkEncodings.decodeGML=function(b){if(b==null)return null;for(var b=b.substr(b.indexOf("[")+1),d=new Network,e=b.search(/\bedge\b/),f=b.substr(0,e),g=b.substr(e),f=StringOperators.getParenthesisContents(f,!0),h,k,l,b=0;f[b]!=null;b++){f[b]=StringOperators.removeInitialRepeatedCharacter(f[b],"\n");f[b]=StringOperators.removeInitialRepeatedCharacter(f[b],"\r");k=f[b].indexOf("graphics");k!=-1&&(h=f[b].indexOf("]"),e=f[b].substring(k,h+1),f[b]=f[b].substr(0,k)+f[b].substr(h+1),e=StringOperators.getFirstParenthesisContent(e,
!0),f[b]+=e);e=f[b].split("\n");e[0]=NetworkEncodings._cleanLineBeginning(e[0]);h=e[0].split(" ");l=new Node(StringOperators.removeQuotes(h[1]),StringOperators.removeQuotes(h[1]));d.addNode(l);for(k=1;e[k]!=null;k++)e[k]=NetworkEncodings._cleanLineBeginning(e[k]),e[k]=NetworkEncodings._replaceSpacesInLine(e[k]),e[k]!=""&&(h=e[k].split(" "),h[0]=="label"&&(h[0]="name"),l[h[0]]=h[1].charAt(0)=='"'?StringOperators.removeQuotes(h[1]).replace(/\*SPACE\*/g," "):Number(h[1]))}for(var f=StringOperators.getParenthesisContents(g,
!0),m,n,o=d.nodeList,b=0;f[b]!=null;b++){f[b]=StringOperators.removeInitialRepeatedCharacter(f[b],"\n");f[b]=StringOperators.removeInitialRepeatedCharacter(f[b],"\r");e=f[b].split("\n");n=l=g=null;for(k=0;e[k]!=null;k++)e[k]=NetworkEncodings._cleanLineBeginning(e[k]),e[k]!=""&&(h=e[k].split(" "),h[0]=="source"&&(g=StringOperators.removeQuotes(h[1])),h[0]=="target"&&(l=StringOperators.removeQuotes(h[1])),n==null?g!=null&&l!=null&&(h=o.getNodeById(g),m=o.getNodeById(l),h!=null&&m!=null&&(n=new Relation(g+
" "+l,"",h,m),d.addRelation(n))):(h[0]=="value"&&(h[0]="weight"),n[h[0]]=h[1].charAt(0)=='"'?StringOperators.removeQuotes(h[1]):Number(h[1])))}return d};NetworkEncodings._cleanLineBeginning=function(b){b=StringOperators.removeInitialRepeatedCharacter(b,"\n");b=StringOperators.removeInitialRepeatedCharacter(b,"\r");b=StringOperators.removeInitialRepeatedCharacter(b," ");return b=StringOperators.removeInitialRepeatedCharacter(b,"\t")};
NetworkEncodings.encodeGML=function(b,d,e){var d=d==null?new StringList:d,e=e==null?new StringList:e,f="graph\n[",g="\t",h,k,l,m,n;for(h=0;b.nodeList[h]!=null;h++){l=b.nodeList[h];f+="\n"+g+"node\n"+g+"[";g="\t\t";f+="\n"+g+'id "'+l.id+'"';l.name!=""&&(f+="\n"+g+'label "'+l.name+'"');for(k=0;d[k]!=null;k++)n=l[d[k]],n!=null&&(n.getMonth&&(n=DateOperators.dateToString(n)),(m=typeof n=="string")&&(n=n.replace(/\n/g,"\\n").replace(/\"/g,"'")),f+="\n"+g+d[k]+" "+(m?'"'+n+'"':n));g="\t";f+="\n"+g+"]"}for(h=
0;b.relationList[h]!=null;h++){d=b.relationList[h];f+="\n"+g+"edge\n"+g+"[";g="\t\t";f+="\n"+g+'source "'+d.node0.id+'"';f+="\n"+g+'target "'+d.node1.id+'"';for(k=0;e[k]!=null;k++)n=d[e[k]],n!=null&&(n.getMonth&&(n=DateOperators.dateToString(n)),(m=typeof n=="string")&&(n=n.replace(/\n/g,"\\n").replace(/\"|\u201c|\u201d/g,"'")),f+="\n"+g+e[k]+" "+(m?'"'+n+'"':n));g="\t";f+="\n"+g+"]"}f+="\n]";return f};
NetworkEncodings.decodeSYM=function(b){for(var d,e=StringOperators.splitByEnter(b),e=e==null?[]:e,f=/((?:NODE|RELATION)|GROUP)\s*([A-Za-z0-9_,\s]*)/,g=new Network,h=new Table,k,l,m,n,o=[],q=[],s=[],b=0;e[b]!=null;b++)if(k=f.exec(e[b]),k!=null)switch(k[1]){case "NODE":d=k[2];k=e[b+1].substr(0,5)=="name:"?e[b+1].substr(5).trim():"";k=k.replace(/\\n/g,"\n").replace(/\\'/g,"'");k=new Node(d,k);g.addNode(k);for(d=b+1;d<e.length&&e[d].indexOf(":")!=-1;)n=e[d].split(":"),m=n[0],n=n.slice(1).join(":"),m!=
"name"&&(n=n.trim(),k[m]=String(Number(n))==n?Number(n):n,typeof k[m]=="string"&&(k[m]=k[m].replace(/\\n/g,"\n").replace(/\\'/g,"'")),o.indexOf(m)==-1&&o.push(m)),d++;if(k.color!=null&&/.+,.+,.+/.test(k.color))k.color="rgb("+k.color+")";if(k.group!=null){m=h.getFirstElementByPropertyValue("name",k.group);if(m==null)c.log("NODES new group:["+k.group+"]"),m=new NodeList,m.name=k.group,m.name=m.name.replace(/\\n/g,"\n").replace(/\\'/g,"'"),h.push(m);m.addNode(k)}break;case "RELATION":d=k[2].replace(/\s/g,
"").split(",");k=g.nodeList.getNodeById(d[0]);d=g.nodeList.getNodeById(d[1]);if(k!=null&&d!=null){l=new Relation(k.id+"_"+d.id,k.id+"_"+d.id,k,d);g.addRelation(l);for(d=b+1;d<e.length&&e[d].indexOf(":")!=-1;)n=e[d].split(":"),m=n[0],n=n.slice(1).join(":").trim(),m!="name"&&(n=n.trim(),l[m]=String(Number(n))==n?Number(n):n,typeof l[m]=="string"&&(l[m]=l[m].replace(/\\n/g,"\n").replace(/\\'/g,"'")),q.indexOf(m)==-1&&q.push(m)),d++}if(l!=null&&l.color!=null)l.color="rgb("+l.color+")";break;case "GROUP":k=
e[b].substr(5).trim();m=h.getFirstElementByPropertyValue("name",k);if(m==null)m=new NodeList,m.name=k,h.push(m);for(d=b+1;d<e.length&&e[d].indexOf(":")!=-1;)n=e[d].split(":"),n[0]!="name"&&(n[1]=n[1].trim(),m[n[0]]=String(Number(n[1]))==n[1]?Number(n[1]):n[1],s.indexOf(n[0])==-1&&s.push(n[0])),d++;if(/.+,.+,.+/.test(m.color))m.color="rgb("+m.color+")"}for(b=0;h[b]!=null;b++){m=h[b];if(m.color==null)m.color=CATEGORICAL_COLORS[b%CATEGORICAL_COLORS.length];for(d=0;m[d]!=null;d++)if(k=m[d],k.color==null)k.color=
m.color}g.groups=h;g.nodePropertiesNames=o;g.relationPropertiesNames=q;g.groupsPropertiesNames=s;return g};
NetworkEncodings.encodeSYM=function(b,d,e,f,g){var e=e==null?new StringList:e,f=f==null?new StringList:f,h="",k,l,m,n;for(k=0;b.nodeList[k]!=null;k++){m=b.nodeList[k];h+=(k==0?"":"\n\n")+"NODE "+m.id;m.name!=""&&(h+="\nname:"+m.name.replace(/\n/g,"\\n"));for(l=0;e[l]!=null;l++)n=e[l],m[n]!=null&&(h+="\n"+n+":"+_processProperty(n,m[n]))}for(k=0;b.relationList[k]!=null;k++){e=b.relationList[k];h+="\n\nRELATION "+e.node0.id+", "+e.node1.id;for(l=0;f[l]!=null;l++)n=f[l],e[n]!=null&&(h+="\n"+n+":"+_processProperty(n,
e[n]))}if(d==null)return h;for(k=0;d[k]!=null;k++){b=d[k];h+="\n\nGROUP "+b.name;for(l=0;g[l]!=null;l++)n=g[l],b[n]!=null&&(h+="\n"+n+":"+_processProperty(n,b[n]))}return h};_processProperty=function(b,d){switch(b){case "color":return d.substr(0,3)=="rgb"?ColorOperators.colorStringToRGB(d).join(","):d}return d=String(d).replace(/\n/g,"\\n")};
NetworkEncodings.replaceChomasInLine=function(b){var d=b.split('"');if(d.length<2)return b;var e;for(e=0;d[e]!=null;e++)(b=e*0.5!=Math.floor(e*0.5))&&(d[e]=d[e].replace(/,/g,"*CHOMA*"));return b=StringList.fromArray(d).getConcatenated("")};NetworkEncodings._replaceSpacesInLine=function(b){var d=b.split('"');if(d.length<2)return b;var e;for(e=0;d[e]!=null;e++)(b=e*0.5!=Math.floor(e*0.5))&&(d[e]=d[e].replace(/ /g,"*SPACE*"));return b=StringList.fromArray(d).getConcatenated('"')};
function NetworkGenerators(){}
NetworkGenerators.createRandomNetwork=function(b,d,e,f){if(b==null||d==null)return null;var e=e==null?0:e,g,h,k=new Network;for(g=0;g<b;g++)k.addNode(new Node("n"+g,"n"+g));switch(e){case 0:for(g=0;g<b-1;g++){e=k.nodeList[g];for(h=g+1;h<b;h++)Math.random()<d&&k.addRelation(new Relation(g+"_"+h,g+"_"+h,e,k.nodeList[h],f?Math.random():1))}return k;case 1:var b=b*(b-1)*0.5,l,m;for(g=0;g<b;g++)if(Math.random()<d)for(h=!0;h;)if(e=k.nodeList[Math.floor(k.nodeList.length*Math.random())],Math.random()<(e.nodeList.length+
1)/1)for(;h;)if(l=k.nodeList[Math.floor(k.nodeList.length*Math.random())],m=e.id+"_"+l.id,!(k.relationList.getNodeById(m)!=null||k.relationList.getNodeById(l.id+"_"+e.id)!=null)&&Math.random()<(l.nodeList.length+1)/1)k.addRelation(new Relation(m,m,e,l,f?Math.random():1)),h=!1;return k}};NetworkGenerators.createTextsCoOccurrencesNetwork=function(b,d,e,f){b=StringListOperators.countStringsOccurrencesOnTexts(b,d,e,f);return NetworkGenerators.createNetworkFromOccurrencesTable(b)};
NetworkGenerators.createNetworkFromOccurrencesTable=function(b,d,e){var d=d==null?0:d,e=e==null?0:e,f=new Network,g,h,k,l,m,n,o,q;for(g=0;b[g]!=null;g++){k=b[g].name;g==0?(n=new Node(k,k),f.addNode(n)):n=f.nodeList[g];h=b[g].getSum();n.weight=h;for(h=g+1;b[h]!=null;h++){l=b[h].name;g==0?(o=new Node(l,l),f.addNode(o)):o=f.nodeList[h];q=b[h].getSum();o.weight=q;switch(d){case 0:m=b[g].dotProduct(b[h]);break;case 1:m=NumberListOperators.cosinus(b[g],b[h])}m>e&&f.createRelation(n,o,k+"_"+l,m)}}return f};
NetworkGenerators.createNetworkFromListAndFunction=function(b,d,e){var f,g,h,k,l=new Network;for(f=0;b[f+1]!=null;f++){f==0&&l.addNode(new Node("n_0",e==null?"n_0":e[f]));k=l.nodeList[f];for(g=f+1;b[g]!=null;g++)f==0&&l.addNode(new Node("n_"+g,e==null?"n_"+g:e[g])),h=d(b[f],b[g]),h>0&&l.addRelation(new Relation(f+"_"+g,f+"_"+g,k,l.nodeList[g],h))}return l};
NetworkGenerators.createNetworkFromPairsTable=function(b,d){for(var e=b[0].toStringList().append("#").append(b[1].toStringList()).countOccurrences(),f,g,h=new Network,k=0;b[0][k]!=null;k++)e[k]>d&&(f=h.nodeList.getNodeById(b[0][k]),f==null&&(f=new Node(b[0][k],b[0][k]),h.addNode(f)),g=h.nodeList.getNodeById(b[1][k]),g==null&&(g=new Node(b[1][k],b[1][k]),h.addNode(g)),h.addRelation(new Relation(f.id+"_"+g.id,f.id+"_"+g.id,f,g,e[k])));return h};NetworkOperators=function(){};
NetworkOperators.filterNodesByMinDegree=function(b,d){var e;for(e=0;b.nodeList[e]!=null;e++)b.nodeList[e].nodeList.length<d&&(b.removeNode(b.nodeList[e]),e--);return null};NetworkOperators.degreeBetweenNodes=function(b,d,e){if(d==e)return 0;for(var b=d.nodeList,d=1,f,g;b.indexOf(e)==-1;){f=b.clone();for(g=0;b[g]!=null;g++)f=ListOperators.concat(f,b[g].nodeList);f=f.getWithoutRepetitions();if(b.length==f.length)return-1;b=f;d++}return d};
NetworkOperators.shortestPath=function(b,d,e,f){var g=NetworkOperators.spanningTree(b,d,e),b=new NodeList;f&&b.push(e);e=g.nodeList.getNodeById(e.id);if(e==null)return null;for(;e.parent.id!=d.id;)if(b.push(e.parent.node),e=e.parent,e==null)return null;f&&b.push(d);return b.getReversed()};
NetworkOperators.spanningTree=function(b,d,e){var b=new Tree,f=new Node(d.id,d.name);f.node=d;b.addNodeToTree(f);var g=d.nodeList,h,k,l,m,n=!1;for(l=0;g[l]!=null;l++)h=new Node(g[l].id,g[l].name),h.node=g[l],b.addNodeToTree(h,f),e!=null&&h.id==e.id&&(n=!0);if(n)return b;f=g.clone();for(f.push(d);;){d=new NodeList;for(l=0;g[l]!=null;l++)d.addNodes(g[l].nodeList);d=d.getWithoutRepetitions();d.removeElements(f);if(d.length==0)break;for(l=0;d[l]!=null;l++){h=new Node(d[l].id,d[l].name);h.node=d[l];for(j=
0;d[l].nodeList[j]!=null;j++)if(m=d[l].nodeList[j].id,k=g.getNodeById(m),k!=null){b.addNodeToTree(h,b.nodeList.getNodeById(m));break}e!=null&&h.id==e.id&&(n=!0)}n&&(n=!0);g=d;f=f.concat(d)}return b};
NetworkOperators.degreesPartition=function(b,d){var e=new NodeList(d),f=nodes=d.nodeList,g,h,k,l=new Table(e);(g=f.length>0)&&l.push(f);var m=f.clone();for(m.push(d);g;){e=new NodeList;for(h=0;f[h]!=null;h++){g=f[h].nodeList;for(k=0;g[k]!=null;k++)m.indexOf(g[k])==-1&&(e.push(g[k]),m.push(g[k]))}if(g=e.length>0)f=e,l.push(f)}return l};
NetworkOperators.degreesFromNodeToNodes=function(b,d,e){var b=NetworkOperators.degreesPartition(b,d),f=new NumberList;f.max=0;for(var g,h=0;e[h]!=null;h++){if(e[h]==d)f[h]=0;else for(g=1;b[g]!=null;g++)if(b[g].indexOf(e[h])!=-1){f[h]=g;f.max=Math.max(f.max,g);break}f[h]==null&&(f[h]=-1)}return f};
NetworkOperators.buildDendrogram=function(b){if(b==null)return null;var d=(new Date).getTime(),e=new Tree,f=new NodeList,g,h,k,l;k=b.nodeList.length;var m=2*b.relationList.length/(k*(k-1));for(g=0;b.nodeList[g]!=null;g++)k=new Node("["+b.nodeList[g].id+"]","["+b.nodeList[g].id+"]"),k.nodes=new NodeList(b.nodeList[g]),e.addNode(k),f[g]=k;for(;f.length>1;){g=NetworkOperators._getClosestPair(f,!0,m);b=f[g[0]];h=f[g[1]];l="["+b.id+"-"+h.id+"]";k=new Node(l,l);k.weight=g.strength;e.addNode(k);e.createRelation(k,
b,l+"-"+b.id);e.createRelation(k,h,l+"-"+h.id);k.node=new Node(l,l);k.nodes=b.nodes.concat(h.nodes);for(g=0;b.nodeList[g]!=null;g++)k.node.nodeList.push(b.nodeList[g]),k.node.relationList.push(b.relationList[g]);for(g=0;h.nodeList[g]!=null;g++)k.node.nodeList.push(b.nodeList[g]),k.node.relationList.push(b.relationList[g]);f.removeElement(b);f.removeElement(h);f.push(k)}for(g=0;e.nodeList[g]!=null;g++)if(b=e.nodeList[g],b.nodes.length>1)b.level=Math.max(b.nodeList[0].level,b.nodeList[1].level)+1;c.log("\n\n\n\nTIME ------\>"+
((new Date).getTime()-d)+"\n\n\n\n");return e};
NetworkOperators._getClosestPair=function(b,d,e){if(b.length==2){var f=b[0].nodeList.indexOf(b[1]);if(d){var g=[0,1];g.strength=f==-1?0:b[0].relationList[f].weight;return g}d=new NodeList(b[0],b[1]);d.strength=f==-1?0:b[0].relationList[f].weight;return d}var h,k,l,m,f=-1;for(h=0;b[h+1]!=null;h++){l=b[h].nodes;for(k=h+1;b[k]!=null;k++)m=NetworkOperators._strengthBetweenSets(l,b[k].nodes,e),m>f&&(g=[h,k],f=m)}g.strength=f;if(d)return g;d=new NodeList(b[g[0]],b[g[1]]);d.strength=f;return d};
NetworkOperators._strengthBetweenSets=function(b,d,e){var f=0,g,h,k;for(g=0;b[g]!=null;g++){k=b[g];for(h=0;k.nodeList[h]!=null;h++)d.indexOf(k.nodeList[h])!=-1&&(f+=k.relationList[h].weight)}return f/(b.length*d.length*e)};NetworkOperators.buildNetworkClusters=function(b,d,e){if(b!=null)return d==null&&(d=NetworkOperators.buildDendrogram(b)),e=e||0.5,b=new Table,NetworkOperators._iterativeBuildClusters(d.nodeList[d.nodeList.length-1],b,e),b};
NetworkOperators._iterativeBuildClusters=function(b,d,e){c.log("_iterativeBuildClusters, clusters.length",d.length);b.nodeList.length==1?d.push(new NodeList(b.node)):(b.nodeList[0].nodes.length==1||b.nodeList[0].weight>e?d.push(b.nodeList[0].nodes):NetworkOperators._iterativeBuildClusters(b.nodeList[0],d,e),b.nodeList[1].nodes.length==1||b.nodeList[1].weight>e?d.push(b.nodeList[1].nodes):NetworkOperators._iterativeBuildClusters(b.nodeList[1],d,e))};
NetworkOperators.addPageRankToNodes=function(b,d){var d=d==null?!0:d,e,f,g;e=b.nodeList.length;var h=(1-0.85)/e,k=d?"fromPageRank":"toPageRank",l,m,n;for(f=0;b.nodeList[f]!=null;f++)l=b.nodeList[f],l[k]=1/e;for(e=0;e<100;e++)for(f=0;b.nodeList[f]!=null;f++){l=b.nodeList[f];n=d?l.fromNodeList:l.toNodeList;l[k]=h;for(g=0;n[g]!=null;g++)m=n[g],l[k]+=0.85*m[k]/(d?m.toNodeList.length:m.fromNodeList.length)}};function TreeEncodings(){}
TreeEncodings.decodeIdentedTree=function(b,d,e){var d=d==null?"":d,e=e==null?"\t":e,f=new Tree,b=StringOperators.splitByEnter(b),g=b.length;if(g==0||g==1&&(b[0]==null||b[0]==""))return null;var h,k,l,m;if(d!=""&&d!=null){var n=new Node(d,d);f.addNodeToTree(n,null)}for(d=0;d<g;d++){k=b[d];l=k.length;for(h=0;h<l;h++)if(k.charAt(h)!=e){m=k.substr(h);break}k=new Node(k,m);h==0?n!=null?f.addNodeToTree(k,n):f.addNodeToTree(k,null):(h=h+1-Number(n==null),h=f.getNodesByLevel(h-1)!=null&&f.getNodesByLevel(h-
1).length>0?f.getNodesByLevel(h-1)[f.getNodesByLevel(h-1).length-1]:null,f.addNodeToTree(k,h))}f.assignDescentWeightsToNodes();return f};function CanvasAndContext(){}CanvasAndContext.createInvisibleContext=function(){var b=document.createElement("canvas");b.width=cW;b.height=cH;return b.getContext("2d")};function Draw(){}
Draw.drawSmoothPolygon=function(b,d,e){var e=e==null?30:e,f;if(b.length<2)return null;if(b.length==2){var g=Math.atan2(b[1].y-b[0].y,b[1].x-b[0].x)-0.5*Math.PI,h=e*Math.cos(g);e*=Math.sin(g);context.moveTo(b[0].x,b[0].y);context.bezierCurveTo(b[0].x+h,b[0].y+e,b[1].x+h,b[1].y+e,b[1].x,b[1].y);context.bezierCurveTo(b[1].x-h,b[1].y-e,b[0].x-h,b[0].y-e,b[0].x,b[0].y)}else{h=b.length;f=b[h-1];var g=b[0],k=b[1];f=GeometryOperators.getSoftenControlPoints(f,g,k,e);var l=f[1];context.moveTo(g.x,g.y);f=g;
for(var m=h+Number(d),d=1;d<m;d++)g=b[d%h],k=b[(d+1)%h],f=GeometryOperators.getSoftenControlPoints(f,g,k,e),k=f[0],context.bezierCurveTo(l.x,l.y,k.x,k.y,g.x,g.y),l=f[1],f=g}};
Draw.fillRectangleWithImage=function(b,d,e,f){if(f!=null)context.fillStyle=f,context.beginPath(),context.fillRect(b.x,b.y,b.width,b.height),context.fill();var g,h,k,l;switch(e){case 0:context.drawImage(d,b.x,b.y,b.width,b.height);break;case 1:g=Math.max(d.width-b.width,0)*0.5;h=Math.max(d.height-b.height,0)*0.5;k=b.x+Math.max(b.width-d.width,0)*0.5;l=b.y+Math.max(b.height-d.height,0)*0.5;e=Math.min(d.width,b.width);f=Math.min(d.height,b.height);context.drawImage(d,g,h,e,f,k,l,e,f);break;case 2:e=
Math.min(d.width,b.width);f=Math.min(d.height,b.height);g=e/f;h=d.width/d.height;g<h&&(f=e/h);g>h&&(e=f/h);k=b.x+(b.width-e)*0.5;l=b.y+(b.height-f)*0.5;context.drawImage(d,0,0,d.width,d.height,k,l,e,f);break;case 3:b.width/b.height<d.width/d.height?(sh=d.height,sw=sh*b.width/b.height,g=0.5*(d.width-sw),h=0):(sw=d.width,sh=sw*b.height/b.width,g=0,h=0.5*(d.height-sh)),context.drawImage(d,g,h,sw,sh,b.x,b.y,b.width,b.height)}};
Draw.drawEllipse=function(b,d,e,f){var g=e*0.5522848,h=f*0.5522848,k=b+e,l=d+f;context.moveTo(b-e,d);context.bezierCurveTo(b-e,d-h,b-g,d-f,b,d-f);context.bezierCurveTo(b+g,d-f,k,d-h,k,d);context.bezierCurveTo(k,d+h,b+g,l,b,l);context.bezierCurveTo(b-g,l,b-e,d+h,b-e,d);context.moveTo(b-e,d)};Draw.drawPolygon=function(b,d,e,f){var e=e||0,f=f||0,g;context.moveTo(e+b[0].x,f+b[0].y);for(g=1;b[g]!=null;g++)context.lineTo(e+b[g].x,f+b[g].y);d&&context.lineTo(e+b[0].x,f+b[0].y)};
Draw.drawPolygonWithControlPoints=function(b,d,e,f){var e=e||0,f=f||0,g;context.moveTo(e+b[0].x,f+b[0].y);for(g=1;b[g]!=null;g++)context.bezierCurveTo(e+d[(g-1)*2].x,f+d[(g-1)*2].y,e+d[g*2-1].x,f+d[g*2-1].y,e+b[g].x,f+b[g].y)};Draw.drawBezierPolygon=function(b,d,e){var d=d||0,e=e||0,f,g=Math.floor((b.length-1)/3),h;context.moveTo(d+b[0].x,e+b[0].y);for(h=0;h<g;h++)f=h*3+1,context.bezierCurveTo(d+b[f].x,e+b[f].y,d+b[f+1].x,e+b[f+1].y,d+b[f+2].x,e+b[f+2].y)};
Draw.drawBezierPolygonTransformed=function(b,d){if(!(b==null||b.length==0)){var e,f=Math.floor((b.length-1)/3),g,h=d(b[0]),k;context.moveTo(h.x,h.y);for(g=0;g<f;g++)e=g*3+1,h=d(b[e]),k=d(b[e+1]),e=d(b[e+2]),context.bezierCurveTo(h.x,h.y,k.x,k.y,e.x,e.y)}};Draw.drawPolygonTransformed=function(b,d){var e=d(b[0]);context.moveTo(e.x,e.y);for(i=0;b[i]!=null;i++)e=d(b[i]),context.lineTo(e.x,e.y)};
Draw.drawSliderRectangle=function(b,d,e,f){context.arc(b+e*0.5,d,e*0.5,Math.PI,TwoPi);context.lineTo(b+e,d);context.arc(b+e*0.5,d+f,e*0.5,0,Math.PI);context.lineTo(b,d)};Draw.drawRoundRect=function(b,d,e,f,g){var g=g||0,h=d+f;context.moveTo(b+g,d);context.lineTo(b+e-g,d);context.quadraticCurveTo(b+e,d,b+e,d+g);context.lineTo(b+e,d+f-g);context.quadraticCurveTo(b+e,h,b+e-g,h);context.lineTo(b+g,h);context.quadraticCurveTo(b,h,b,h-g);context.lineTo(b,d+g);context.quadraticCurveTo(b,d,b+g,d)};
Draw.drawEquilateralTriangle=function(b,d,e,f){f=f||0;context.moveTo(e*Math.cos(f)+b,e*Math.sin(f)+d);context.lineTo(e*Math.cos(f+2.0944)+b,e*Math.sin(f+2.0944)+d);context.lineTo(e*Math.cos(f+4.1888)+b,e*Math.sin(f+4.1888)+d);context.lineTo(e*Math.cos(f)+b,e*Math.sin(f)+d)};Draw.drawArrowTriangle=function(b,d,e){var f=b.angleToPoint(d),d=b.distanceToPoint(d);Draw.drawTriangleFromBase(b.x,b.y,e,d,f)};
Draw.drawTriangleFromBase=function(b,d,e,f,g){context.moveTo(b+0.5*e*Math.cos(g+Math.PI*0.5),d+0.5*e*Math.sin(g+Math.PI*0.5));context.lineTo(b+0.5*e*Math.cos(g-Math.PI*0.5),d+0.5*e*Math.sin(g-Math.PI*0.5));context.lineTo(b+f*Math.cos(g),d+f*Math.sin(g));context.lineTo(b+0.5*e*Math.cos(g+Math.PI*0.5),d+0.5*e*Math.sin(g+Math.PI*0.5))};
Draw.drawHorizontalFlowPiece=function(b,d,e,f,g,h,k){context.moveTo(b,e);context.bezierCurveTo(b+k,e,d-k,g,d,g);context.lineTo(d,h);context.bezierCurveTo(d-k,h,b+k,f,b,f);context.lineTo(b,e)};
Draw.drawRectangles=function(b,d,e,f,g,h,k){var g=g||0,l=2*g,m,n;if(f!=null)var o=f.length;var q=new Rectangle;for(m=0;b[m]!=null;m++)if(n=b[m],!(n.height<=g||n.width<=g)){if(f!=null)context.fillStyle=f[m%o];context.fillRect(n.x+d+g,n.y+e+g,n.width-l,n.height-l);if(h!=null&&h[m]!=null)q.x=n.x+d+g,q.y=n.y+e+g,q.width=n.width-l,q.height=n.height-l,Draw.fillRectangleWithImage(context,q,h[m],k)}};
Draw.drawQuadrilater=function(b,d,e,f,g){g=g==null?!0:g;context.moveTo(b.x,b.y);context.lineTo(d.x,d.y);context.lineTo(e.x,e.y);context.lineTo(f.x,f.y);g&&context.lineTo(b.x,b.y)};Draw.drawLens=function(b,d){if(d.x<b.x)var e=d.clone(),d=b.clone(),b=e;d.x+d.z<=b.x+b.z?context.arc(d.x,d.y,d.z,0,TwoPi):b.x-b.z>=d.x-d.z?context.arc(b.x,b.y,b.z,0,TwoPi):(e=GeometryOperators.circlesLensAngles(b,d),context.arc(b.x,b.y,b.z,e[0],e[1]),context.arc(d.x,d.y,d.z,e[2],e[3]))};
Draw.drawAndCapture=function(b,d,e){var f=context;context=hiddenContext;context.canvas.setAttribute("width",d.width);context.canvas.setAttribute("height",d.height);context.clearRect(0,0,d.width,d.height);context.translate(-d.x,-d.y);b.call(e);b=new Image;b.src=context.canvas.toDataURL();context=f;return b};function DrawSimpleVis(){}
DrawSimpleVis.drawSimpleBarChart=function(b,d,e,f){var f=f==null?ColorListOperators.colorListFromColorScale(new ColorScale):f,e=e==null?new Rectangle(10,10,400,300):e,g=e.width/d.length,h=e.getBottom(),k=d.getNormalizedToMax(e.height),l;for(l=0;d[l]!=null;l++)b.fillStyle=f[l],b.fillRect(e.x+l*g,h-k[l],g-1,k[l])};DrawSimpleVis.drawIntervalsFlowTable=function(){c.log("[!] MOVED TO IntervalTableDraw.js")};DrawSimpleVis.drawIntervalsWordsFlowTable=function(){c.log("[!] MOVED TO IntervalTableDraw.js")};
DrawSimpleVis.drawStackBarsFlowTable=function(b,d,e,f){var g=d.length,h,f=f==null?ColorListOperators.colorListFromColorScale(new ColorScale(ColorOperators.temperatureScale),g):f,e=e==null?new Rectangle(10,10,400,300):e,k=d[0].length,l=e.width/(k-1),m=e.height,n,o,q,s,u,g=d[g-1];s=0;var t=e.x,v=e.y;b.strokeStyle="white";for(e=0;d[e]!=null;e++){u=d[e];for(h=1;h<k;h++)s=(1-g[h].y)*0.5*m+e*0+v,n=new Point(h*l+t,u[h].x*m+s),o=new Point((h+1)*l+t,u[h].x*m+s),q=new Point((h+1)*l+t,u[h].y*m+s),s=new Point(h*
l+t,u[h].y*m+s),b.fillStyle=f[e],b.beginPath(),b.moveTo(n.x,n.y),b.lineTo(o.x,o.y),b.lineTo(q.x,q.y),b.lineTo(s.x,s.y),b.lineTo(n.x,n.y),b.fill();b.fill()}};function DrawTexts(){}DrawTexts.POINT_TO_PIXEL=1.3333;DrawTexts.PIXEL_TO_POINT=0.75;DrawTexts.fillTextRectangle=function(b,d,e,f,g,h,k,l){b=DrawTexts.textWordWrapReturnLines(b,f,g,h,l);return DrawTexts.fillTextRectangleWithTextLines(b,d,e,g,h,k)};
DrawTexts.fillTextRotated=function(b,d,e,f){context.save();context.translate(d,e);context.rotate(f);context.fillText(b,0,0);context.restore()};DrawTexts.fillTextRectangleWithTextLines=function(b,d,e,f,g,h){for(var f=f==0||f==null?99999:f,k=0;b[k]!=null;k++)if(context.fillText(b[k],d,e+k*g),(k+2)*g>f)break;return h?b.length*g:b.length};
DrawTexts.textWordWrapReturnLines=function(b,d,e,f,g){d=d||100;f=f||16;f=f==0?-1:Math.floor((e||600)/f);e=new StringList;if(d<=0)return e.push(b),e;var b=b.split(/\\n|\n/),h,k=0,l,m,n,o;for(h=0;h<b.length;h++){if(b[h]=="")e.push("");else{l=b[h].split(" ");for(m=1;l.length>0&&m<=l.length;)if(n=l.slice(0,m).join(" "),n=context.measureText(n).width,n>d){m==1&&(m=2);o=l.slice(0,m-1).join(" ");o!=""&&e.push(o);if(e.length==f)return g&&(g=e[e.length-1],context.measureText(g+"\u2026").width<=d?e[e.length-
1]+="\u2026":(l=g.split(" "),o=l.slice(0,l.length-1).join(" ")+"\u2026",e.push(o))),e;k++;l=l.splice(m-1);m=1}else m++;m>0&&(o=l.join(" "),o!=""&&e.push(o))}k++}e.width=e.length==1?n:d;return e};DrawTexts.getMaxTextWidth=function(b){for(var d=getTextW(b[0]),e=1;b[e]!=null;e++)d=Math.max(d,getTextW(b[e]));return d};
DrawTexts.cropString=function(b,d,e){if(d!=null){e=e||0;if(e<=0||b.measureText(d).width<=e)return d;for(var d=d.split(""),f=1;d.length>0&&f<=d.length;){var g=d.slice(0,f).join("");if(b.measureText(g).width>e)return f==1&&(f=2),d.slice(0,f-1).join("");else f++}}};function DrawTextsAdvanced(){}DrawTextsAdvanced.characterOnQuadrilater=function(){};
DrawTextsAdvanced.textOnQuadrilater=function(b,d,e,f,g,h,k){k=k==null?0:k;if(k==1){var k=new Point((d.x+e.x)*0.5,(d.y+e.y)*0.5),l=new Point((d.x+g.x)*0.5,(d.y+g.y)*0.5),m=new Point((f.x+g.x)*0.5,(f.y+g.y)*0.5),n=new Point((e.x+f.x)*0.5,(e.y+f.y)*0.5),o=new Point((k.x+m.x)*0.5,(k.y+m.y)*0.5);DrawTextsAdvanced.textOnQuadrilater(b,d,k,o,l,h,2);DrawTextsAdvanced.textOnQuadrilater(b,k,e,n,o,h,3);DrawTextsAdvanced.textOnQuadrilater(b,o,n,f,m,h,4);DrawTextsAdvanced.textOnQuadrilater(b,l,o,m,g,h,5)}else{l=
context.measureText(b).width;switch(k){case 0:m=new Point(0,0);n=new Point(l,0);o=new Point(1.0E-6,h+1.0E-6);break;case 2:m=new Point(0,0);n=new Point(l*0.5,0);o=new Point(1.0E-6,h*0.5+1.0E-6);break;case 3:m=new Point(l*0.5,0);n=new Point(l,0);o=new Point(l*0.5+1.0E-6,h*0.5+1.0E-6);break;case 4:m=new Point(l*0.5,h*0.5);n=new Point(l,h*0.5);o=new Point(l*0.5+1.0E-6,h+1.0E-6);break;case 5:m=new Point(0,h*0.5),n=new Point(l*0.5,h*0.5),o=new Point(1.0E-6,h+1.0E-6)}context.save();DrawTextsAdvanced.applyTransformationOnCanvasFromPoints(m,
n,o,d,e,g);context.beginPath();context.moveTo(m.x-2,m.y-2);context.lineTo(n.x+8,n.y-2);context.lineTo(o.x-2,o.y+8);context.clip();context.fillText(b,0,0);context.restore();m.x=n.x+1.0E-4;m.y=o.y+1.0E-4;context.save();DrawTextsAdvanced.applyTransformationOnCanvasFromPoints(m,n,o,f,e,g);context.beginPath();context.moveTo(m.x+4,m.y+2);context.lineTo(n.x+4,n.y-2);context.lineTo(o.x-2,o.y+2);context.clip();context.fillText(b,0,0);context.restore()}};
DrawTextsAdvanced.applyTransformationOnCanvasFromPoints=function(b,d,e,f,g,h){b=MatrixGenerators.createMatrixFromTrianglesMapping(b,d,e,f,g,h);context.transform(b.a,b.b,b.c,b.d,b.tx,b.ty)};
DrawTextsAdvanced.mapRectangleIntoQuadrilater=function(b,d,e,f,g,h,k,l,m){context.save();k=MatrixGenerators.createMatrixFromTrianglesMapping(new Point(0,0),new Point(100,0),new Point(100,100),h,k,l);context.transform(k.a,k.b,k.c,k.d,k.tx,k.ty);context.beginPath();context.moveTo(0,0);context.lineTo(100,0);context.lineTo(100,100);context.lineTo(0,0);context.clip();context.drawImage(b,d,e,f,g,0,0,100,100);context.restore();context.save();k=MatrixGenerators.createMatrixFromTrianglesMapping(new Point(0,
0),new Point(0,2),new Point(2,2),h,m,l);context.transform(k.a,k.b,k.c,k.d,k.tx,k.ty);context.beginPath();context.moveTo(0,0);context.lineTo(0,2);context.lineTo(2,2);context.lineTo(0,0);context.clip();context.drawImage(b,d,e,f,g,0,0,2,2);context.restore()};
DrawTextsAdvanced.getClippedTrianglesData=function(b,d,e,f,g){var h={};context.clearRect(0,0,f,g);context.save();context.beginPath();context.moveTo(0,0);context.lineTo(f,0);context.lineTo(f,g);context.lineTo(0,0);context.clip();context.drawImage(b,d,e,f,g,0,0,f,g);h.dataTriangle0=context.getImageData(0,0,f,g);context.restore();context.clearRect(0,0,f,g);context.save();context.beginPath();context.moveTo(0,0);context.lineTo(0,g);context.lineTo(f,g);context.lineTo(0,0);context.clip();context.drawImage(b,
d,e,f,g,0,0,f,g);h.dataTriangle1=context.getImageData(0,0,f,g);context.restore();return h};
DrawTextsAdvanced.typodeOnQuadrilater=function(b,d,e,f,g){var h=e.x-d.x,g=g.y-d.y,f=f.y-e.y;context.lineWidth=0.01+(g+f)/100;if(!(h<1.8))for(var b=typodeObject[b],k,l,m,n,o=0;b[o]!=null;o++){k=b[o];context.beginPath();m=k[0].x;n=1-m;context.moveTo(Math.floor(m*h+d.x)+0.5,Math.floor(k[0].y*(n*g+m*f)+n*d.y+m*e.y)+0.5);for(l=1;k[l]!=null;l++)m=k[l].x,n=1-m,context.lineTo(Math.floor(m*h+d.x)+0.5,Math.floor(k[l].y*(n*g+m*f)+n*d.y+m*e.y)+0.5);context.stroke()}};
fRect=function(b,d,e,f){if(typeof b!="number")d=b.y,e=b.width,f=b.height,b=b.x;context.fillRect(b,d,e,f)};sRect=function(b,d,e,f){if(typeof b!="number")d=b.y,e=b.width,f=b.height,b=b.x;context.strokeRect(b,d,e,f)};fsRect=function(b,d,e,f){if(typeof b!="number")d=b.y,e=b.width,f=b.height,b=b.x;context.fillRect(b,d,e,f);context.strokeRect(b,d,e,f)};fCircle=function(b,d,e){context.beginPath();context.arc(b,d,e,0,TwoPi);context.fill()};
sCircle=function(b,d,e){context.beginPath();context.arc(b,d,e,0,TwoPi);context.stroke()};fsCircle=function(b,d,e){context.beginPath();context.arc(b,d,e,0,TwoPi);context.fill();context.stroke()};
fEllipse=function(b,d,e,f){var g=e*0.5522848,h=f*0.5522848,k=b+e,l=d+f;context.beginPath();context.moveTo(b-e,d);context.bezierCurveTo(b-e,d-h,b-g,d-f,b,d-f);context.bezierCurveTo(b+g,d-f,k,d-h,k,d);context.bezierCurveTo(k,d+h,b+g,l,b,l);context.bezierCurveTo(b-g,l,b-e,d+h,b-e,d);context.moveTo(b-e,d);context.closePath();context.fill()};
sEllipse=function(b,d,e,f){var g=e*0.5522848,h=f*0.5522848,k=b+e,l=d+f;context.beginPath();context.moveTo(b-e,d);context.bezierCurveTo(b-e,d-h,b-g,d-f,b,d-f);context.bezierCurveTo(b+g,d-f,k,d-h,k,d);context.bezierCurveTo(k,d+h,b+g,l,b,l);context.bezierCurveTo(b-g,l,b-e,d+h,b-e,d);context.moveTo(b-e,d);context.closePath();context.stroke()};
fsEllipse=function(b,d,e,f){var g=e*0.5522848,h=f*0.5522848,k=b+e,l=d+f;context.beginPath();context.moveTo(b-e,d);context.bezierCurveTo(b-e,d-h,b-g,d-f,b,d-f);context.bezierCurveTo(b+g,d-f,k,d-h,k,d);context.bezierCurveTo(k,d+h,b+g,l,b,l);context.bezierCurveTo(b-g,l,b-e,d+h,b-e,d);context.moveTo(b-e,d);context.closePath();context.fill();context.stroke()};line=function(b,d,e,f){context.beginPath();context.moveTo(b,d);context.lineTo(e,f);context.stroke()};
bezier=function(b,d,e,f,g,h,k,l){context.beginPath();context.moveTo(b,d);context.bezierCurveTo(e,f,g,h,k,l);context.stroke()};_lines=function(){if(arguments!=null){arguments=arguments[0];context.beginPath();context.moveTo(arguments[0],arguments[1]);for(var b=2;arguments[b+1]!=null;b+=2)context.lineTo(arguments[b],arguments[b+1])}};
_linesM=function(){if(arguments!=null){arguments=arguments[0];var b=new Polygon;context.beginPath();context.moveTo(arguments[0],arguments[1]);b[0]=new Point(arguments[0],arguments[1]);for(var d=2;arguments[d+1]!=null;d+=2)context.lineTo(arguments[d],arguments[d+1]),b.push(new Point(arguments[d],arguments[d+1]));return b.containsPoint(mP)}};fLines=function(){_lines(arguments);context.fill()};sLines=function(){_lines(arguments);context.stroke()};fsLines=function(){_lines(arguments);context.fill();context.stroke()};
fsLinesM=function(){var b=_linesM(arguments);context.fill();context.stroke();return b};_polygon=function(b){context.beginPath();context.moveTo(b[0].x,b[0].y);for(var d=1;b[d]!=null;d++)context.lineTo(b[d].x,b[d].y)};fPolygon=function(b){_polygon(b);context.fill()};sPolygon=function(b,d){_polygon(b);d&&context.closePath();context.stroke()};fsPolygon=function(b,d){_polygon(b);d&&context.closePath();context.fill();context.stroke()};fEqTriangle=function(b,d,e,f){_eqTriangle(b,d,e,f);context.fill()};
sEqTriangle=function(b,d,e,f){_eqTriangle(b,d,e,f);context.stroke()};fsEqTriangle=function(b,d,e,f){_eqTriangle(b,d,e,f);context.fill();context.stroke()};_eqTriangle=function(b,d,e,f){context.beginPath();e=e||0;context.moveTo(f*Math.cos(e)+b,f*Math.sin(e)+d);context.lineTo(f*Math.cos(e+2.0944)+b,f*Math.sin(e+2.0944)+d);context.lineTo(f*Math.cos(e+4.1888)+b,f*Math.sin(e+4.1888)+d);context.lineTo(f*Math.cos(e)+b,f*Math.sin(e)+d)};
fRectM=function(b,d,e,f,g){g=g==null?0:g;context.fillRect(b,d,e,f);return mY>d-g&&mY<d+f+g&&mX>b-g&&mX<b+e+g};sRectM=function(b,d,e,f,g){g=g==null?0:g;context.strokeRect(b,d,e,f);return mY>d-g&&mY<d+f+g&&mX>b-g&&mX<b+e+g};fsRectM=function(b,d,e,f,g){g=g==null?0:g;context.fillRect(b,d,e,f);context.strokeRect(b,d,e,f);return mY>d-g&&mY<d+f+g&&mX>b-g&&mX<b+e+g};
fCircleM=function(b,d,e,f){f=f==null?0:f;context.beginPath();context.arc(b,d,e,0,TwoPi);context.fill();return Math.pow(b-mX,2)+Math.pow(d-mY,2)<Math.pow(e+f,2)};sCircleM=function(b,d,e,f){f=f==null?0:f;context.beginPath();context.arc(b,d,e,0,TwoPi);context.stroke();return Math.pow(b-mX,2)+Math.pow(d-mY,2)<Math.pow(e+f,2)};fsCircleM=function(b,d,e,f){f=f==null?0:f;context.beginPath();context.arc(b,d,e,0,TwoPi);context.stroke();context.fill();return Math.pow(b-mX,2)+Math.pow(d-mY,2)<Math.pow(e+f,2)};
lineM=function(b,d,e,f,g){g=g||4;context.beginPath();context.moveTo(b,d);context.lineTo(e,f);context.stroke();return _distToSegmentSquared(b,d,e,f)<g*g};_distToSegmentSquared=function(b,d,e,f){var g=Math.pow(b-e,2)+Math.pow(d-f,2);if(g===0)return Math.pow(b-mX,2)+Math.pow(d-mY,2);g=((mX-b)*(e-b)+(mY-d)*(f-d))/g;return g<=0?Math.pow(b-mX,2)+Math.pow(d-mY,2):g>=1?Math.pow(e-mX,2)+Math.pow(f-mY,2):Math.pow(b+g*(e-b)-mX,2)+Math.pow(d+g*(f-d)-mY,2)};
bezierM=function(b,d,e,f,g,h,k,l,m){m=m==null?2:m;context.beginPath();context.moveTo(b,d);context.bezierCurveTo(e,f,g,h,k,l);context.stroke();return GeometryOperators.distanceToBezierCurve(b,d,e,f,g,h,k,l,mP,!1)<m};
drawImage=function(b){switch(arguments.length){case 3:context.drawImage(b,arguments[1],arguments[2]);break;case 5:context.drawImage(b,arguments[1],arguments[2],arguments[3],arguments[4]);break;case 9:context.drawImage(b,arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8])}};
setFill=function(b){context.fillStyle=typeof b=="number"?arguments.length>3?"rgba("+arguments[0]+","+arguments[1]+","+arguments[2]+","+arguments[3]+")":"rgb("+arguments[0]+","+arguments[1]+","+arguments[2]+")":b};setStroke=function(b,d){if(typeof b=="number")context.strokeStyle=arguments.length>3?"rgba("+arguments[0]+","+arguments[1]+","+arguments[2]+","+arguments[3]+")":"rgb("+arguments[0]+","+arguments[1]+","+arguments[2]+")";else if(context.strokeStyle=b,d)context.lineWidth=d};
setLW=function(b){context.lineWidth=b};clipCircle=function(b,d,e){context.save();context.beginPath();context.arc(b,d,e,0,TwoPi,!1);context.closePath();context.clip()};clipRectangle=function(b,d,e,f){context.save();context.fillRect(b,d,e,f);context.clip()};restore=function(){context.restore()};fText=function(b,d,e){context.fillText(b,d,e)};sText=function(b,d,e){context.strokeText(b,d,e)};fsText=function(b,d,e){context.strokeText(b,d,e);context.fillText(b,d,e)};
fTextRotated=function(b,d,e,f){context.save();context.translate(d,e);context.rotate(f);context.fillText(b,0,0);context.restore()};fTextM=function(b,d,e,f){f=f||12;context.fillText(b,d,e);return mY>e&&mY<e+f&&mX>d&&mX<d+context.measureText(b).width};fsTextM=function(b,d,e,f){f=f||12;context.strokeText(b,d,e);context.fillText(b,d,e);return mY>e&&mY<e+f&&mX>d&&mX<d+context.measureText(b).width};
fTextRotatedM=function(b,d,e,f,g){g=g||12;context.save();context.translate(d,e);context.rotate(f);context.fillText(b,0,0);context.restore();var h=mX-d,k=mY-e,l=Math.sqrt(h*h+k*k),h=Math.atan2(k,h)-f,f=d+l*Math.cos(h),l=e+l*Math.sin(h);return l>e&&l<e+g&&f>d&&f<d+context.measureText(b).width};fTextW=function(b,d,e){context.fillText(b,d,e);return context.measureText(b).width};
setText=function(b,d,e,f,g,h){h=h==null?"":h;h!=""&&(h+=" ");context.fillStyle=b||"#000000";context.font=h+(String(d)||"14")+"px "+(e||LOADED_FONT);context.textAlign=f==null?"left":f;context.textBaseline=g==null?"top":g};getTextW=function(b){return context.measureText(b).width};getPixelData=function(b,d){return context.getImageData(b,d,1,1).data};getPixelColor=function(b,d){var e=context.getImageData(b,d,1,1).data;return"rgba("+e[0]+","+e[1]+","+e[2]+","+e[3]+")"};
getPixelColorRGBA=function(b,d){return context.getImageData(b,d,1,1).data};captureCanvas=function(){var b=new Image;b.src=canvas.toDataURL();return b};drawAndcapture=function(b,d,e,f){var g=context;context=hiddenContext;context.canvas.setAttribute("width",d);context.canvas.setAttribute("height",e);context.clearRect(0,0,d,e);f==null?b.call():b.call(f);b=new Image;b.src=context.canvas.toDataURL();context=g;return b};setCursor=function(b){canvas.style.cursor=b==null?"default":b};
getMilliseconds=function(){var b=new Date;_ms=b.getTime();delete b;return _ms};DragDetection.prototype.constructor=DragDetection;
function DragDetection(b){this.mode=b.mode||0;this.listenerFunction=b.listenerFunction;this.target=b.target;this.areaVerificationFunction=b.areaVerificationFunction;this.factor=b.factor==null?1:b.factor;this.center=new Point(0,0);addInteractionEventListener("mousedown",this.onMouse,this);addInteractionEventListener("mouseup",this.onMouse,this);this.dragging=!1;this.mouseClickPosition=new Point;this.mousePosition=new Point;this.a=this.r=0;this.dragVector=new Point}
DragDetection.prototype.enterframe=function(b){switch(b.mode){case 0:b.dragVector.x=(mX-b.mousePosition.x)*b.factor;b.dragVector.y=(mY-b.mousePosition.y)*b.factor;b.mousePosition.x=mX;b.mousePosition.y=mY;break;case 1:b.dragVector.x=mX-b.mouseClickPosition.x;b.dragVector.y=mY-b.mouseClickPosition.y;break;case 2:var d=mX-b.center.x,e=mY-b.center.y,f=Math.sqrt(Math.pow(d,2)+Math.pow(e,2)),d=Math.atan2(e,d);b.dragVector.x=f-b.r;b.dragVector.y=d-b.a;b.r=f;b.a=d}b.listenerFunction.call(b.target,b.dragVector)};
DragDetection.prototype.onMouse=function(b){switch(b.type){case "mousedown":if(this.areaVerificationFunction!=null&&!this.areaVerificationFunction.call(this.target))break;this.dragging=!0;this.mouseClickPosition.x=mX;this.mouseClickPosition.y=mY;this.mousePosition.x=mX;this.mousePosition.y=mY;var b=mX-this.center.x,d=mY-this.center.y;this.r=Math.sqrt(Math.pow(b,2)+Math.pow(d,2));this.a=Math.atan2(d,b);this.dragVector.x=0;this.dragVector.y=0;this.idInterval!=null&&clearInterval(this.idInterval);this.idInterval=
setInterval(this.enterframe,30,this);break;case "mouseup":this.simulateMouseUp()}};DragDetection.prototype.simulateMouseUp=function(){this.dragging=!1;clearInterval(this.idInterval);this.idInterval=null};InputTextFieldHTML.prototype.constructor=InputTextFieldHTML;
function InputTextFieldHTML(b){this.id=b.id==null?0:b.id;this.target=b.target;this.x=b.x==null?0:b.x;this.y=b.y==null?0:b.y;this.width=b.width==null?200:b.width;this.height=b.height==null?20:b.height;this.fontSize=b.fontSize==null?16:b.fontSize;this.enterFunction=b.enterFunction;this.changeFunction=b.changeFunction;this.focusFunction=b.focusFunction;this.blurFunction=b.blurFunction;this.text=b.text;this.textarea=b.textarea==null?!0:b.textarea;this.readOnly=b.readOnly==null?!1:b.readOnly;this.border=
b.border==null?!0:b.border;this.password=b.password;this.zIndex=30;this.textColor="black";this.backgroundColor="#FFFFFF";this.main=document.getElementById("maindiv");this.div=document.createElement("div2");this.textarea?this.DOMtext=document.createElement("textarea"):this.DOMtext=document.createElement("input");this.password?this.DOMtext.setAttribute("type","password"):this.DOMtext.setAttribute("type","text");this.div.setAttribute("style","position:absolute;top:"+this.y+"px;left:"+this.x+"px;z-index:"+
this.zIndex+";");this.border||this.DOMtext.setAttribute("style","border:none");this.div.setAttribute("rows","1");this.main.appendChild(this.div);this.div.appendChild(this.DOMtext);this.DOMtext.parent=this;this.added=!0;this.DOMtext.readOnly=this.readOnly;this.DOMtext.onfocus=function(b){b.target=this.parent;this.parent._onFocus(this.parent)};this.DOMtext.onblur=function(b){b.target=this.parent;this.parent._onBlur(this.parent)};this.DOMtext.value="";addInteractionEventListener("keydown",this.onKeyDown,
this);this.focus=!1;this.changeFunction!=null&&this.setChangeFunction(this.changeFunction,this.target);this.enterFunction!=null&&this.setEnterFunction(this.enterFunction,this.target);this.focusFunction!=null&&this.setFocusFunction(this.focusFunction,this.target);this.blurFunction!=null&&this.setBlurFunction(this.blurFunction,this.target);this.text!=null?this.setText(this.text):this.draw();this.DOMtext.addEventListener("mousemove",_onMouse,!1);_cycleOnMouseMovement&&this.DOMtext.addEventListener("mousemove",
onMoveCycle,!1)}InputTextFieldHTML.prototype.setBorder=function(b){this.border=b;this.DOMtext.setAttribute("style","color: "+this.textColor+"; width:"+(this.width-7)+"px;height:"+(this.height-7)+"px; font-size:"+this.fontSize+"px; border:"+(b?"yes":"none"))};
InputTextFieldHTML.prototype.draw=function(){if(this.x!=this._prevX||this.y!=this._prevY||this.width!=this._prevWidth||this.height!=this._prevHeight||this.text!=this._prevText)this._prevX=this.x,this._prevY=this.y,this._prevWidth=this.width,this._prevHeight=this.height,this._prevText=this.text,this.DOMtext.style="none",this.DOMtext.style.padding="0px",this.DOMtext.style.border="0px",this.DOMtext.style.borderColor="#FFFFFF",this.DOMtext.style.background="transparent",this.DOMtext.style.resize="none",
this.DOMtext.setAttribute("style","color: "+this.textColor+"; width:"+(this.width-7)+"px;height:"+(this.height-7)+"px; font-size:"+this.fontSize+"px"),this.div.setAttribute("style","position:absolute;top:"+this.y+"px;left:"+this.x+"px;z-index:"+this.zIndex+";")};InputTextFieldHTML.prototype.setText=function(b){this.DOMtext.value=b;this.draw()};InputTextFieldHTML.prototype.getText=function(){return this.DOMtext.value};InputTextFieldHTML.prototype.getSelectionStart=function(){return this.DOMtext.selectionStart};
InputTextFieldHTML.prototype.onKeyDown=function(b){this._eKeyDown=b;this._keyCode=b.keyCode;this.timer=setTimeout(this.onKeyDownDelayed,4,this)};
InputTextFieldHTML.prototype.onKeyDownDelayed=function(b){b._keyCode==13&&b.enterFunction!=null&&b.enterFunction.call(b.enterFunctionTarget,b.id);if(b.text!=b.DOMtext.value)b.text=b.DOMtext.value,b.text.charAt(b.text.length-1),b._keyCode!=13&&b.changeFunction!=null&&b.changeFunction.call(b.changeFunctionTarget,b.id);_cycleOnMouseMovement&&reStartCycle();this.timer=null};InputTextFieldHTML.prototype.forceFocus=function(){this.DOMtext.focus();this.focus=!0};
InputTextFieldHTML.prototype.forceUnfocus=function(){c.log("[!] use InputTextFieldHTML.prototype.forceBlur instead");a.push(0)};InputTextFieldHTML.prototype.forceBlur=function(){this.DOMtext.blur();this.focus=!1};InputTextFieldHTML.prototype.setEnterFunction=function(b,d){this.enterFunction=b;this.enterFunctionTarget=d};InputTextFieldHTML.prototype.setChangeFunction=function(b,d){this.changeFunction=b;this.changeFunctionTarget=d};
InputTextFieldHTML.prototype.setFocusFunction=function(b,d){this.focusFunction=b;this.focusFunctionTarget=d};InputTextFieldHTML.prototype.setBlurFunction=function(b,d){this.blurFunction=b;this.blurFunctionTarget=d};InputTextFieldHTML.prototype.setSelection=function(b,d){d=d==null?this.DOMtext.value.length:d;this.DOMtext.selectionStart=b==null?0:b;this.DOMtext.selectionEnd=d};InputTextFieldHTML.prototype.placeCursor=function(b){this.setSelection(b)};
InputTextFieldHTML.prototype.setScrollPosition=function(b){b<=1&&(b=Math.floor(b*this.DOMtext.scrollHeight));this.DOMtext.scrollTop=b};InputTextFieldHTML.prototype.getScrollPosition=function(){return this.DOMtext.scrollTop};InputTextFieldHTML.prototype.getTextHeight=function(){return this.DOMtext.scrollHeight};InputTextFieldHTML.prototype._onFocus=function(b){b.focus=!0;b.focusFunction!=null&&b.focusFunction.call(b.focusFunctionTarget,b.id)};
InputTextFieldHTML.prototype._onBlur=function(b){b.focus=!1;b.blurFunction!=null&&b.blurFunction.call(b.blurFunctionTarget,b.id)};InputTextFieldHTML.prototype.remove=function(){if(this.added)this.div.removeChild(this.DOMtext),this.main.removeChild(this.div),this.added=!1};InputTextFieldHTML.prototype.readd=function(){if(!this.added)this.main.appendChild(this.div),this.div.appendChild(this.DOMtext),this.added=!0};
InputTextFieldHTML.prototype.disappear=function(){c.log("[!] InputTextFieldHTML.prototype.disappear replaced by remove");a.push(0);this.x=-1E4;this.draw()};TextBox.prototype.constructor=TextBox;
function TextBox(b){b=b==null?{}:b;this.x=b.x==null?300:b.x;this.y=b.y==null?2:b.y;this.width=b.width==null?200:b.width;this.text=b.text==null?"":b.text;this.fontColor=b.fontColor==null?"black":b.fontColor;this.fontSize=b.fontSize==null?"14":b.fontSize;this.fontName=b.fontName==null?LOADED_FONT:b.fontName;this.warnFunction=b.warnFunction;this.target=b.target;this.lineHeight=b.lineHeight==null?14:b.lineHeight;this.backgroundColor=b.backgroundColor;this.boxMargin=b.boxMargin==null?5:b.boxMargin;this.lineWidth=
b.lineWidth==null?1:b.lineWidth;this.setText(this.text);addInteractionEventListener("mouseup",this.mouseUp,this)}TextBox.prototype.getMaxWidth=function(){return DrawTexts.getMaxTextWidth(this.lines)};TextBox.prototype.update=function(){this.setText(this.text)};
TextBox.prototype.setText=function(b){this.text=String(b);this.text=TextBox.replaceWikiLinks(this.text);var d,e=this.text.split("<e");if(e.length>1){var f,g;this.links=new StringList;this.linksType=new StringList;var h=new List,k;for(d=1;e[d]!=null;d++)if(f=e[d].indexOf("*"),g=e[d].indexOf(">"),b=e[d].indexOf("*",f+1),f!=-1&&g!=-1&&f<g){k=e[d].substr(0,f);this.links.push(k);b!=-1&&b<g&&!e[d].charAt(b+1)=="b"?(e[d].charAt(b+1),e[d]=e[d].substring(f+1,b)+e[d].substr(g+1),this.linksType.push("self")):
(b=e[d].substring(f+1,g),k=e[d].substr(g+1),e[d]=b+k,this.linksType.push("blank"));k=e[d-1].length;k-=1*(e[d-1].split("\\n").length-1);for(b=0;b<d-1;b++)k+=e[b].length,k-=1*(e[b].split("\\n").length-1);h.push(new Interval(k,g-f-1))}this.text=e.join("")}else this.pointPairs=this.links=null;setText(this.fontColor,this.fontSize,this.fontName,null,null,this.fontStyle);this.lines=DrawTexts.textWordWrapReturnLines(this.text,this.width,0,this.lineHeight);this.height=this.lines.length*this.lineHeight;if(this.links!=
null){g=0;this.pointPairs=[];for(d=0;this.links[d]!=null;d++){f=h[d];for(b=g=0;this.lines[b]!=null;b++){k=this.lines[b];if(f.x>=g&&f.x<g+k.length){e=context.measureText(k.substr(0,f.x-g)).width;f=context.measureText(k.substr(0,f.x+f.y-g)).width;b=b*this.lineHeight+0.5;this.pointPairs.push({x0:e,x1:f,y:b});break}g+=k.length+1}}}for(b=g=0;this.lines[b]!=null;b++)k=this.lines[b],g+=k.length+1;setText(this.fontColor,this.fontSize,this.fontName,null,null,this.fontStyle);for(d=this.maxWidth=0;this.lines[d]!=
null;d++)this.maxWidth=Math.max(this.maxWidth,context.measureText(this.lines[d]).width)};
TextBox.prototype.draw=function(b){b=b==null?1:b;if(this.backgroundColor!=null)context.fillStyle=this.backgroundColor,context.fillRect(this.x-this.boxMargin,this.y-this.boxMargin,this.width+2*this.boxMargin,this.height+2*this.boxMargin);setText(this.fontColor,this.fontSize*b,this.fontName,null,null,this.fontStyle);DrawTexts.fillTextRectangleWithTextLines(this.lines,this.x,this.y,0,this.lineHeight*b);var d,e,f,g;this.overLink=null;if(this.pointPairs!=null){context.lineWidth=this.lineWidth;context.strokeStyle=
this.fontColor;for(var h=0;this.pointPairs[h]!=null;h++)if(d=this.pointPairs[h].x0*b+this.x,e=this.pointPairs[h].x1*b+this.x,f=this.pointPairs[h].y*b+this.y,g=Math.floor(f+Number(this.fontSize*b)),this.line(d,e,g+0.5),mY>f&&mY<g&&mX>d&&mX<e)context.canvas.style.cursor="pointer",this.overLink=h}};TextBox.prototype.line=function(b,d,e){context.beginPath();context.moveTo(b,e);context.lineTo(d,e);context.stroke()};
TextBox.prototype.mouseUp=function(){if(this.overLink!=null){var b=this.links[this.overLink],d=this.linksType[this.overLink];b.substr(0,7)=="http://"||b.substr(0,8)=="https://"||b.substr(0,4)=="www."?d=="blank"?window.open(b):window.open(b,"_self"):this.warnFunction.call(this.target,b);this.overLink=null}};TextBox.prototype.deactivate=function(){removeInteractionEventListener("mouseup",this.mouseUp,this)};
TextBox.replaceWikiLinks=function(b){for(var d=b.indexOf("["),e,f,g,h;d!=-1;)e=b.indexOf("]",d+1),e==-1?d=-1:(f=b.substring(d+1,e),c.log("text inside brackets: {"+f+"}"),f.indexOf("[")==-1&&f.indexOf("]")==-1&&(f.indexOf(" ")!=-1&&(g=f.split(" "),StringOperators.validateUrl(g[0])&&(b=b.substr(0,d)+"<e"+g[0]+"*"+g.slice(1).join(" ")+">"+b.substr(e+1),h=!0)),h||(b=b.substr(0,d)+"<e"+f+"*"+f+">"+b.substr(e+1))),d=b.indexOf("[",e));return b};TextFieldHTML.prototype.constructor=TextFieldHTML;
function TextFieldHTML(b){b=b==null?{}:b;this.x=b.x==null?300:b.x;this.y=b.y==null?2:b.y;this.width=b.width==null?200:b.width;this.textColor=b.textColor==null?"black":b.textColor;this.backgroundColor=b.backgroundColor;this.linkFunction=b.linkFunction;this.target=b.target;this.fastHTMLactive=b.fastHTMLactive==null?!0:b.fastHTMLactive;this.zIndex=33;this.main=document.getElementById("maindiv");this.div=document.createElement("div2");this.div.setAttribute("style","position:absolute;top:"+this.y+"px;left:"+
this.x+"px;z-index:"+this.zIndex+";");this.main.appendChild(this.div);this.setText(b.text==null?"":b.text);this.draw();if(this.target!=null&&this.linkFunction!=null)FastHtml.target=this.target,FastHtml.linkFunction=this.linkFunction}
TextFieldHTML.prototype.draw=function(){if(this.x!=this._prevX||this.y!=this._prevY||this.width!=this._prevWidth||this.height!=this._prevHeight)this._prevX=this.x,this._prevY=this.y,this._prevWidth=this.width,this._prevHeight=this.height,this.div.setAttribute("style","position:absolute;top:"+this.y+"px;left:"+this.x+"px;z-index:"+this.zIndex+"; width:"+this.width+"px; height:"+this.height+"px;")};
TextFieldHTML.prototype.setText=function(b){if(this.text!=b)this.text=b,this.div.innerHTML=this.fastHTMLactive?FastHtml.expand(b):b};TextFieldHTML.prototype.getText=function(){return this.DOMtext.value};var Loader=new function(){};Loader.proxy="";Loader.cacheActive=!1;Loader.associativeByUrls={};Loader.REPORT_LOADING=!1;Loader.n_loading=0;Loader.LOCAL_STORAGE_ENABLED=!1;function LoaderRequest(b,d,e){this.url=b;this.method=d?d:"GET";this.data=e}
Loader.loadImage=function(b,d,e){Loader.n_loading++;Loader.REPORT_LOADING&&c.log("Loader.loadImage | url:",b);var f=e?e:arguments.callee,g=document.createElement("img");if(this.cacheActive)if(this.associativeByUrls[b]!=null){Loader.n_loading--;var h=new LoadEvent;h.result=this.associativeByUrls[b];h.url=b;d.call(f,h)}else var k=!0,l=this.associativeByUrls;g.onload=function(){Loader.n_loading--;var e=new LoadEvent;e.result=g;e.url=b;k&&(l[b]=g);d.call(f,e)};g.onerror=function(){Loader.n_loading--;
var e=new LoadEvent;e.result=null;e.errorType=1;e.errorMessage="There was a problem retrieving the image ["+g.src+"]:";e.url=b;d.call(f,e)};g.src=Loader.proxy+b};Loader.loadJSON=function(b,d){Loader.n_loading++;Loader.loadData(b,function(b){Loader.n_loading--;d.call(arguments.callee,jQuery.parseJSON(b))})};Loader.callIndex=0;
Loader.loadJSONP=function(b,d,e){Loader.n_loading++;Loader.callIndex+=1;var f=Loader.callIndex,g=e?e:arguments.callee;$.ajax({url:b+"&callback=JSONcallback"+f,type:"GET",data:{},dataType:"jsonp",contentType:"application/json",jsonp:"jsonp",jsonpCallback:"JSONcallback"+f,success:function(b){Loader.n_loading--;var e=new LoadEvent;e.result=b;d.call(g,e)},error:function(b){Loader.n_loading--;c.log("Loader.loadJSONP | error, data:",b);b=new LoadEvent;b.errorType=1;d.call(g,b)}})};
Loader.loadData=function(b,d,e,f,g){Loader.REPORT_LOADING&&c.log("load data:",b);Loader.n_loading++;if(Loader.LOCAL_STORAGE_ENABLED){var h=LolacStorage.getItme(b);if(h){var k=new LoadEvent;k.url=b;k.param=f;k.result=h;d.call(m,k)}}Loader.REPORT_LOADING&&c.log("Loader.loadData | url:",b);var h=String(b).substr(0,4)=="http",l=new XMLHttpRequest,m=e?e:arguments.callee,k=function(){Loader.REPORT_LOADING&&c.log("Loader.loadData | onLoadComplete");if(l.readyState==4){Loader.n_loading--;var e=new LoadEvent;
e.url=b;e.param=f;l.status==200||l.status==0&&l.responseText!=null?e.result=l.responseText:(Loader.REPORT_LOADING&&c.log("[!] There was a problem retrieving the data ["+l.status+"]:\n"+l.statusText),e.errorType=l.status,e.errorMessage="[!] There was a problem retrieving the data ["+l.status+"]:"+l.statusText);d.call(m,e)}};if(window.XMLHttpRequest&&!window.ActiveXObject)try{l=new XMLHttpRequest}catch(n){l=!1}else if(window.ActiveXObject)try{l=new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(o){try{l=
new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(q){try{l=new ActiveXObject("Msxml2.XMLHTTP")}catch(s){try{l=new ActiveXObject("Microsoft.XMLHTTP")}catch(u){l=!1}}}}if(l)l.onreadystatechange=k,h?l.open("GET",Loader.proxy+b,!0):l.open("GET",b,!0),l.send(g||"")};
Loader.loadXML=function(b,d){function e(){Loader.n_loading--;f.readyState==4&&(f.status==200||f.status==0?g(f.responseXML):c.log("There was a problem retrieving the XML data:\n"+f.statusText))}Loader.n_loading++;var f=new XMLHttpRequest,g=d;Loader.REPORT_LOADING&&c.log("loadXML, url:",b);if(window.XMLHttpRequest&&!window.ActiveXObject)try{f=new XMLHttpRequest}catch(h){f=!1}else if(window.ActiveXObject)try{f=new ActiveXObject("Msxml2.XMLHTTP")}catch(k){try{f=new ActiveXObject("Microsoft.XMLHTTP")}catch(l){f=
!1}}if(f)f.onreadystatechange=e,f.open("GET",b,!0),f.send("")};Loader.sendContentToVariableToPhp=function(b,d,e,f,g,h){d=d+"="+encodeURIComponent(e);Loader.sendDataToPhp(b,d,f,g,h)};Loader.sendContentsToVariablesToPhp=function(b,d,e,f,g,h){for(var k=d[0]+"="+encodeURIComponent(e[0]),l=1;d[l]!=null;l++)k+="&"+d[l]+"="+encodeURIComponent(e[l]);Loader.sendDataToPhp(b,k,f,g,h)};
Loader.sendDataToPhp=function(b,d,e,f,g){var h=new XMLHttpRequest;h.open("POST",b,!0);h.setRequestHeader("Content-type","application/x-www-form-urlencoded");h.send(d);var k=f?f:arguments.callee;h.onreadystatechange=function(){Loader.REPORT_LOADING&&c.log("Loader.loadData | onLoadComplete, req.responseText:",h.responseText);if(h.readyState==4){Loader.n_loading--;var d=new LoadEvent;d.url=b;d.param=g;h.status==200||h.status==0&&h.responseText!=null?d.result=h.responseText:(Loader.REPORT_LOADING&&c.log("[!] There was a problem retrieving the data ["+
h.status+"]:\n"+h.statusText),d.errorType=h.status,d.errorMessage="[!] There was a problem retrieving the data ["+h.status+"]:"+h.statusText);e.call(k,d)}}};LoadEvent.prototype={};LoadEvent.prototype.constructor=LoadEvent;function LoadEvent(){Object.apply(this);this.result=null;this.errorType=0;this.errorMessage=""}MultiLoader.prototype={};MultiLoader.prototype.constructor=MultiLoader;
function MultiLoader(){this.onComplete=this.urlList=null;this.iLoaded=0;this.target=null;this.loading=!1;this.imagesLoaded=this.datasLoaded=null;this.associativeArray=[];this.url_to_image={};this.simulateDelay=!1;this.DELAY_MILLISECONDS=1E3}MultiLoader.prototype.loadDatas=function(b,d,e){this.urlList=b;this.target=e?e:arguments.callee;this.onComplete=d;this.datasLoaded=new List;this.nextDataLoading()};
MultiLoader.prototype.nextDataLoading=function(){this.iLoaded<this.urlList.length?(this.indexLoading=this.iLoaded,Loader.loadData(this.urlList[this.indexLoading],this.onCompleteLoadData,this),this.loading=!0):this.loading=!1};
MultiLoader.prototype.onCompleteLoadData=function(b){this.priorityWeights!=null?this.datasLoaded[this.urlList.indexOf(b.url)]=b.result:this.datasLoaded.push(b.result);this.associativeArray[this.indexLoading]=b.result;var d=new LoadEvent;d.errorType=b.errorType;d.result=this.datasLoaded;d.url=b.url;if(this.iLoaded+1>=this.urlList.length)this.loading=!1;this.onComplete.call(this.target,d);this.iLoaded++;this.nextDataLoading()};
MultiLoader.prototype.loadImages=function(b,d,e,f){this.urlList=b;this.target=e?e:arguments.callee;this.onComplete=d;this.priorityWeights=f;this.imagesLoaded=new List;this.nextImageLoading()};
MultiLoader.prototype.onCompleteLoadImage=function(b){b.errorType==1?(this.priorityWeights!=null?this.imagesLoaded[this.indexLoading]=null:this.imagesLoaded.push(null),this.associativeArray[this.indexLoading]=-1):(this.priorityWeights!=null?this.imagesLoaded[this.indexLoading]=b.result:this.imagesLoaded.push(b.result),this.associativeArray[this.indexLoading]=b.url,this.url_to_image[b.url]=b.result);var d=new LoadEvent;d.result=this.imagesLoaded;d.url=b.url;d.lastImage=b.result;d.indexImage=this.indexLoading;
this.onComplete!=null&&this.onComplete.call(this.target,d);this.loading=!1;this.iLoaded++;this.nextImageLoading()};MultiLoader.prototype.getImageFromUrl=function(b){return this.url_to_image[b]};MultiLoader.prototype.setPriorityWeights=function(b){this.priorityWeights=b;this.loading||this.nextImageLoading()};
MultiLoader.prototype.nextImageLoading=function(b){if(this.simulateDelay||b!=null)b==null?(this.loading=!0,this.timer=setTimeout(this.nextImageLoading,this.DELAY_MILLISECONDS,this)):(b.loading=!1,b.simulateDelay=!1,b.nextImageLoading(),b.simulateDelay=!0);else if(this.iLoaded<this.urlList.length)if(this.priorityWeights!=null){var d,b=-99999999,e;for(e=0;this.urlList[e]!=null;e++)this.priorityWeights[e]>b&&this.associativeArray[e]==null&&(b=this.priorityWeights[e],d=e);if(b>0)this.indexLoading=d,Loader.loadImage(this.urlList[this.indexLoading],
this.onCompleteLoadImage,this),this.loading=!0}else this.indexLoading=this.iLoaded,Loader.loadImage(this.urlList[this.indexLoading],this.onCompleteLoadImage,this),this.loading=!0;else this.loading=!1};MultiLoader.prototype.destroy=function(){delete this.datasLoaded;delete this.imagesLoaded};
function Forces(b){this.k=b.k?b.k:0.01;this.dEqSprings=b.dEqSprings?b.dEqSprings:100;this.dEqRepulsors=b.dEqRepulsors?b.dEqRepulsors:500;this.friction=b.friction?b.friction:0.8;this.nodeList=new NodeList;this.forcesList=new List;this.equilibriumDistances=new NumberList;this.forcesTypeList=new List;this.fromNodeList=new NodeList;this.toNodeList=new NodeList;this._i0=0}
Forces.prototype.forcesForNetwork=function(b,d,e,f,g){d=d||0;e=e||new Point(0,0);f=f==null?0:f;g=g==null?!1:g;this.forcesList=new List;this.equilibriumDistances=new NumberList;this.forcesTypeList=new List;this.fromNodeList=new NodeList;this.toNodeList=new NodeList;var h=b.nodeList.length,k,l,m=b.relationList;for(k=0;k<h;k++)d==0?this.addNode(b.nodeList[k],new Point(b.nodeList[k].x,b.nodeList[k].y)):(l=Math.random()*TwoPi,this.addNode(b.nodeList[k],new Point(e.x+d*Math.cos(l),e.y+d*Math.sin(l))));
for(k=0;k<h-1;k++){d=b.nodeList[k];for(l=k+1;l<h;l++)if(e=b.nodeList[l],m.nodesAreConnected(d,e)){switch(f){case 0:this.equilibriumDistances.push(this.dEqSprings);break;case 1:this.equilibriumDistances.push((1.1-m.getFirstRelationByIds(d.id,e.id,!1).weight)*this.dEqSprings);break;case 2:this.equilibriumDistances.push(Math.sqrt(Math.min(d.nodeList.length,e.nodeList.length))*this.dEqSprings*0.1)}this.addForce(d,e,"Spring");g&&(this.equilibriumDistances.push(this.dEqRepulsors*0.5),this.addForce(d,e,
"Repulsor"))}else this.equilibriumDistances.push(this.dEqRepulsors),this.addForce(d,e,"Repulsor")}};Forces.prototype.addNode=function(b,d,e){d=d==null?new Point(Math.random()*200-100,Math.random()*200-100):d;e=e==null?new Point(0,0):e;this.nodeList.push(b);b.x=d.x;b.y=d.y;b.vx=e.x;b.vy=e.y;b.ax=0;b.ay=0};Forces.prototype.addForce=function(b,d,e,f){this.fromNodeList.push(b);this.toNodeList.push(d);this.forcesList.push(b.id+"*"+d.id+"*"+e);this.forcesTypeList.push(e);f!=null&&this.equilibriumDistances.push(f)};
Forces.prototype.calculate=function(){var b,d,e,f,g,h,k,l;this._resetAccelerations();for(b=0;this.forcesList[b]!=null;b++)if(d=this.fromNodeList[b],e=this.toNodeList[b],f=this.forcesTypeList[b],g=e.x-d.x,h=e.y-d.y,k=Math.sqrt(Math.pow(g,2)+Math.pow(h,2)),l=this.equilibriumDistances[b],!(f=="Repulsor"&&k>l)&&!(f=="Attractor"&&k<l))switch(f){case "Spring":case "Repulsor":case "Attractor":f=this.k*(k-l)/k;d.ax+=f*g;d.ay+=f*h;e.ax-=f*g;e.ay-=f*h;break;case "DirectedSpring":f=this.k*(k-l)/k;e.ax-=f*g;
e.ay-=f*h;break;case "DirectedRepulsor":k<l&&(f=this.k*(k-l)/k,e.ax-=f*g,e.ay-=f*h)}};Forces.prototype.attractionToPoint=function(b,d,e){var d=d==null?1:d,f,g,h,k;for(i=0;this.nodeList[i]!=null;i++)f=this.nodeList[i],h=b.x-f.x,k=b.y-f.y,g=Math.pow(h,2)+Math.pow(k,2),g=e!=null?Math.min(d/g,e):d/g,f.ax+=g*h,f.ay+=g*k};
Forces.prototype.avoidOverlapping=function(b){var d,e,f,g,h,k,l,m,n,o,q,s,u=(b||0)*0.5,t=this.nodeList.length;c.log(this.nodeList.length);for(b=0;this.nodeList[b+1]!=null;b++){d=this.nodeList[(b+this._i0)%t];f=d.x-d.width*0.5-u;h=d.x+d.width*0.5+u;g=d.y-d.height*0.5-u;k=d.y+d.height*0.5+u;for(j=b+1;this.nodeList[j]!=null;j++)if(e=this.nodeList[(j+this._i0+b)%t],l=e.x-e.width*0.5-u,n=e.x+e.width*0.5+u,m=e.y-e.height*0.5-u,o=e.y+e.height*0.5+u,(f>l&&f<n||h>l&&h<n)&&(g>m&&g<o||k>m&&k<o))q=e.x-d.x,s=
e.y-d.y,Math.abs(q)>Math.abs(s)?q>0?(d.x-=(h-l)*0.5,e.x+=(h-l)*0.5):(d.x+=(n-f)*0.5,e.x-=(n-f)*0.5):s>0?(d.y-=(k-m)*0.5,e.y+=(k-m)*0.5):(d.y+=(o-g)*0.5,e.y-=(o-g)*0.5)}this._i0++};
Forces.prototype.avoidOverlappingRadial=function(b,d){var d=d||1,e,f,g,h=this.nodeList.length,k,l,m,n,o=(b||0)*2;for(e=0;this.nodeList[e+1]!=null;e++){f=this.nodeList[(e+this._i0)%h];for(j=e+1;this.nodeList[j]!=null;j++)g=this.nodeList[(j+this._i0+e)%h],k=g.x-f.x,l=g.y-f.y,m=Math.pow(k,2)+Math.pow(l,2),n=Math.pow(f.r+g.r+o,2),m<n&&(n=Math.sqrt(n),m=Math.sqrt(m),m=0.5*(n-m)/m,f.x-=d*m*k,f.y-=d*m*l,g.x+=d*m*k,g.y+=d*m*l)}this._i0++};
Forces.prototype.applyForces=function(){var b;for(i=0;this.nodeList[i]!=null;i++)b=this.nodeList[i],b.vx+=b.ax,b.vy+=b.ay,b.vx*=this.friction,b.vy*=this.friction,b.x+=b.vx,b.y+=b.vy};Forces.prototype.deactivateForcesFromNode=function(b){b.vx=b.vy=b.ax=b.ay=0};
Forces.prototype.destroy=function(){delete this.k;delete this.dEqSprings;delete this.dEqRepulsors;delete this.friction;this.nodeList.destroy();delete this.nodeList;this.forcesList.destroy();delete this.forcesList;this.equilibriumDistances.destroy();delete this.equilibriumDistances;this.forcesTypeList.destroy();delete this.forcesTypeList;this.fromNodeList.destroy();delete this.fromNodeList;this.toNodeList.destroy();delete this.toNodeList;delete this._i0};
Forces.prototype._resetAccelerations=function(){var b;for(i=0;this.nodeList[i]!=null;i++)b=this.nodeList[i],b.ax=0,b.ay=0};Engine3D.prototype.constructor=Engine3D;function Engine3D(b){b=b==null?{}:b;this.lens=b.lens==null?300:b.lens;this._freeRotation=!1;this.setBasis(new Polygon3D(new Point3D(1,0,0),new Point3D(0,1,0),new Point3D(0,0,1)));this._cuttingPlane=10;b.angles!=null&&this.setAngles(b.angles)}
Engine3D.prototype.setBasis=function(b){this._basis=b.clone();this._basisBase=b.clone();this._provisionalBase=b.clone()};Engine3D.prototype.setAngles=function(b){this._angles=b.clone();this._freeRotation=!1;this._basis=this.basis3DRotation(this._basisBase,this._angles)};
Engine3D.prototype.applyRotation=function(b){if(!this._freeRotation)this._freeRotation=!0,this.updateAngles(),this._provisionalBase[0]=this._basis[0].clone(),this._provisionalBase[1]=this._basis[1].clone(),this._provisionalBase[2]=this._basis[2].clone();this._basis[0]=this.point3DRotation(this._provisionalBase[0],new Point3D(-b.y,b.x,0));this._basis[1]=this.point3DRotation(this._provisionalBase[1],new Point3D(-b.y,b.x,0));this._basis[2]=this.point3DRotation(this._provisionalBase[2],new Point3D(-b.y,
b.x,0));this._provisionalBase[0]=this._basis[0].clone();this._provisionalBase[1]=this._basis[1].clone();this._provisionalBase[2]=this._basis[2].clone()};Engine3D.prototype.projectPoint3D=function(b){var d=this.lens/(this.lens+(this._basis[0].z*b.x+this._basis[1].z*b.y+this._basis[2].z*b.z));return new Point3D((this._basis[0].x*b.x+this._basis[1].x*b.y+this._basis[2].x*b.z)*d,(this._basis[0].y*b.x+this._basis[1].y*b.y+this._basis[2].y*b.z)*d,d)};
Engine3D.prototype.projectCoordinates=function(b,d,e){var f=this.lens/(this.lens+(this._basis[0].z*b+this._basis[1].z*d+this._basis[2].z*e));return new Point3D((this._basis[0].x*b+this._basis[1].x*d+this._basis[2].x*e)*f,(this._basis[0].y*b+this._basis[1].y*d+this._basis[2].y*e)*f,f)};
Engine3D.prototype.projectPoint3DNode=function(b){var d=this.lens/(this.lens+(this._basis[0].z*b.x+this._basis[1].z*b.y+this._basis[2].z*b.z));return new Point3D((this._basis[0].x*b.x+this._basis[1].x*b.y+this._basis[2].x*b.z)*d,(this._basis[0].y*b.x+this._basis[1].y*b.y+this._basis[2].y*b.z)*d,d)};Engine3D.prototype.scale=function(b){return this.lens/(this.lens+(this._basis[0].z*b.x+this._basis[1].z*b.y+this._basis[2].z*b.z))};
Engine3D.prototype.sortedIndexesByPointsScale=function(b){for(var d=[],e=0;b[e]!=null;e++)d[e]=[b[e],e];UTLITARY_GLOBAL_VAR=this._basis;d=d.sort(this._sortingCriteria,this._basis);UTLITARY_GLOBAL_VAR=null;for(var f=new NumberList,e=0;b[e]!=null;e++)f[e]=d[e][1];return f};
Engine3D.prototype.sortListByPointsScale=function(b,d){for(var e=[],f=0;b[f]!=null;f++)e[f]=[d[f],b[f]];UTLITARY_GLOBAL_VAR=this._basis;e=e.sort(this._sortingCriteria,this._basis);UTLITARY_GLOBAL_VAR=null;var g=instantiateWithSameType(b);g.name=b;for(f=0;b[f]!=null;f++)g[f]=e[f][1];return g};
Engine3D.prototype._sortingCriteria=function(b,d){var e=b[0],f=d[0];return UTLITARY_GLOBAL_VAR[0].z*e.x+UTLITARY_GLOBAL_VAR[1].z*e.y+UTLITARY_GLOBAL_VAR[2].z*e.z<UTLITARY_GLOBAL_VAR[0].z*f.x+UTLITARY_GLOBAL_VAR[1].z*f.y+UTLITARY_GLOBAL_VAR[2].z*f.z?1:-1};Engine3D.prototype.updateAngles=function(){this._angles=this.getEulerAngles()};
Engine3D.prototype.getEulerAngles=function(){return new Point3D(Math.atan2(-this._basis[1].z,this._basis[2].z),Math.asin(this._basis[0].z),Math.atan2(-this._basis[0].y,this._basis[0].x))};
Engine3D.prototype.basis3DRotation=function(b,d){ca=Math.cos(d.x);sa=Math.sin(d.x);cb=Math.cos(d.y);sb=Math.sin(d.y);cg=Math.cos(d.z);sg=Math.sin(d.z);return new Polygon3D(new Point3D(b[0].x*cg*cb+b[0].y*(cg*sa*sb+sg*ca)+b[0].z*(sg*sa-cg*ca*sb),-b[0].x*sg*cb+b[0].y*(cg*ca-sg*sa*sb)+b[0].z*(sg*ca*sb+cg*sa),b[0].x*sb-b[0].y*sa*cb+b[0].z*cb*ca),new Point3D(b[1].x*cg*cb+b[1].y*(cg*sa*sb+sg*ca)+b[1].z*(sg*sa-cg*ca*sb),-b[1].x*sg*cb+b[1].y*(cg*ca-sg*sa*sb)+b[1].z*(sg*ca*sb+cg*sa),b[1].x*sb-b[1].y*sa*cb+
b[1].z*cb*ca),new Point3D(b[2].x*cg*cb+b[2].y*(cg*sa*sb+sg*ca)+b[2].z*(sg*sa-cg*ca*sb),-b[2].x*sg*cb+b[2].y*(cg*ca-sg*sa*sb)+b[2].z*(sg*ca*sb+cg*sa),b[2].x*sb-b[2].y*sa*cb+b[2].z*cb*ca))};Engine3D.prototype.point3DRotation=function(b,d){var e=Math.cos(d.x),f=Math.sin(d.x),g=Math.cos(d.y),h=Math.sin(d.y),k=Math.cos(d.z),l=Math.sin(d.z);return new Point3D(b.x*k*g+b.y*(k*f*h+l*e)+b.z*(l*f-k*e*h),-b.x*l*g+b.y*(k*e-l*f*h)+b.z*(l*e*h+k*f),b.x*h-b.y*f*g+b.z*g*e)};
Engine3D.prototype.line3D=function(b,d){var e=new Polygon,f=this.lens/(this.lens+(this._basis[0].z*b.x+this._basis[1].z*b.y+this._basis[2].z*b.z)),g=this.lens/(this.lens+(this._basis[0].z*d.x+this._basis[1].z*d.y+this._basis[2].z*d.z));if(f>0||g>0){if(f>0&&g>0)e.push(new Point((this._basis[0].x*b.x+this._basis[1].x*b.y+this._basis[2].x*b.z)*f,(this._basis[0].y*b.x+this._basis[1].y*b.y+this._basis[2].y*b.z)*f)),e.push(new Point((this._basis[0].x*d.x+this._basis[1].x*d.y+this._basis[2].x*d.z)*g,(this._basis[0].y*
d.x+this._basis[1].y*d.y+this._basis[2].y*d.z)*g));else{var h=new Point3D(this._basis[0].x*b.x+this._basis[1].x*b.y+this._basis[2].x*b.z,this._basis[0].y*b.x+this._basis[1].y*b.y+this._basis[2].y*b.z,this._basis[0].z*b.x+this._basis[1].z*b.y+this._basis[2].z*b.z),k=new Point3D(this._basis[0].x*d.x+this._basis[1].x*d.y+this._basis[2].x*d.z,this._basis[0].y*d.x+this._basis[1].y*d.y+this._basis[2].y*d.z,this._basis[0].z*d.x+this._basis[1].z*d.y+this._basis[2].z*d.z),l=(-this.lens+this._cuttingPlane-
h.z)/(k.z-h.z),l=new Point3D(h.x+l*(k.x-h.x),h.y+l*(k.y-h.y),-this.lens+this._cuttingPlane),m=this.lens/(this.lens+l.z);f>0?(e.push(new Point(h.x*f,h.y*f)),e.push(new Point(l.x*m,l.y*m))):(e.push(new Point(l.x*m,l.y*m)),e.push(new Point(k.x*g,k.y*g)))}return e}return null};
Engine3D.prototype.quadrilater=function(b,d,e,f){var g=new Polygon3D,h=this.line3D(b,d),d=this.line3D(d,e),e=this.line3D(e,f),b=this.line3D(f,b);h!=null&&((b==null||h[0].x!=b[1].x&&h[0].y!=b[1].y)&&g.push(h[0]),g.push(h[1]));d!=null&&((h==null||d[0].x!=h[1].x&&d[0].y!=h[1].y)&&g.push(d[0]),g.push(d[1]));e!=null&&((d==null||e[0].x!=d[1].x&&e[0].y!=d[1].y)&&g.push(e[0]),g.push(e[1]));b!=null&&((e==null||b[0].x!=e[1].x&&b[0].y!=e[1].y)&&g.push(b[0]),g.push(b[1]));return g};
function typeOf(b){var d=typeof b;return d!=="object"?d:b===null?"null":b.getDate!=null?"date":b.getType==null?"Object":b.getType()}function VOID(){}
function instantiate(b,d){switch(b){case "number":case "string":return window[b](d);case "date":if(!d||d.length==0)return new Date;if(d.length==1){if(d[0].match(/\d*.-\d*.-\d*\D\d*.:\d*.:\d*/)){var e=d[0].split(" ");e[0]=e[0].split("-");e[1]=e[1]?e[1].split(":"):[0,0,0];return new Date(Date.UTC(e[0][0],Number(e[0][1])-1,e[0][2],e[1][0],e[1][1],e[1][2]))}return Number(d[0])!="NaN"?new Date(Number(d[0])):new Date(d[0])}return new Date(Date.UTC.apply(null,d));case "boolean":return window[b](d=="false"||
d=="0"?!1:!0);case "List":case "Table":case "StringList":case "NumberList":case "NumberTable":case "NodeList":case "RelationList":case "Polygon":case "Polygon3D":case "PolygonList":case "DateList":case "ColorList":return window[b].apply(window,d);case null:case void 0:case "undefined":return null}var f,e=window[b];f=function(){};f.prototype=e.prototype;f=new f;e.apply(f,d);return f}
getTextFromObject=function(b,d){if(b==null)return"Null";if(b.isList){if(b.length==0)return"[]";var e=b.toString();if(e.length>160){var f,g,e="[";for(f=0;b[f]!=null&&f<6;f++)g=getTextFromObject(b[f],typeOf(b[f])),g.length>40&&(g=g.substr(0,40)+(b[f].isList?"\u2026]":"\u2026")),e+=(f!=0?", ":"")+g;b.length>6&&(e+=",\u2026");e+="]"}return e}switch(d){case "date":return DateOperators.dateToString(b);case "DateInterval":return DateOperators.dateToString(b.date0)+" - "+DateOperators.dateToString(b.date1);
case "string":return(b.length>160?b.substr(0,159)+"\u2026":b).replace(/\n/g,"\u21a9");case "number":return String(b);default:return"{}"}};function instantiateWithSameType(b,d){return instantiate(typeOf(b),d)}function isArray(b){return b.constructor.toString().indexOf("Array")==-1?!1:!0}Date.prototype.getType=function(){return"Date"};var uniqueGlobalFunc=[];function getUniqueGlobalFunc(b,d){uniqueGlobalFunc.push([b,d]);return uniqueGlobalFunc.length-1}
function executeUniqueGlobalFunc(b,d){b!=void 0&&uniqueGlobalFunc[b][0].call(uniqueGlobalFunc[b][1],d)}function ConsoleTools(){}ConsoleTools.NumberTableOnConsole=function(b){var d="",e,f,g,h;c.log(b);for(h=0;h<b[0].length;h++){e="|";for(g=0;b[g]!=null;g++){for(f=String(Math.floor(100*b[g][h])/100).replace(/0./,".");f.length<3;)f=" "+f;e+=f+"|"}d+=e+"\n"}c.log(d);return d};function FastHtml(){}
FastHtml.expand=function(b,d,e){if(b==null||b=="")return"";if(b.split("<").length!=b.split(">").length)return b;for(var f="";f!=null;)f=StringOperators.getFirstTextBetweenStrings(b,"<fs",">"),f!=null&&(b=b.replace("<fs"+f+">",'<font style="font-size:'+Number(f)+'px">')),b.indexOf(">")==-1&&(f=null);for(f="";f!=null;)f=StringOperators.getFirstTextBetweenStrings(b,"<ff",">"),f!=null&&(b=b.replace("<ff"+f+">",'<font face="'+f+'">'));b=b.replace(/\u00ac/,"<br/>");b=b.replace(/<fcBlack>/g,'<font color="#000000">');
b=b.replace(/<fcWhite>/g,'<font color="#FFFFFF">');b=b.replace(/<fcRed>/g,'<font color="#FF0000">');b=b.replace(/<fcGreen>/g,'<font color="#00FF00">');b=b.replace(/<fcBlue>/g,'<font color="#0000FF">');b=b.replace(/<fcOrange>/g,'<font color="#FFAA00">');b=b.replace(/<fcCyan>/g,'<font color="#00FFFF">');b=b.replace(/<fcYellow>/g,'<font color="#FFFF00">');b=b.replace(/<fcMagenta>/g,'<font color="#FF00FF">');for(f="";f!=null;)f=StringOperators.getFirstTextBetweenStrings(b,"<fcuint",">"),f!=null&&(b=b.replace("<fcuint"+
f+">",'<font color="'+ColorOperators.uinttoHEX(f)+'">'));for(f="";f!=null;)if(f=StringOperators.getFirstTextBetweenStrings(b,"<frgb",">"),f!=null)var g=f.split("."),b=b.replace("<frgb"+f+">",'<font color="'+ColorOperators.RGBtoHEX(Number(g[0]),Number(g[1]),Number(g[2]))+'">');for(f="";f!=null;)f=StringOperators.getFirstTextBetweenStrings(b,"<fc",">"),f!=null&&(b=b.replace("<fc"+f+">",'<font color="#'+f+'">'));for(f="";f!=null;)f=StringOperators.getFirstTextBetweenStrings(b,"<tl",">"),f!=null&&(b=
b.replace("<tl"+f+">",'<textformat leftmargin="'+f+'">'));for(f="";f!=null;)f=StringOperators.getFirstTextBetweenStrings(b,"<tv",">"),f!=null&&(b=b.replace("<tv"+f+">",'<textformat leading="'+f+'">'));for(var f="",h,k;f!=null;)f=StringOperators.getFirstTextBetweenStrings(b,"<e",">"),f!=null&&(g=f.split("*")[0],h=f.split("*")[1],k=f.split("*").length>2&&f.split("*")[2]=="s"?"_self":"_blank",g.substr(0,7)=="http://"||g.substr(0,8)=="https://"?b=b.replace("<e"+f+">","<u><a href='"+g+"' target='"+k+"'>"+
h+"</a></u>"):(getUniqueGlobalFunc(e,d),b=b.replace("<e"+f+">","<u><a href='javascript:FastHtml.clickLink(\""+g+"\")' FastHtml.onclick='event.preventDefault(); clickLink(\""+g+"\"); return false; '>"+h+"</a></u>")));b=b.replace(/<pl>/g,'<p align="left">');b=b.replace(/<pc>/g,'<p align="center">');b=b.replace(/<pr>/g,'<p align="right">');b=b.replace(/<pj>/g,'<p align="justify">');b=b.replace(/<\/f>/g,"</font>");return b=b.replace(/<\/t>/g,"</textformat>")};
FastHtml.clickLink=function(b){FastHtml.linkFunction.call(FastHtml.target,b)};FastHtml.findAndPlaceLinks=function(b){b=FastHtml._findAndPlaceLinksPrefix(b,"http");return FastHtml._findAndPlaceLinksPrefix(b,"https")};
FastHtml._findAndPlaceLinksPrefix=function(b,d){var e=b.split(d=="http"?/http:\/\//g:/https:\/\//g);if(e.length>1){var f=[],g,h;f[0]=e[0];for(var k=1;e[k]!=null;k++)g=e[k].search(/ |:|;/),g>-1?(h=d+"://"+e[k].substr(0,g),f[k]="<e"+h+"*"+h+">"+e[k].substr(g)):(h=d+"://"+e[k].substr(0),f[k]="<e"+h+"*"+h+">")}return e.length==0||e.length==1?b:f.join("")};
FastHtml.findAndPlaceTwitterAdresses=function(b){var d=b.split(/@/g);if(d.length>1){var e=[],f,g,h;e[0]=d[0];for(var k=1;d[k]!=null;k++)f=d[k].search(/ |:|;/),f>-1?(h=d[k].substr(0,f),g="https://twitter.com/"+h,e[k]="<e"+g+"*@"+h+">"+d[k].substr(f)):(h=d[k].substr(0),g="https://twitter.com/"+h,e[k]="<e"+g+"*@"+h+">")}return d.length==0||d.length==1?b:e.join("")};function JSONUtils(){}
JSONUtils.stringifyAndPrint=function(b){b=JSON.stringify(b);c.log("__________________________________________________________________________________________________________________________________________________________");c.log(b);c.log("__________________________________________________________________________________________________________________________________________________________")};function StringUtils(){}
StringUtils.stringtoXML=function(b){if(window.ActiveXObject){var d=new ActiveXObject("Microsoft.XMLDOM");d.async="false";d.loadXML(b)}else d=(new DOMParser).parseFromString(b,"text/xml");return d};function Navigator(){}var userAgent,userAgentVersion;Navigator.IE="IE";Navigator.NS="NS";Navigator.IOS="IOS";
detectUserAgent=function(){if(/MSIE (\d+\.\d+);/.test(navigator.userAgent))userAgent=Navigator.IE,userAgentVersion=new Number(RegExp.$1);if(navigator.userAgent.match(/iPad/i)!=null)userAgent=Navigator.IOS;if(/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent))userAgent=Navigator.NS,userAgentVersion=new Number(RegExp.$1)};Navigator.getUserAgent=function(){return userAgent};Navigator.getUserAgentVersion=function(){return userAgentVersion};function CountryListDraw(){}
CountryListDraw.drawCountriesAsCircles=function(b,d,e,f,g,h){for(var g=g==null?new Rectangle(-180,-90,360,180):g,h=h==null?ColorListGenerators.createColorListWithSingleColor(d.length,"rgba(100,100,100,0.6)"):h,k=f.width/g.width,l=f.height/g.height,m,n=0;d[n]!=null;n++)if(!(e[n]<0.5))m=d[n],b.fillStyle=h[n],b.beginPath(),b.arc(f.x+k*(m.geoCenter.x-g.x),f.getBottom()-l*(m.geoCenter.y-g.y),e[n],0,TwoPi),b.fill()};
CountryListDraw.drawCountriesPolygons=function(b,d,e,f,g,h,k){var f=f==null?new Rectangle(-180,-90,360,180):f,g=g==null?ColorListGenerators.createColorListWithSingleColor(d.length,"rgba(100,100,100,0.6)"):g,l=e.width/f.width,m=e.height/f.height,n,o;if(h!=null)b.lineWidth=h;if(k!=null)b.strokeStyle=k;for(k=0;d[k]!=null;k++){n=d[k];n=n.polygonList;b.fillStyle=g[k];for(var q=0;n[q]!=null;q++){o=n[q];b.beginPath();b.moveTo(e.x+l*(o[0].x-f.x),e.getBottom()-m*(o[0].y-f.y));for(var s=1;o[s]!=null;s++)b.lineTo(e.x+
l*(o[s].x-f.x),e.getBottom()-m*(o[s].y-f.y));b.fill();h!=null&&b.stroke()}}};function CirclesVisOperators(){}
CirclesVisOperators.circlesCloud=function(b,d,e){for(var e=e==null?0:e,f=b.getNormalizedToMax().sqrt(),b=new Polygon3D,g=0,h=0,k=0,l=0,m=d.getCenter(),n=f[0]*100,o,q,s=d.width/d.height,u=0;f[u]!=null;u++){o=f[u]*100;if(u==0)k=m.x,l=m.y,q=o;else{g=0;for(h=q+o+e+0.1;CirclesVisOperators._pointInCircles(b,k,l,o,e);)h+=0.1,g+=h*0.0050,k=m.x+s*h*Math.cos(g),l=m.y+h*Math.sin(g);n=Math.max(n,s*h+f[u]*100)}b[u]=new Point3D(k,l,o)}s=0.5*d.width/n;for(u=0;b[u]!=null;u++)d=b[u],d.x=m.x+(d.x-m.x)*s,d.y=m.y+(d.y-
m.y)*s,d.z*=s;return b};CirclesVisOperators._pointInCircles=function(b,d,e,f,g){for(var h,k=0;b[k]!=null;k++)if(h=b[k],Math.pow(h.x-d,2)+Math.pow(h.y-e,2)<Math.pow(h.z+f+g,2))return!0;return!1};function ImageDraw(){}ImageDraw.drawImage=function(b,d,e){Draw.fillRectangleWithImage(b,d,e||0)};function ListDraw(){}
ListDraw.drawList=function(b,d,e){var f,g=b.x+5,h,k=d.length,l=b.getBottom();setText("black",14);for(f=0;d[f]!=null;f++){h=b.y+18*f+5;if(h>l)break;setFill(e==null?"rgb(200, 200, 200)":e[f%k]);fRect(g,h+4,10,10);setFill("black");fText(d[f].toString(),g+15,h+2)}};function IntervalTableDraw(){}IntervalTableDraw.MIN_CHARACTERS_SIZE=1;
IntervalTableDraw.drawIntervalsFlowTable=function(b,d,e,f,g){for(var d=d==null?new Rectangle(10,10,400,300):d,e=e==null?ColorListGenerators.createCategoricalColors(0,b.length,ColorScales.temperature):e,f=f||!1,g=g==null?0.45:g,h,k=b[0].length,l=d.width/(k-1),m=d.height,n,o,q=0,s=d.x,u=d.y,t,v,d=0;b[d]!=null;d++){o=b[d];context.fillStyle=e[d];context.beginPath();q=u;n=new Point(s,o[0].y*m+q);context.moveTo(n.x,n.y);t=n;for(h=1;h<k;h++)q=u,n=new Point(h*l+s,o[h].y*m+q),f?(v=(n.x-t.x)*g,context.bezierCurveTo(t.x+
v,t.y,n.x-v,n.y,n.x,n.y)):context.lineTo(n.x,n.y),t=n;n=new Point((k-1)*l+s,o[k-1].x*m+q);context.lineTo(n.x,n.y);t=n;for(h=k-2;h>=0;h--)q=u,n=new Point(h*l+s,o[h].x*m+q),f?(v=(n.x-t.x)*g,context.bezierCurveTo(t.x+v,t.y,n.x-v,n.y,n.x,n.y)):context.lineTo(n.x,n.y),t=n;n=new Point(s,o[0].x*m+q);context.lineTo(n.x,n.y);context.fill()}};
IntervalTableDraw._isOnShape=function(b,d,e,f,g,h,k){var h=(h-b.x)/(d.x-b.x),l=1-h;this.p0.x=b.x+h*g;this.p0.y=b.y;this.p1.x=l*(b.x+g)+h*(d.x-g);this.p1.y=l*b.y+h*d.y;this.p2.x=d.x-l*g;this.p2.y=d.y;this.P0.x=l*this.p0.x+h*this.p1.x;this.P0.y=l*this.p0.y+h*this.p1.y;this.P1.x=l*this.p1.x+h*this.p2.x;this.P1.y=l*this.p1.y+h*this.p2.y;b=l*this.P0.y+h*this.P1.y;this.p0.y=e;this.p1.y=l*e+h*f;this.p2.y=f;this.P0.y=l*this.p0.y+h*this.p1.y;this.P1.y=l*this.p1.y+h*this.p2.y;return k>l*this.P0.y+h*this.P1.y&&
k<b};
IntervalTableDraw.drawCircularIntervalsFlowTable=function(b,d,e,f,g,h,k,l){var m=b.length,n,o,g=g==null?ColorListOperators.colorListFromColorScale(new ColorScale(ColorOperators.temperatureScale),m):g,d=d==null?new Point(100,100):d,e=e==null?200:e,f=f==null?10:f,q=b[0].length,s=TwoPi/q,u=e-f,t,v,w,A,B,z,C=s*0.3,D=Math.cos(C),E=-1,F=[],J=[],G=[],H=[],I=[];for(n=0;n<m;n++){v=b[n];context.fillStyle=g[n%m];context.beginPath();t=new Point(l==null?0:l[0],(1-v[0].y)*u+f);context.moveTo(t.y*Math.cos(t.x)+d.x,
t.y*Math.sin(t.x)+d.y);A=t;for(o=1;o<=q;o++)w=v[o%q],t=new Point(l==null?o*s:l[o%q],(1-w.y)*u+f),B=A.y/D,z=t.y/D,context.bezierCurveTo(B*Math.cos(A.x+C)+d.x,B*Math.sin(A.x+C)+d.y,z*Math.cos(t.x-C)+d.x,z*Math.sin(t.x-C)+d.y,t.y*Math.cos(t.x)+d.x,t.y*Math.sin(t.x)+d.y),k&&E==-1&&this._isOnRadialShape(d,mousePoint,A.x,t.x,u*(1-v[(o-1)%q].y)+f,u*(1-v[(o-1)%q].x)+f,u*(1-v[o%q].y)+f,u*(1-v[o%q].x)+f)&&(E=n),A=t,h!=null&&(w=w.getAmplitude(),w*e>27&&(B=t.y+w*0.5*u,H.push(Math.min(Math.sqrt(w*e)*1.8,24)),
I.push(t.x+Math.PI*0.5),J.push(B*Math.cos(t.x)+d.x),G.push(B*Math.sin(t.x)+d.y),F.push(h[n])));t=new Point(l==null?0:l[0],(1-v[0].x)*u+f);context.lineTo(t.y*Math.cos(t.x)+d.x,t.y*Math.sin(t.x)+d.y);A=t;for(o=q-1;o>=0;o--)t=new Point(l==null?o*s:l[o],(1-v[o].x)*u+f),B=A.y/D,z=t.y/D,context.bezierCurveTo(B*Math.cos(A.x-C)+d.x,B*Math.sin(A.x-C)+d.y,z*Math.cos(t.x+C)+d.x,z*Math.sin(t.x+C)+d.y,t.y*Math.cos(t.x)+d.x,t.y*Math.sin(t.x)+d.y),A=t;t=new Point(l==null?0:l[0],(1-v[0].x)*u+f);context.lineTo(t.y*
Math.cos(t.x)+d.x,t.y*Math.sin(t.x)+d.y);context.fill()}for(n=0;F[n]!=null;n++)DrawTexts.setContextTextProperties("black",H[n],"Arial","center","middle"),context.save(),context.translate(J[n],G[n]),context.rotate(I[n]),context.fillText(F[n],0,0),context.restore();return E};
IntervalTableDraw._isOnRadialShape=function(b,d,e,f,g,h,k,l){f<e&&(f+=TwoPi);var m=b.angleToPoint(d);m<0&&(m+=TwoPi);m>TwoPi&&(m-=TwoPi);m+TwoPi<f&&(m+=TwoPi);m-TwoPi>e&&(m-=TwoPi);if(m<e||m>f)return!1;var n=f-e,m=(m-e)/n,g=GeometryOperators.bezierCurvePoints(e,g,e+n*0.5,g,f-n*0.5,k,f,k,m),e=GeometryOperators.bezierCurvePoints(e,h,e+n*0.25,h,f-n*0.25,l,f,l,m);r=d.subtract(b).getNorm();return r>g.y&&r<e.y};
IntervalTableDraw.drawIntervalsWordsFlowTable=function(b,d,e,f,g){var h=b.length,k,f=f==null?ColorListGenerators.createCategoricalColors(0,b.length,ColorScales.temperature):f,d=d==null?new Rectangle(10,10,400,300):d,l=b[0].length,m=d.width/(l-1),n=d.height,o,q,s=new Point,u=new Point,t,h=b[h-1],v=0,w=d.x,A=d.y,B,z;if(!g)context.strokeStyle="rgba(255,255,255,0.4)";context.textBaseline="top";context.textAlign="left";for(var C,D,E=m,F,J,G,H,I=(l-1)/d.width,K,L,d=0;b[d]!=null;d++){t=b[d];z=" "+e[d];J=
C=0;v=(1-h[0].y)*0.5*n+A;o=new Point(w,t[0].x*n+v);q=new Point(w,t[0].y*n+v);do{J++;m=q.y-o.y;H=Math.floor(0.3*m+1);if(!g)context.font=H+"px "+LOADED_FONT;G=z.charAt(J%z.length);E=g?H*widthsTypode[G]:context.measureText(G).width+2;E=E*0.9||1;C+=E;B=I*C;k=Math.floor(B);D=B-k;if(!(k+2>l)&&(K=k/I,L=(k+1)/I,B=I*0.45,F=IntervalTableDraw._bezierValue(K,L,h[k].y,h[k+1].y,D,B),prevsY=v,v=(1-F)*0.5*n+A,s.x=o.x,s.y=o.y,u.x=q.x,u.y=q.y,o=IntervalTableDraw._bezierValue(K,L,t[k].x,t[k+1].x,D,B),q=IntervalTableDraw._bezierValue(K,
L,t[k].y,t[k+1].y,D,B),o=new Point(C+w,o*n+v),q=new Point(C+w,q*n+v),new Point(s.x+E*0.5,(o.y+q.y+s.y+u.y)*0.25),g?context.strokeStyle=f[d]:context.fillStyle=f[d],m>IntervalTableDraw.MIN_CHARACTERS_SIZE))g?DrawTextsAdvanced.typodeOnQuadrilater(G,s,o,q,u):(context.save(),context.globalAlpha=m/15,DrawTextsAdvanced.textOnQuadrilater(context,G,s,o,q,u,H,1),context.restore())}while(k+1<l)}};
IntervalTableDraw._bezierValue=function(b,d,e,f,g,h){var k=1-g,l=new Point(b+g*h,e),b=new Point(k*(b+h)+g*(d-h),k*e+g*f),d=new Point(d-k*h,f),l=new Point(k*l.x+g*b.x,k*l.y+g*b.y),d=new Point(k*b.x+g*d.x,k*b.y+g*d.y);return k*l.y+g*d.y};function NumberTableDraw(){}
NumberTableDraw.drawNumberTable=function(b,d,e,f){if(!(b==null||d==null||d.type!="NumberTable"||d.length<2)){var e=e==null?ColorScales.blueToRed:e,f=f==null?2:f,g=b.width/d.length,h=b.height/d[0].length,k,l,m,n,o,q=d.getMinMaxInterval(),s=q.getAmplitude(),u;for(k=0;d[k]!=null;k++){m=d[k];n=b.x+k*g;u=mX>n&&mX<=n+g;for(l=0;m[l]!=null;l++)context.fillStyle=e((m[l]-q.x)/s),context.fillRect(n,b.y+l*h,g-f,h-f),u&&mY>b.y+l*h&&mY<=b.y+(l+1)*h&&(o=new Point(k,l))}return o}};
NumberTableDraw.drawSimpleScatterPlot=function(b,d,e,f,g,h,k){if(!(b==null||d==null||d.type!="NumberTable")&&!(d.length<2)){g=g||20;h=h||!1;k=k||0;b=new Rectangle(b.x+k,b.y+k,b.width-k*2,b.height-k*2);b.bottom=b.getBottom();for(var l,m=(h?d[0].log(1):d[0]).getNormalized(),h=(h?d[1].log(1):d[1]).getNormalized(),n=d.length<=2?null:d[2].getNormalized().sqrt().factor(g),o=f==null?null:f.length,q=Math.min(m.length,h.length,n==null?2E3:n.length,e==null?2E3:e.length),s,d=0;d<q;d++)g=b.x+m[d]*b.width,l=b.bottom-
h[d]*b.height,n==null?NumberTableDraw._drawCrossScatterPlot(g,l)&&(s=d):(setFill(f==null?"rgb(150,150,150)":f[d%o]),fCircleM(g,l,n[d],n[d]+1)&&(s=d)),e!=null&&(setText("black",10),fText(e[d],g,l));k>7&&m.name!=""&&h.name!=""&&(setText("black",10,null,"right","middle"),fText(m.name,b.getRight()-2,b.bottom+k*0.5),fTextRotated(h.name,b.x-k*0.5,b.y+1,-HalfPi));if(s!=null)return setCursor("pointer"),s}};
NumberTableDraw._drawCrossScatterPlot=function(b,d){setStroke("black",1);line(b,d-5,b,d+5);line(b-5,d,b+5,d);return Math.pow(mX-b,2)+Math.pow(mY-d,2)<25};
NumberTableDraw.drawSlopeGraph=function(b,d,e){if(!(b==null||d==null||d.type!="NumberTable")&&!(d.length<2)){b=new Rectangle(b.x+16,b.y+16,b.width-32,b.height-32);b.bottom=b.getBottom();var f,g,h=d[0].getNormalized(),k=d[1].getNormalized(),l=Math.min(h.length,k.length,e==null?2E3:e.length),m=b.x+(e==null?10:0.25*b.width),n=b.getRight()-(e==null?10:0.25*b.width);setStroke("black",1);for(d=0;d<l;d++)f=b.bottom-h[d]*b.height,g=b.bottom-k[d]*b.height,line(m,f,n,g),e!=null&&b.bottom-f>=9&&(setText("black",
9,null,"right","middle"),fText(e[d],m-2,f)),e!=null&&b.bottom-g>=9&&(setText("black",9,null,"left","middle"),fText(e[d],n+2,g))}};
NumberTableDraw.drawDensityMatrix=function(b,d,e,f){if(!(d==null||d[0]==null)){var e=e==null?ColorScales.whiteToRed:typeof e=="string"?ColorScales[e]:e,f=f||0,g,h,k,l,m,n;if(b.memory==null||d!=b.memory.coordinates||e!=b.memory.colorScale){c.log("coordinates[0]",d[0]);var o=d[0].x==null;if(o){var q=d;if(q==null||q.length<2||q.type!="NumberTable")return}else var s=d;var u=0,t=0,v=0,w=new NumberTable,A=o?q[0].length:s.length;n=new Table;if(o)l=q[0].getMin(),m=q[1].getMin();else{l=s[0].x;m=s[0].y;for(g=
1;g<A;g++)l=Math.min(s[g].x,l),m=Math.min(s[g].y,m)}for(g=0;g<A;g++)o?(h=q[0][g]-l,k=q[1][g]-m):(h=s[g].x-l,k=s[g].y-m),w[h]==null&&(w[h]=new NumberList),w[h][k]==null&&(w[h][k]=0),w[h][k]++,u=Math.max(u,w[h][k]),t=Math.max(t,h+1),v=Math.max(v,k+1);for(g=0;g<t;g++){w[g]==null&&(w[g]=new NumberList);n[g]=new ColorList;for(h=0;h<v;h++)w[g][h]==null&&(w[g][h]=0),n[g][h]=e(w[g][h]/u)}b.memory={matrixColors:n,coordinates:d,colorScale:e,selected:null}}else n=b.memory.matrixColors;d=new Rectangle(b.x+f,
b.y+f,b.width-f*2,b.height-f*2);d.bottom=d.getBottom();e=d.width/n.length;f=d.height/n[0].length;u=b.memory.selected;if(MOUSE_UP_FAST)b.memory.selected=null;for(g=0;n[g]!=null;g++)for(h=0;n[0][h]!=null;h++)if(setFill(n[g][h]),fRectM(d.x+g*e,d.bottom-(h+1)*f,e+0.5,f+0.5)&&MOUSE_UP_FAST)b.memory.selected=[g,h];b.memory.selected&&(setStroke("white",5),sRect(d.x+b.memory.selected[0]*e-1,d.bottom-(b.memory.selected[1]+1)*f-1,e+1,f+1),setStroke("black",1),sRect(d.x+b.memory.selected[0]*e-1,d.bottom-(b.memory.selected[1]+
1)*f-1,e+1,f+1));if(u!=b.memory.selected)if(b.memory.selected==null)b.memory.indexes=null;else{l=q[0].getMin();m=q[1].getMin();h=b.memory.selected[0]+l;k=b.memory.selected[1]+m;b.memory.indexes=new NumberList;for(g=0;q[0][g]!=null;g++)q[0][g]==h&&q[1][g]==k&&b.memory.indexes.push(g)}if(b.memory.selected)return b.memory.indexes}};
NumberTableDraw.drawStreamgraph=function(b,d,e,f,g,h,k){if(!(d==null||d.length<2||d.type!="NumberTable")){g=g==null?1:g;if(b.memory==null||d!=b.memory.numberTable||e!=b.memory.normalized||f!=b.memory.sorted||g!=b.memory.intervalsFactor||g!=b.memory.intervalsFactor)b.memory={numberTable:d,normalized:e,sorted:f,intervalsFactor:g,flowIntervals:IntervalTableOperators.scaleIntervals(NumberTableFlowOperators.getFlowTableIntervals(d,e,f),g)},b.secret="hola!";if(b.memory.colorList!=k||b.memory.colorList==
null)b.memory.actualColorList=k==null?ColorListGenerators.createCategoricalColors(1,d.length):k,b.memory.colorList=k;IntervalTableDraw.drawIntervalsFlowTable(b.memory.flowIntervals,b,b.memory.actualColorList,h,0.3)}};NumberListDraw=function(){};
NumberListDraw.drawSimpleGraph=function(b,d,e){if(!(d==null||d.getNormalized==null)){e=e||0;if(b.memory==null||d!=b.memory.numberList)b.memory={},b.memory.numberList=d,b.memory.normalizedList=d.getNormalized();var f=new Rectangle(b.x+e,b.y+e,b.width-e*2,b.height-e*2);f.bottom=f.getBottom();var g=f.width/d.length;setFill("black");for(e=0;d[e]!=null;e++)fRect(f.x+e*g,f.bottom,g-1,-f.height*b.memory.normalizedList[e])}};function StringDraw(){}
StringDraw.drawText=function(b,d,e,f,g){var g=g||10,e=e||12,h=new Rectangle(b.x+g,b.y+g,b.width-g*2,b.height-g*2);h.bottom=h.getBottom();var k=Math.floor(e*1.2);setText("black",e,null,null,null,f);if(significantChange=b.memory==null||d!=b.memory.object||e!=b.memory.fontSize||f!=b.memory.fontStyle||g!=b.memory.margin||b.width!=b.memory.width||b.height!=b.memory.height){var l=d==null?"":typeof d=="string"?d:JSON.stringify(d,null,"\t");b.memory={textLines:DrawTexts.textWordWrapReturnLines(l,h.width,
h.height,k,!0),object:d,fontSize:e,fontStyle:f,margin:g,width:b.width,height:b.height}}DrawTexts.fillTextRectangleWithTextLines(b.memory.textLines,h.x,h.y,h.height,k)};function StringListDraw(){}
StringListDraw.tagCloudRectangles=function(b,d){table[1].sqrt().getNormalizedToMax();rectangles=new List;textPositions=new Polygon;textSizes=new NumberList;for(var e=new List,f=new Point(0,0),g,h,k=0;words[k]!=null;k++){textSizes[k]=Math.round(d[k]*16)*6;DrawTexts.setContextTextProperties("black",textSizes[k],"Arial",null,null,"bold");g=Math.ceil((2+context.measureText(b[k]).width)/6)*6;for(h=textSizes[k];StringListDraw._pointInRectangles(e,f,g,h);)if(f.x+=6,f.y-=6,f.y<0)f.y=f.x,f.x=0;rectangles[k]=
new Rectangle(f.x,f.y,g,h);e.push(rectangles[k])}};StringListDraw._pointInRectangles=function(b,d,e,f){for(var g,h=0;b[h]!=null;h++)if(g=b[h],d.x+e>g.x&&d.x<g.x+g.width&&d.y+f>g.y&&d.y<g.y+g.height)return!0;return!1};function StringListVisOperators(){}
StringListVisOperators.simpleTagCloud=function(b,d,e,f,g){var f=f==null?"Arial":f,g=g==null?1.2:g,h,k,l,m,n,o,q=20,s=d.getNormalizedToMax(),u,t;h=!0;for(var v=0;h;){interLine=q*g;k=o=d=l=0;u=new NumberList;t=new Polygon;for(h=0;b[h]!=null;h++){m=b[h];n=Math.floor(Math.sqrt(s[h])*q);u.push(n);context.font=String(n)+"px "+f;m=context.measureText(m).width;if(l+m>e.width){l=0;d+=o*g+1;for(o=0;k<h;k++)t[k].y=d;k=h}o=Math.max(o,n);t.push(new Point(l,d));l+=m+n*0.2}for(d+=o*g+1;b[k]!=null;k++)t[k].y=d;h=
!1;d<e.height*0.97&&(q=0.5*q+0.5*q*e.height/(d+interLine),h=!0);d>=e.height*0.995&&(q=0.5*q+0.5*q*e.height/(d+interLine),h=!0);v++;v>10&&(h=!1)}table=new Table;table[0]=b;table[1]=t;table[2]=u;return table};
StringListVisOperators.tagCloudRectangles=function(b,d,e,f,g){var f=f==null?0:f,g=g==null?0:g,h=d.sqrt().getNormalizedToMax(),k=f==0;rectangles=new List;textPositions=new Polygon;textSizes=new NumberList;var l=new List,m=0,n=0,o,q,s,u=0;switch(f){case 0:o=e.x;q=e.y;break;case 2:var t=5,n=0,v=1,w=new Point;case 1:q=o=0,s=e.getCenter()}for(var A,B,d=e.width/e.height,z=0;b[z]!=null;z++){textSizes[z]=k?Math.round(h[z]*12)*6:h[z]*72;DrawTexts.setContextTextProperties("black",textSizes[z],LOADED_FONT,null,
null,"bold");A=Math.ceil((2+context.measureText(b[z]).width)/6)*6;B=textSizes[z];switch(f){case 0:for(;StringListVisOperators._pointInRectangles(l,o,q,A,B,g);)if(o+=6,q-=6,q<e.y)q=p.x,o=e.x;break;case 1:if(z==0)o=s.x-A*0.5,q=s.y-B*0.5;else{m=z*0.1;for(n=0;StringListVisOperators._pointInRectangles(l,o,q,A,B,g);)n+=1,m+=n*0.0050,o=s.x+d*n*Math.cos(m)-A*0.5,q=s.y+n*Math.sin(m)-B*0.5;u=Math.max(u,d*n+A*0.5)}break;case 2:if(z==0)w=s.clone(),o=w.x-A*0.5,q=w.y-B*0.5;else{n=0;v=1;m=0;for(w=s.clone();StringListVisOperators._pointInRectangles(l,
o,q,A,B,g);)n++,w.x+=d*t*Math.cos(m),w.y+=t*Math.sin(m),o=w.x-A*0.5,q=w.y-B*0.5,n>=v&&(m+=Math.PI*0.5,v+=0.5,n=0);u=Math.max(Math.abs(w.x-s.x)+A*0.5,u)}}rectangles[z]=new Rectangle(o,q,A,B);l.push(rectangles[z])}if(f==1||f==2){d=0.5*e.width/u;for(z=0;rectangles[z]!=null;z++)e=rectangles[z],e.x=s.x+(e.x-s.x)*d,e.y=s.y+(e.y-s.y)*d,e.width*=d,e.height*=d,textSizes[z]*=d}s=new Table;s[0]=b;s[1]=rectangles;s[2]=textSizes;return s};
StringListVisOperators._pointInRectangles=function(b,d,e,f,g,h){for(var k,l=0;b[l]!=null;l++)if(k=b[l],d+f>k.x-h&&d<k.x+k.width+h&&e+g>k.y-h&&e<k.y+k.height+h)return!0;return!1};function NetworkDraw(){}NetworkDraw._drawNode=function(b,d,e,f){var g=!1;b.image?(clipCircle(d,e,f),drawImage(b.image,d-f,e-f*1.3,f*2,f*3),restore(),g=Math.pow(d-mX,2)+Math.pow(e-mY,2)<=f*f):(setFill(b.color==null?"rgb(50,50,50)":b.color),g=fCircleM(d,e,f));g&&setCursor("pointer");return g};
NetworkDraw.drawRadialNetwork=function(b,d){var e=1.1*Math.min(b.width,b.height)/d.nodeList.length,f=b.width*0.5-e,g=b.height*0.5-e,h=b.x+b.width*0.5,k=b.y+b.height*0.5,l,m,n,o,q=TwoPi/d.nodeList.length;setFill("black");d.nodeList.forEach(function(b,d){b.x=h+f*Math.cos(d*q);b.y=k+g*Math.sin(d*q)});d.relationList.forEach(function(b){setStroke("black",b.weight*0.25);l=(b.node0.x+b.node1.x)*0.5;m=(b.node0.y+b.node1.y)*0.5;n=Math.sqrt(Math.pow(b.node0.x-b.node1.x,2),Math.pow(b.node0.y-b.node1.y,2))+1;
l=(1-0.5*(n/f))*l+0.5*(n/f)*h;m=(1-0.5*(n/g))*m+0.5*(n/g)*k;bezier(b.node0.x,b.node0.y,l,m,l,m,b.node1.x,b.node1.y)});d.nodeList.forEach(function(b){NetworkDraw._drawNode(b,b.x,b.y,e)&&(o=b)});return o};
NetworkDraw.drawNetwork2D=function(b,d,e,f,g,h,k){if(!(d==null||e==null)){var f=f||!1,g=g||!1,h=h||!1,k=k||0,l=1.1*Math.min(b.width,b.height)/d.nodeList.length,m,n=b.memory,o,q,s,u,t=n==null||!n.frame.isEqual(b);if(n==null||n.network!=d||n.nNodes!=d.nodeList.length||n.polygon!=e||t||n.respectProportions!=f||n.margin!=k||n.logScale!=g||n.drawGrid!=h){if(n==null)b.memory={},n=b.memory;n.frame=b.clone();n.network=d;var v=n.polygon!=null&&n.polygon.length!=e.length;n.polygon=e;n.respectProportions=f;
n.logScale=g;n.drawGrid=h;n.margin=k;n.nNodes=d.nodeList.length;b.bottom=b.getBottom();b.right=b.getRight();n.frameMargin=new Rectangle(b.x+k,b.y+k,b.width-2*k,b.height-2*k);u=n.frameMargin;n.frameMargin.right=n.frameMargin.getRight();n.frameMargin.bottom=n.frameMargin.getBottom();n.frameP=e.getFrame();s=n.frameP;s.right=s.getRight();s.bottom=s.getBottom();f&&(o=q=Math.min(o,q));var w;n.actualLogScale=g&&s.x>=0&&s.y>=0;n.actualLogScale?(o=u.width/Math.log((s.right+1)/(s.x+1)),q=u.height/Math.log((s.bottom+
1)/(s.y+1)),w=function(b){return new Point((Math.log(b.x+1)-Math.log(s.x+1))*o+u.x,u.bottom-(Math.log(b.y+1)-Math.log(s.y+1))*q)}):(o=u.width/s.width,q=u.height/s.height,w=function(b){return new Point((b.x-s.x)*o+u.x,u.bottom-(b.y-s.y)*q)});n.projectedPolygon=new Polygon;e.forEach(function(b,d){n.projectedPolygon[d]=w(b)});if(s.x<=0&&s.getRight()>=0)n.yAxis=-s.x*o+u.x;if(s.y<=0&&s.getBottom()>=0)n.xAxis=u.bottom- -s.y*q;if(b.memory.projectPolygonConvergent==null||t||v)b.memory.projectPolygonConvergent=
n.projectedPolygon.clone()}else s=n.frameP,u=n.frameMargin;setStroke("rgb(50,50,50)",2);n.xAxis&&line(u.x,n.xAxis,n.frameMargin.right,n.xAxis);n.yAxis&&line(n.yAxis,n.frameMargin.y,n.yAxis,n.frameMargin.bottom);b.containsPoint(mP)&&(setStroke("rgb(50,50,50)",0.5),line(b.x+2,mY+0.5,b.right-4,mY+0.5),line(mX+0.5,b.y+2,mX+0.5,b.bottom-4));n.projectPolygonConvergent.approach(n.projectedPolygon,0.1);d.nodeList.forEach(function(b,d){b.x=n.projectPolygonConvergent[d].x;b.y=n.projectPolygonConvergent[d].y});
d.relationList.forEach(function(b){setStroke("black",b.weight*0.25);line(b.node0.x,b.node0.y,b.node1.x,b.node1.y)});d.nodeList.forEach(function(b){NetworkDraw._drawNode(b,b.x,b.y,l)&&(m=b)});b.containsPoint(mP)&&(m==null?n.actualLogScale?NetworkDraw._drawNodeValues(Math.floor(10*(Math.pow(Math.E,Math.log((s.right+1)/(s.x+1))*(mX-u.x)/u.width)-1))/10,Math.floor(10*(Math.pow(Math.E,Math.log((s.bottom+1)/(s.y+1))*(u.bottom-mY)/u.height)-1))/10):NetworkDraw._drawNodeValues(Math.floor(10*(s.x+s.width*
(mX-n.frameMargin.x)/n.frameMargin.width))/10,Math.floor(10*(s.y+s.height*(n.frameMargin.bottom-mY)/n.frameMargin.height))/10):(b=d.nodeList.indexOf(m),NetworkDraw._drawNodeValues(e[b].x,e[b].y,m.name)));return m}};NetworkDraw._drawNodeValues=function(b,d,e){b=(e==null?"":e+": ")+b+", "+d;setFill("rgba(50,50,50,0.8)");fRect(mX-2,mY-2,-getTextW(b)-4,-14);setText("white",12,null,"right","bottom");fText(b,mX-4,mY-2)};
NetworkDraw.drawNetworkMatrix=function(b,d,e,f,g,h,k,l){var f=f==null?ColorOperators.grayScale:f,g=g==null?2:g,h=h==null?!1:h,m=d.nodeList,n=d.relationList,o=k!=null,q=b.width/(m.length+1),s=b.height/(m.length+1),u=q-g,t=s-g,v=q,w=s;if(l=l&&b.pointIsInside(mousePoint))var A=new Point(-1,-1);if(o)var q=b.width-q,s=b.height-s,B,z,C=[],D=[],E=[],F=[];for(d=0;m[d]!=null;d++)if(context.fillStyle=e[d],o){B=q*k[d];z=s*k[d];context.fillRect(b.x+v,b.y,B-g,t);context.fillRect(b.x,b.y+w,u,z-g);if(l){if(mouseX>
b.x+v&&mouseX<b.x+v+B)A.x=d;if(mouseY>b.y+w&&mouseY<b.y+w+z)A.y=d}C[m[d].id]=v;D[m[d].id]=w;E[m[d].id]=B;F[m[d].id]=z;v+=B;w+=z}else context.fillRect(b.x+(d+1)*q,b.y,u,t),context.fillRect(b.x,b.y+(d+1)*s,u,t);for(d=0;n[d]!=null;d++)k=n[d],context.fillStyle=f(k.weight),o?(context.fillRect(b.x+C[k.node0.id],b.y+D[k.node1.id],E[k.node0.id]-g,F[k.node1.id]-g),h||context.fillRect(b.x+D[k.node1.id],b.y+C[k.node0.id],F[k.node1.id]-g,E[k.node0.id]-g)):(e=m.indexOf(k.node0)+1,k=m.indexOf(k.node1)+1,context.fillRect(b.x+
e*q,b.y+k*s,u,t),!h&&e!=k&&context.fillRect(b.x+k*q,b.y+e*s,u,t));return A};function TreeDraw(){}TreeDraw.drawRectanglesTree=function(b,d,e,f){this._drawRectanglesTreeChildren(b.nodeList[0],new Rectangle(d.x,d.y,d.width/b.nLevels,d.height),e,f)};
TreeDraw._drawRectanglesTreeChildren=function(b,d,e,f){context.fillStyle=e[b.level];context.fillRect(d.x+f,d.y+f,d.width-f*2,d.height-f*2);var g=b.toNodeList;if(g.length>0)for(var h=d.height/(b.descentWeight-1),k=d.y,l,b=0;g[b]!=null;b++)l=h*g[b].descentWeight,this._drawRectanglesTreeChildren(g[b],new Rectangle(d.x+d.width,k,d.width,l),e,f),k+=l};function Global(){}Global.userAgent="unknown";init=function(){console.log("init must be overriden!")};cycle=function(){};resizeWindow=function(){console.log("resizeWindow must be overriden!")};
var listenerArray=[],canvas,removeDiv;userAgent="none";
var canvasResizeable=!0,cW=1,cH=1,cX=1,cY=1,mX=0,mY=0,mP=new Point(0,0),nF=0,MOUSE_DOWN=!1,MOUSE_UP=!1,MOUSE_UP_FAST=!1,NF_DOWN,NF_UP,MOUSE_PRESSED,mX_DOWN,mY_DOWN,mX_UP,mY_UP,deltaWheel=0,cursorStyle="auto",backGroundColor="white",cycleActive,context,hddenContext,TwoPi=2*Math.PI,HalfPi=0.5*Math.PI,radToGrad=180/Math.PI,gradToRad=Math.PI/180,c=console,_wheelActivated=!1,_keyboardActivated=!1,_prevMouseX=0,_prevMouseY=0,_setIntervalId,_setTimeOutId,_cycleOnMouseMovement=!1,_interactionCancelledFrame,
END_CYCLE_DELAY=3E3;
window.addEventListener("load",function(){canvas=document.getElementById("main");if(canvas!=null){if(/MSIE (\d+\.\d+);/.test(navigator.userAgent)){if(userAgent="IE",userAgentVersion=new Number(RegExp.$1),userAgentVersion<9)return null}else/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent)?(userAgent="FIREFOX",userAgentVersion=new Number(RegExp.$1)):navigator.userAgent.match(/Chrome/)!=null?(userAgent="CHROME",userAgentVersion=new Number(RegExp.$1)):/Mozilla[\/\s](\d+\.\d+)/.test(navigator.userAgent)||navigator.userAgent.match(/Mozilla/)!=
null?(userAgent="MOZILLA",userAgentVersion=new Number(RegExp.$1)):navigator.userAgent.match(/Safari/)!=null?(userAgent="Safari",userAgentVersion=new Number(RegExp.$1)):navigator.userAgent.match(/iPad/i)!=null?userAgent="IOS":navigator.userAgent.match(/iPhone/i)!=null&&(userAgent="IOS");c.log("[G] userAgent:",userAgent);Global.userAgent=userAgent;Global.frameRate=30;removeDiv=document.getElementById("removeDiv");removeDiv.style.display="none";cH=canvas.height;cW=canvas.width;context=canvas.getContext("2d");
hiddenContext=CanvasAndContext.createInvisibleContext();cW=context.canvas.width=window.innerWidth;cH=context.canvas.height=window.innerHeight;cX=Math.floor(cW*0.5);cY=Math.floor(cH*0.5);canvas.addEventListener("mousemove",_onMouse,!1);canvas.addEventListener("mousedown",_onMouse,!1);canvas.addEventListener("mouseup",_onMouse,!1);window.addEventListener("resize",onResize,!1);canvas!=null&&(startCycle(),init())}},!1);
function _onMouse(b){switch(b.type){case "mousemove":if(b.clientX)mX=b.clientX,mY=b.clientY;else if(b.offsetX)mX=b.offsetX,mY=b.offsetY;else if(b.layerX)mX=b.layerX,mY=b.layerY;mP.x=mX;mP.y=mY;break;case "mousedown":NF_DOWN=nF;MOUSE_PRESSED=!0;mX_DOWN=mX;mY_DOWN=mY;break;case "mouseup":NF_UP=nF,MOUSE_PRESSED=!1,mX_UP=mX,mY_UP=mY}}
function onResize(){if(canvasResizeable!=!1)canvas.setAttribute("width",document.body.clientWidth),canvas.setAttribute("height",document.body.clientHeight),cW=context.canvas.width,cH=context.canvas.height,cX=Math.floor(cW*0.5),cY=Math.floor(cH*0.5),resizeWindow()}function clearContext(){context.clearRect(0,0,cW,cH)}
function cycleOnMouseMovement(b){b?(context.canvas.addEventListener("mousemove",onMoveCycle,!1),addInteractionEventListener("mousewheel",onMoveCycle,this),_cycleOnMouseMovement=!0,stopCycle()):(context.canvas.removeEventListener("mousemove",onMoveCycle,!1),removeInteractionEventListener("mousewheel",onMoveCycle,this),_cycleOnMouseMovement=!1,startCycle())}
function enterFrame(){context.clearRect(0,0,cW,cH);setCursor("default");MOUSE_DOWN=NF_DOWN==nF;MOUSE_UP_FAST=(MOUSE_UP=NF_UP==nF)&&nF-NF_DOWN<9;cycle();nF++}function startCycle(){clearTimeout(_setTimeOutId);clearInterval(_setIntervalId);_setIntervalId=setInterval(enterFrame,30);cycleActive=!0}function stopCycle(){clearInterval(_setIntervalId);cycleActive=!1}function onMoveCycle(b){b.type=="mousemove"&&_prevMouseX==mX&&_prevMouseY==mY||reStartCycle()}
function reStartCycle(){_prevMouseX=mX;_prevMouseY=mY;cycleActive||(_setIntervalId=setInterval(enterFrame,30),cycleActive=!0);clearTimeout(_setTimeOutId);_setTimeOutId=setTimeout(stopCycle,END_CYCLE_DELAY)}
function addInteractionEventListener(b,d,e){listenerArray.push([b,d,e]);switch(b){case "mousedown":case "mouseup":case "click":case "mousemove":context.canvas.addEventListener(b,onCanvasEvent,!1);break;case "mousewheel":_wheelActivated||activateWheel();break;case "keydown":_keyboardActivated||activateKeyboard()}}
function onCanvasEvent(b){var d;for(d=0;listenerArray[d]!=null;d++)if(listenerArray[d][0]==b.type.replace("DOMMouseScroll","mousewheel")){if(_interactionCancelledFrame==nF)break;listenerArray[d][1].call(listenerArray[d][2],b)}}function removeInteractionEventListener(b,d,e){for(var f=0;listenerArray[f]!=null;f++)listenerArray[f][0]==b&&listenerArray[f][1]==d&&listenerArray[f][2]==e&&(delete listenerArray[f],listenerArray.splice(f,1),f--)}
function cancelAllInteractions(){c.log("cancelAllInteractions, _interactionCancelledFrame:",nF);_interactionCancelledFrame=nF}function setBackgroundColor(b){typeof b=="number"?b=arguments.length>3?"rgba("+arguments[0]+","+arguments[1]+","+arguments[2]+","+arguments[3]+")":"rgb("+arguments[0]+","+arguments[1]+","+arguments[2]+")":Array.isArray(b)&&(b=ColorOperators.RGBtoHEX(b[0],b[1],b[2]));backGroundColor=b;document.getElementById("index").setAttribute("bgcolor",backGroundColor)}
function setDivPosition(b,d,e){b.setAttribute("style","position:absolute;left:"+String(d)+"px;top:"+String(e)+"px;")}function activateKeyboard(){_keyboardActivated=!0;document.onkeydown=onKey}function onKey(b){onCanvasEvent(b)}function activateWheel(){_wheelActivated=!0;window.addEventListener&&window.addEventListener("DOMMouseScroll",_onWheel,!1);window.onmousewheel=document.onmousewheel=_onWheel}
function _onWheel(b){if(!b)b=window.event;b.wheelDelta?deltaWheel=b.wheelDelta/120:b.detail&&(deltaWheel=-b.detail/3);b.value=deltaWheel;b.type="mousewheel";onCanvasEvent(b)};
